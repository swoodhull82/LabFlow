"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[511],{14636:(e,t,a)=>{a.d(t,{AM:()=>i,Wv:()=>o,hl:()=>d});var s=a(95155),r=a(12115),n=a(20547),l=a(59434);let i=n.bL,o=n.l9,d=r.forwardRef((e,t)=>{let{className:a,align:r="center",sideOffset:i=4,...o}=e;return(0,s.jsx)(n.ZL,{children:(0,s.jsx)(n.UC,{ref:t,align:r,sideOffset:i,className:(0,l.cn)("z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",a),...o})})});d.displayName=n.UC.displayName},44838:(e,t,a)=>{a.d(t,{Hr:()=>m,Ht:()=>h,SQ:()=>f,_2:()=>p,lp:()=>x,mB:()=>g,rI:()=>c,ty:()=>u});var s=a(95155),r=a(12115),n=a(9449),l=a(73158),i=a(10518),o=a(70154),d=a(59434);let c=n.bL,u=n.l9;n.YJ,n.ZL,n.Pb;let m=n.z6;r.forwardRef((e,t)=>{let{className:a,inset:r,children:i,...o}=e;return(0,s.jsxs)(n.ZP,{ref:t,className:(0,d.cn)("flex cursor-default gap-2 select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",r&&"pl-8",a),...o,children:[i,(0,s.jsx)(l.A,{className:"ml-auto"})]})}).displayName=n.ZP.displayName,r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(n.G5,{ref:t,className:(0,d.cn)("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",a),...r})}).displayName=n.G5.displayName;let f=r.forwardRef((e,t)=>{let{className:a,sideOffset:r=4,...l}=e;return(0,s.jsx)(n.ZL,{children:(0,s.jsx)(n.UC,{ref:t,sideOffset:r,className:(0,d.cn)("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",a),...l})})});f.displayName=n.UC.displayName;let p=r.forwardRef((e,t)=>{let{className:a,inset:r,...l}=e;return(0,s.jsx)(n.q7,{ref:t,className:(0,d.cn)("relative flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",r&&"pl-8",a),...l})});p.displayName=n.q7.displayName,r.forwardRef((e,t)=>{let{className:a,children:r,checked:l,...o}=e;return(0,s.jsxs)(n.H_,{ref:t,className:(0,d.cn)("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",a),checked:l,...o,children:[(0,s.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,s.jsx)(n.VF,{children:(0,s.jsx)(i.A,{className:"h-4 w-4"})})}),r]})}).displayName=n.H_.displayName;let h=r.forwardRef((e,t)=>{let{className:a,children:r,...l}=e;return(0,s.jsxs)(n.hN,{ref:t,className:(0,d.cn)("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",a),...l,children:[(0,s.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,s.jsx)(n.VF,{children:(0,s.jsx)(o.A,{className:"h-2 w-2 fill-current"})})}),r]})});h.displayName=n.hN.displayName;let x=r.forwardRef((e,t)=>{let{className:a,inset:r,...l}=e;return(0,s.jsx)(n.JU,{ref:t,className:(0,d.cn)("px-2 py-1.5 text-sm font-semibold",r&&"pl-8",a),...l})});x.displayName=n.JU.displayName;let g=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(n.wv,{ref:t,className:(0,d.cn)("-mx-1 my-1 h-px bg-muted",a),...r})});g.displayName=n.wv.displayName},46102:(e,t,a)=>{a.d(t,{Bc:()=>i,ZI:()=>c,k$:()=>d,m_:()=>o});var s=a(95155),r=a(12115),n=a(89613),l=a(59434);let i=n.Kq,o=n.bL,d=n.l9,c=r.forwardRef((e,t)=>{let{className:a,sideOffset:r=4,...i}=e;return(0,s.jsx)(n.UC,{ref:t,sideOffset:r,className:(0,l.cn)("z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",a),...i})});c.displayName=n.UC.displayName},47262:(e,t,a)=>{a.d(t,{S:()=>o});var s=a(95155),r=a(12115),n=a(76981),l=a(10518),i=a(59434);let o=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(n.bL,{ref:t,className:(0,i.cn)("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",a),...r,children:(0,s.jsx)(n.C1,{className:(0,i.cn)("flex items-center justify-center text-current"),children:(0,s.jsx)(l.A,{className:"h-4 w-4"})})})});o.displayName=n.bL.displayName},62523:(e,t,a)=>{a.d(t,{p:()=>l});var s=a(95155),r=a(12115),n=a(59434);let l=r.forwardRef((e,t)=>{let{className:a,type:r,...l}=e;return(0,s.jsx)("input",{type:r,className:(0,n.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",a),ref:t,...l})});l.displayName="Input"},85057:(e,t,a)=>{a.d(t,{J:()=>d});var s=a(95155),r=a(12115),n=a(40968),l=a(74466),i=a(59434);let o=(0,l.F)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),d=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(n.b,{ref:t,className:(0,i.cn)(o(),a),...r})});d.displayName=n.b.displayName},85511:(e,t,a)=>{a.d(t,{V:()=>d});var s=a(95155);a(12115);var r=a(965),n=a(73158),l=a(49063),i=a(59434),o=a(30285);function d(e){let{className:t,classNames:a,showOutsideDays:d=!0,...c}=e;return(0,s.jsx)(l.hv,{showOutsideDays:d,className:(0,i.cn)("p-3",t),classNames:{months:"flex flex-col sm:flex-row space-y-4 sm:space-x-4 sm:space-y-0",month:"space-y-4",caption:"flex justify-center pt-1 relative items-center",caption_label:"text-sm font-medium",nav:"space-x-1 flex items-center",nav_button:(0,i.cn)((0,o.r)({variant:"outline"}),"h-7 w-7 bg-transparent p-0 opacity-50 hover:opacity-100"),nav_button_previous:"absolute left-1",nav_button_next:"absolute right-1",table:"w-full border-collapse space-y-1",head_row:"flex",head_cell:"text-muted-foreground rounded-md w-9 font-normal text-[0.8rem]",row:"flex w-full mt-2",cell:"h-9 w-9 text-center text-sm p-0 relative [&:has([aria-selected].day-range-end)]:rounded-r-md [&:has([aria-selected].day-outside)]:bg-accent/50 [&:has([aria-selected])]:bg-accent first:[&:has([aria-selected])]:rounded-l-md last:[&:has([aria-selected])]:rounded-r-md focus-within:relative focus-within:z-20",day:(0,i.cn)((0,o.r)({variant:"ghost"}),"h-9 w-9 p-0 font-normal aria-selected:opacity-100"),day_range_end:"day-range-end",day_selected:"bg-primary text-primary-foreground hover:bg-primary hover:text-primary-foreground focus:bg-primary focus:text-primary-foreground",day_today:"bg-accent text-accent-foreground",day_outside:"day-outside text-muted-foreground aria-selected:bg-accent/50 aria-selected:text-muted-foreground",day_disabled:"text-muted-foreground opacity-50",day_range_middle:"aria-selected:bg-accent aria-selected:text-accent-foreground",day_hidden:"invisible",...a},components:{IconLeft:e=>{let{className:t,...a}=e;return(0,s.jsx)(r.A,{className:(0,i.cn)("h-4 w-4",t),...a})},IconRight:e=>{let{className:t,...a}=e;return(0,s.jsx)(n.A,{className:(0,i.cn)("h-4 w-4",t),...a})}},...c})}d.displayName="Calendar"},89511:(e,t,a)=>{a.d(t,{A:()=>ew});var s=a(95155),r=a(19164),n=a(86622),l=a(44861),i=a(92759),o=a(80644),d=a(76959),c=a(74641),u=a(78039),m=a(7860),f=a(73168),p=a(94376),h=a(8540),x=a(31858),g=a(94260),b=a(1407),y=a(24386),v=a(70831),j=a(56313),N=a(63482),w=a(37140),D=a(45887),k=a(78345),T=a(52873),A=a(12115),P=a(59434),_=a(59576),M=a(77694),C=a(97841),I=a(87481),E=a(50172),L=a(31949),S=a(34301),O=a(965),z=a(73158),V=a(79556),R=a(3561),X=a(51920),G=a(24371),J=a(59119),Y=a(30285),q=a(46102),H=a(17649);let F=H.bL;H.l9;let W=H.ZL,U=A.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(H.hJ,{className:(0,P.cn)("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",a),...r,ref:t})});U.displayName=H.hJ.displayName;let $=A.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsxs)(W,{children:[(0,s.jsx)(U,{}),(0,s.jsx)(H.UC,{ref:t,className:(0,P.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",a),...r})]})});$.displayName=H.UC.displayName;let B=e=>{let{className:t,...a}=e;return(0,s.jsx)("div",{className:(0,P.cn)("flex flex-col space-y-2 text-center sm:text-left",t),...a})};B.displayName="AlertDialogHeader";let Z=e=>{let{className:t,...a}=e;return(0,s.jsx)("div",{className:(0,P.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",t),...a})};Z.displayName="AlertDialogFooter";let Q=A.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(H.hE,{ref:t,className:(0,P.cn)("text-lg font-semibold",a),...r})});Q.displayName=H.hE.displayName;let K=A.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(H.VY,{ref:t,className:(0,P.cn)("text-sm text-muted-foreground",a),...r})});K.displayName=H.VY.displayName;let ee=A.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(H.rc,{ref:t,className:(0,P.cn)((0,Y.r)(),a),...r})});ee.displayName=H.rc.displayName;let et=A.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(H.ZD,{ref:t,className:(0,P.cn)((0,Y.r)({variant:"outline"}),"mt-2 sm:mt-0",a),...r})});et.displayName=H.ZD.displayName;var ea=a(14636),es=a(44838),er=a(85511),en=a(47262),el=a(62523),ei=a(85057),eo=a(62177),ed=a(90221),ec=a(55594),eu=a(6874),em=a.n(eu),ef=a(35695),ep=a(91394),eh=a(74466);let ex=[{base:"bg-blue-500",hover:"hover:bg-blue-600",progress:"bg-blue-700"},{base:"bg-teal-500",hover:"hover:bg-teal-600",progress:"bg-teal-700"},{base:"bg-rose-500",hover:"hover:bg-rose-600",progress:"bg-rose-700"},{base:"bg-amber-500",hover:"hover:bg-amber-600",progress:"bg-amber-700"},{base:"bg-cyan-500",hover:"hover:bg-cyan-600",progress:"bg-cyan-700"},{base:"bg-lime-500",hover:"hover:bg-lime-600",progress:"bg-lime-700"}],eg={base:"bg-gray-400",hover:"hover:bg-gray-500",progress:"bg-gray-600"},eb={VALIDATION_PROJECT:{base:"bg-purple-500",hover:"hover:bg-purple-600"},VALIDATION_STEP:{base:"bg-indigo-500",hover:"hover:bg-indigo-600"},DEFAULT:{base:"bg-amber-500",hover:"hover:bg-amber-600"}},ey=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return e.split(" ").map(e=>e[0]).filter((e,t,a)=>0===t||t===a.length-1).join("").toUpperCase()},ev=(e,t)=>{let a="An unexpected error occurred while ".concat(t||"processing your request",".");if(e&&"object"==typeof e){var s,r;"status"in e&&0===e.status?a="Failed to connect to the server while ".concat(t||"processing",". Please check your internet connection."):(null==(s=e.data)?void 0:s.message)?a=e.data.message:e.message&&!e.message.startsWith("PocketBase_ClientResponseError")?a=e.message:(null==(r=e.originalError)?void 0:r.message)&&(a=e.originalError.message),"status"in e&&e.status&&0!==e.status&&(a="".concat(a," (Status: ").concat(e.status,")"))}else"string"==typeof e&&(a=e);return a},ej=ec.Ik({title:ec.Yj().min(1,"Title is required."),startDate:ec.p6().optional(),dueDate:ec.p6().optional(),isMilestone:ec.zM().optional()}).refine(e=>{if(!0===e.isMilestone){if(!e.startDate||e.dueDate&&e.startDate.getTime()!==e.dueDate.getTime())return!1}else if(e.startDate&&e.dueDate&&e.startDate>e.dueDate)return!1;return!0},{message:"Date configuration invalid. Milestones require a single date (set via Start Date). For ranges, start date must be before or same as due date.",path:["startDate"]}),eN=e=>{let{task:t,onSave:a,onClose:r}=e,n=(0,eo.mN)({resolver:(0,ed.u)(ej),defaultValues:{title:t.title,startDate:t.startDate?new Date(t.startDate):void 0,dueDate:t.dueDate?new Date(t.dueDate):void 0,isMilestone:("VALIDATION_PROJECT"===t.task_type||"VALIDATION_STEP"===t.task_type)&&!!t.isMilestone}}),[l,i]=(0,A.useState)(!1),o=n.watch("isMilestone"),d=n.watch("startDate");(0,A.useEffect)(()=>{if(("VALIDATION_PROJECT"===t.task_type||"VALIDATION_STEP"===t.task_type)&&o&&d){var e;n.getValues("dueDate")&&(null==(e=n.getValues("dueDate"))?void 0:e.getTime())===d.getTime()||n.setValue("dueDate",d,{shouldValidate:!0})}},[o,d,t.task_type,n]);let c=async e=>{i(!0);let s={title:e.title,startDate:e.startDate,dueDate:e.dueDate};("VALIDATION_PROJECT"===t.task_type||"VALIDATION_STEP"===t.task_type)&&(s.isMilestone=e.isMilestone,e.isMilestone&&e.startDate&&(s.dueDate=e.startDate));try{await a(t.id,s),r()}finally{i(!1)}};return(0,s.jsxs)("form",{onSubmit:n.handleSubmit(c),className:"space-y-4",children:[(0,s.jsxs)("h4",{className:"font-medium text-sm leading-none",children:["Edit: ",t.title]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(ei.J,{htmlFor:"quickEditTitle",children:"Task Name"}),(0,s.jsx)(el.p,{id:"quickEditTitle",...n.register("title"),className:"mt-1"}),n.formState.errors.title&&(0,s.jsx)("p",{className:"text-xs text-destructive mt-1",children:n.formState.errors.title.message})]}),("VALIDATION_PROJECT"===t.task_type||"VALIDATION_STEP"===t.task_type)&&(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)(eo.xI,{name:"isMilestone",control:n.control,render:e=>{let{field:t}=e;return(0,s.jsx)(en.S,{id:"quickEditIsMilestone",checked:t.value,onCheckedChange:t.onChange})}})," ",(0,s.jsx)(ei.J,{htmlFor:"quickEditIsMilestone",className:"text-sm font-normal",children:"Is Milestone"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(ei.J,{children:"Start Date"}),(0,s.jsx)(eo.xI,{control:n.control,name:"startDate",render:e=>{let{field:t}=e;return(0,s.jsxs)(ea.AM,{children:[(0,s.jsx)(ea.Wv,{asChild:!0,children:(0,s.jsxs)(Y.$,{variant:"outline",className:(0,P.cn)("w-full justify-start text-left font-normal mt-1",!t.value&&"text-muted-foreground"),children:[(0,s.jsx)(X.A,{className:"mr-2 h-4 w-4"}),t.value?(0,f.GP)(t.value,"PPP"):(0,s.jsx)("span",{children:"Pick a date"})]})}),(0,s.jsx)(ea.hl,{className:"w-auto p-0",children:(0,s.jsx)(er.V,{mode:"single",selected:t.value,onSelect:t.onChange,initialFocus:!0})})]})}}),n.formState.errors.startDate&&(0,s.jsx)("p",{className:"text-xs text-destructive mt-1",children:n.formState.errors.startDate.message})]}),!o&&(0,s.jsxs)("div",{children:[(0,s.jsx)(ei.J,{children:"Due Date"}),(0,s.jsx)(eo.xI,{control:n.control,name:"dueDate",render:e=>{let{field:t}=e;return(0,s.jsxs)(ea.AM,{children:[(0,s.jsx)(ea.Wv,{asChild:!0,children:(0,s.jsxs)(Y.$,{variant:"outline",className:(0,P.cn)("w-full justify-start text-left font-normal mt-1",!t.value&&"text-muted-foreground"),children:[(0,s.jsx)(X.A,{className:"mr-2 h-4 w-4"}),t.value?(0,f.GP)(t.value,"PPP"):(0,s.jsx)("span",{children:"Pick a date"})]})}),(0,s.jsx)(ea.hl,{className:"w-auto p-0",children:(0,s.jsx)(er.V,{mode:"single",selected:t.value,onSelect:t.onChange,disabled:e=>!!n.watch("startDate")&&e<n.watch("startDate"),initialFocus:!0})})]})}}),n.formState.errors.dueDate&&(0,s.jsx)("p",{className:"text-xs text-destructive mt-1",children:n.formState.errors.dueDate.message})]}),(0,s.jsxs)("div",{className:"flex justify-end space-x-2 pt-2",children:[(0,s.jsxs)(Y.$,{type:"button",variant:"ghost",onClick:r,disabled:l,children:[(0,s.jsx)(G.A,{className:"mr-2 h-4 w-4"}),"Cancel"]}),(0,s.jsxs)(Y.$,{type:"submit",disabled:l,children:[l?(0,s.jsx)(E.A,{className:"mr-2 h-4 w-4 animate-spin"}):(0,s.jsx)(J.A,{className:"mr-2 h-4 w-4"}),"Save"]})]})]})},ew=e=>{let{filterTaskType:t="ALL_EXCEPT_VALIDATION",displayHeaderControls:a="defaultTitle"}=e,{pbClient:X}=(0,_.A)(),{toast:G}=(0,I.dj)(),J=(0,ef.useRouter)(),[H,W]=(0,A.useState)([]),[U,er]=(0,A.useState)([]),[en,el]=(0,A.useState)(!0),[ei,eo]=(0,A.useState)(null),[ed,ec]=(0,A.useState)((0,r.w)(new Date)),[eu,eh]=(0,A.useState)("week"),[ej,ew]=(0,A.useState)(null),[ek,eT]=(0,A.useState)(null),[eA,eP]=(0,A.useState)(null),[e_,eM]=(0,A.useState)(new Set),eC=(0,A.useRef)(null),eI=(0,A.useRef)(null),eE=(0,A.useRef)(null),[eL,eS]=(0,A.useState)(!1),[eO,ez]=(0,A.useState)(null),[eV,eR]=(0,A.useState)(null),[eX,eG]=(0,A.useState)(!1),eJ=(0,A.useCallback)(async(e,t)=>{if(!e)return void el(!0);el(!0),eo(null);try{let a=(0,n.e)(new Date,5),[s,o]=await Promise.all([(0,M.x1)(e,{signal:t,projectionHorizon:a}),(0,C.Oc)(e,{signal:t})]),d=s.filter(e=>e.startDate&&e.dueDate&&(0,l.f)(new Date(e.startDate))&&(0,l.f)(new Date(e.dueDate)));if(W(d),er(o),d.length>0){let e=(0,i.j)(d.map(e=>new Date(e.startDate)));ec((0,r.w)(e))}else ec((0,r.w)(new Date))}catch(e){if((null==e?void 0:e.isAbort)===!0||"string"==typeof(null==e?void 0:e.message)&&e.message.toLowerCase().includes("autocancelled"))console.warn("GanttChart: Timeline data fetch request was ".concat((null==e?void 0:e.isAbort)?"aborted":"autocancelled","."),e);else{let t=ev(e,"fetching timeline data");eo(t),G({title:"Error Loading Timeline Data",description:t,variant:"destructive"}),console.warn("GanttChart: Error fetching data for timeline (after retries):",t,e)}}finally{el(!1)}},[G]);(0,A.useEffect)(()=>{let e=new AbortController;return X?eJ(X,e.signal):el(!0),()=>{e.abort()}},[X,eJ]);let{tasksToDisplay:eY,tasksById:eq,chartStartDate:eH,chartEndDate:eF,totalWidth:eW,pixelsPerDay:eU,topHeaderCells:e$,bottomHeaderCells:eB}=(0,A.useMemo)(()=>{let e,a=H.map(e=>{let t=(0,o.o)(new Date(e.startDate)),a=(0,o.o)(new Date(e.dueDate)),s=("VALIDATION_PROJECT"===e.task_type||"VALIDATION_STEP"===e.task_type)&&(!0===e.isMilestone||!1!==e.isMilestone&&(0,l.f)(t)&&(0,l.f)(a)&&(0,d.r)(t,a)),r="VALIDATION_PROJECT"===e.task_type,n=r?H.filter(t=>{var a;return"VALIDATION_STEP"===t.task_type&&(null==(a=t.dependencies)?void 0:a.includes(e.id))}):[];return{...e,startDate:t,dueDate:a,progress:"number"==typeof e.progress&&e.progress>=0&&e.progress<=100?e.progress:0,isMilestone:s,isParent:r,dependencies:Array.isArray(e.dependencies)?e.dependencies:[],children:n,assignee:U.find(t=>t.name===e.assignedTo_text)}}),s=a;"VALIDATION_PROJECT"===t?s=a.filter(e=>"VALIDATION_PROJECT"===e.task_type||"VALIDATION_STEP"===e.task_type):"ALL_EXCEPT_VALIDATION"===t&&(s=a.filter(e=>"VALIDATION_PROJECT"!==e.task_type&&"VALIDATION_STEP"!==e.task_type));let i=new Map(s.map(e=>[e.id,e])),v=new Map,j=0;s.filter(e=>e.isParent).forEach(e=>{!v.has(e.id)&&(v.set(e.id,ex[j%ex.length]),j++)});let N=function(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Set;if(a.has(e))return null;a.add(e);let s=t.get(e);if(!s)return null;if(s.isParent)return s.id;if(s.dependencies&&s.dependencies.length>0)for(let e of s.dependencies){let s=N(e,t,a);if(s)return s}return null},w=s.map(e=>{var t;let a=N(e.id,i),s=null!=(t=a?v.get(a):null)?t:eg;return{...e,color:s}}),D=w.filter(e=>"VALIDATION_STEP"!==e.task_type||!e.dependencies.some(e=>{var t;return i.has(e)&&(null==(t=i.get(e))?void 0:t.task_type)==="VALIDATION_PROJECT"})).sort((e,t)=>e.startDate.getTime()-t.startDate.getTime()),k=[];D.forEach(e=>(function e(t,a){k.push({...t,level:a}),t.isParent&&!e_.has(t.id)&&t.children.map(e=>w.find(t=>t.id===e.id)||{...e,color:eg}).sort((e,t)=>e.startDate.getTime()-t.startDate.getTime()).forEach(t=>{i.get(t.id)&&e(t,a+1)})})(e,0));let T={topHeaderCells:[],bottomHeaderCells:[],totalWidth:0,pixelsPerDay:0,chartEndDate:ed};switch(eu){case"day":{e=(0,c.p)((0,u.P)(ed,1)),T.pixelsPerDay=35;let t=(0,m.k)({start:ed,end:e}),a={};t.forEach(e=>{let t=(0,f.GP)(e,"MMM yyyy");a[t]=(a[t]||0)+1,T.bottomHeaderCells.push({key:(0,f.GP)(e,"yyyy-MM-dd"),label:(0,f.GP)(e,"d"),width:T.pixelsPerDay})}),Object.entries(a).forEach(e=>{let[t,a]=e;T.topHeaderCells.push({key:t,label:t,width:a*T.pixelsPerDay})});break}case"week":{e=(0,c.p)((0,u.P)(ed,2)),T.pixelsPerDay=20;let t=(0,m.k)({start:ed,end:e}),a={};t.forEach(e=>{let t=(0,f.GP)(e,"MMM yyyy");a[t]=(a[t]||0)+1,T.bottomHeaderCells.push({key:(0,f.GP)(e,"yyyy-MM-dd"),label:(0,f.GP)(e,"EEEEE"),width:T.pixelsPerDay})}),Object.entries(a).forEach(e=>{let[t,a]=e;T.topHeaderCells.push({key:t,label:t,width:a*T.pixelsPerDay})});break}case"month":{e=(0,p.Q)(ed),T.pixelsPerDay=4;let t=(0,h.Y)({start:(0,r.w)(ed),end:e},{weekStartsOn:1}),a={};t.forEach(e=>{let t=(0,f.GP)(e,"MMM yyyy");a[t]=(a[t]||0)+7,T.bottomHeaderCells.push({key:(0,f.GP)(e,"yyyy-MM-dd"),label:"W".concat((0,x.s)(e)),width:7*T.pixelsPerDay})}),Object.entries(a).forEach(e=>{let[t,a]=e,s=T.bottomHeaderCells.filter(e=>(0,f.GP)(new Date(e.key),"MMM yyyy")===t).reduce((e,t)=>e+t.width,0);T.topHeaderCells.push({key:t,label:t,width:s})});break}case"quarter":{e=(0,p.Q)((0,n.e)(ed,1)),T.pixelsPerDay=2;let t=(0,g.i)({start:(0,b.D)(ed),end:e}),a={};t.forEach(e=>{let t="".concat((0,f.GP)(e,"yyyy")," Q").concat((0,f.GP)(e,"q")),s=(0,y.c)((0,c.p)(e),e)+1;a[t]=(a[t]||0)+s,T.bottomHeaderCells.push({key:(0,f.GP)(e,"yyyy-MM"),label:(0,f.GP)(e,"MMM"),width:s*T.pixelsPerDay})}),Object.entries(a).forEach(e=>{let[t,a]=e;T.topHeaderCells.push({key:t,label:t.split(" ")[1],width:a*T.pixelsPerDay})})}}return T.chartEndDate=e,T.totalWidth=T.bottomHeaderCells.reduce((e,t)=>e+t.width,0),{tasksToDisplay:k,tasksById:i,chartStartDate:ed,...T}},[H,U,ed,eu,e_,t]),eZ=(0,A.useMemo)(()=>{let e=new Map;return eY.forEach((t,a)=>{let s=t.startDate,r=t.dueDate;if(ek&&ek.taskId===t.id){var n;let e=Math.round(((null!=(n=ek.currentMouseX)?n:ek.initialMouseX)-ek.initialMouseX)/eU);"drag"===ek.type?(s=(0,v.f)(ek.originalStartDate,e),r=(0,v.f)(ek.originalDueDate,e)):"resize-start"===ek.type?(s=(0,v.f)(ek.originalStartDate,e),s=(0,i.j)([s,(0,v.f)(ek.originalDueDate,-0)]),r=ek.originalDueDate):"resize-end"===ek.type&&(s=ek.originalStartDate,r=(0,v.f)(ek.originalDueDate,e),r=(0,j.T)([r,(0,v.f)(ek.originalStartDate,0)]))}let l=(0,y.c)(s,eH),o=(0,y.c)(r,s)+1;if(o<=0&&!t.isMilestone)return;let d=l*eU,c=t.isMilestone?14:o*eU;t.isMilestone&&(d+=eU/2-7),e.set(t.id,{task:t,index:a,barStartX:d,barWidth:c,barCenterY:40*a+20,effectiveStartDate:s,effectiveDueDate:r})}),e},[eY,eH,eU,ek]),eQ=(0,A.useMemo)(()=>{let e=[];return eY.forEach(t=>{if(!t.dependencies||0===t.dependencies.length)return;let a=eZ.get(t.id);a&&t.dependencies.forEach((s,r)=>{let n,l=eZ.get(s);if(!l)return;let i=l.task.isMilestone?l.barStartX+7:l.barStartX+l.barWidth,o=a.task.isMilestone?a.barStartX+7:a.barStartX,d=l.barCenterY,c=a.barCenterY,u=o-12,m=Math.sign(c-d),f=Math.abs(c-d),p=Math.min(8,Math.abs(u-i)/2,f/2,6);n=p<1||0===f?"M ".concat(i," ").concat(d," L ").concat(u," ").concat(d," L ").concat(u," ").concat(c," L ").concat(o," ").concat(c):"M ".concat(i," ").concat(d)+" L ".concat(u-p," ").concat(d)+" Q ".concat(u," ").concat(d," ").concat(u," ").concat(d+p*m)+" L ".concat(u," ").concat(c-p*m)+" Q ".concat(u," ").concat(c," ").concat(u+p," ").concat(c)+" L ".concat(o," ").concat(c);let h=(0,N.Y)(a.effectiveStartDate,l.effectiveDueDate);e.push({id:"dep-".concat(s,"-to-").concat(t.id,"-").concat(r),d:n,isConflict:h})})}),e},[eY,eZ]),eK=(0,A.useCallback)(async(e,t)=>{if(!X)return;let a=H.find(t=>t.id===e);if(!a)return;let s={...a,...t};W(t=>t.map(t=>t.id===e?s:t));try{await (0,M.lC)(X,e,t),G({title:"Task Updated",description:'Task "'.concat(s.title,'" was successfully updated.')})}catch(t){W(t=>t.map(t=>t.id===e?a:t)),(null==t?void 0:t.isAbort)===!0||"string"==typeof(null==t?void 0:t.message)&&t.message.toLowerCase().includes("autocancelled")?console.warn('Task update for "'.concat(s.title,'" was cancelled. This is usually not a problem.'),t):G({title:"Update Failed",description:ev(t,'updating task "'.concat(a.title,'"')),variant:"destructive"})}},[X,H,G]),e0=(0,A.useCallback)((e,t)=>{if(0!==e.button)return;let a=eZ.get(t.id);a&&(e.preventDefault(),e.stopPropagation(),eT({type:"drag",taskId:t.id,initialMouseX:e.clientX,originalStartDate:a.effectiveStartDate,originalDueDate:a.effectiveDueDate}),eE.current&&(eE.current.style.cursor="grabbing"),document.body.style.userSelect="none")},[eZ]),e1=(0,A.useCallback)((e,t,a)=>{if(0!==e.button)return;let s=eZ.get(t.id);s&&(e.preventDefault(),e.stopPropagation(),eT({type:"start"===a?"resize-start":"resize-end",taskId:t.id,initialMouseX:e.clientX,originalStartDate:s.effectiveStartDate,originalDueDate:s.effectiveDueDate}),eE.current&&(eE.current.style.cursor="ew-resize"),document.body.style.userSelect="none")},[eZ]),e5=(0,A.useCallback)((e,t)=>{var a;if(0!==e.button)return;let s=eZ.get(t.id);if(!s||t.isMilestone)return;e.preventDefault(),e.stopPropagation();let r=null==(a=eE.current)?void 0:a.getBoundingClientRect(),n=eC.current;if(!r||!n)return;let l=e.clientX-r.left+n.scrollLeft,i=e.clientY-r.top+n.scrollTop-60;eP({sourceTaskId:t.id,sourceTaskBarEndX:s.barStartX+s.barWidth,sourceTaskBarCenterY:s.barCenterY,currentMouseX:l,currentMouseY:i}),eE.current&&(eE.current.style.cursor="crosshair")},[eZ]),e4=(0,A.useCallback)(async()=>{if(eO&&X)try{await (0,M.vq)(X,eO.id),G({title:"Task Deleted",description:'Task "'.concat(eO.title,'" has been deleted.')}),eJ(X)}catch(e){G({title:"Delete Failed",description:ev(e,"deleting task"),variant:"destructive"})}finally{eS(!1),ez(null)}},[eO,X,G,eJ]),e2=e=>{eM(t=>{let a=new Set(t);return a.has(e)?a.delete(e):a.add(e),a})};(0,A.useEffect)(()=>{let e=e=>{if(ek)eT(t=>t?{...t,currentMouseX:e.clientX}:null);else if(eA&&eE.current){let t=eE.current.getBoundingClientRect(),a=eC.current;if(!a)return;let s=e.clientX-t.left+a.scrollLeft,r=e.clientY-t.top+a.scrollTop-60;eP(e=>e?{...e,currentMouseX:s,currentMouseY:r}:null)}},t=e=>{if(ek){let e=eZ.get(ek.taskId);if(e){let t=!(0,d.r)(ek.originalStartDate,e.effectiveStartDate),a=!(0,d.r)(ek.originalDueDate,e.effectiveDueDate);(t||a)&&eK(ek.taskId,{startDate:e.effectiveStartDate,dueDate:e.effectiveDueDate})}eT(null),eE.current&&(eE.current.style.cursor="default"),document.body.style.userSelect=""}else if(eA){var t;let a=null==(t=eE.current)?void 0:t.getBoundingClientRect(),s=eC.current;if(a&&s){let t=eY[Math.floor((e.clientY-a.top+s.scrollTop)/40)];if(t&&t.id!==eA.sourceTaskId){let e=t.dependencies||[],a=eq.get(eA.sourceTaskId),s=(null==a?void 0:a.dependencies)||[];e.includes(eA.sourceTaskId)||s.includes(t.id)?G({title:"Invalid Dependency",description:"Cannot create duplicate or circular dependency.",variant:"destructive"}):eK(t.id,{dependencies:[...e,eA.sourceTaskId]})}}eP(null),eE.current&&(eE.current.style.cursor="default")}};return(ek||eA)&&(window.addEventListener("mousemove",e),window.addEventListener("mouseup",t)),()=>{window.removeEventListener("mousemove",e),window.removeEventListener("mouseup",t)}},[ek,eA,eU,eZ,eK,eq,G,eY]);let e9=(e,t)=>{eG(e),e?eR(t):eR(null)};if((0,A.useEffect)(()=>{let e=null,t=()=>{"right"!==e&&(e="left",eI.current&&eC.current&&(eC.current.scrollTop=eI.current.scrollTop),requestAnimationFrame(()=>e=null))},a=()=>{"left"!==e&&(e="right",eI.current&&eC.current&&(eI.current.scrollTop=eC.current.scrollTop),requestAnimationFrame(()=>e=null))},s=eI.current,r=eC.current;return null==s||s.addEventListener("scroll",t),null==r||r.addEventListener("scroll",a),()=>{null==s||s.removeEventListener("scroll",t),null==r||r.removeEventListener("scroll",a)}},[]),en)return(0,s.jsxs)("div",{className:"flex justify-center items-center py-10 min-h-[400px]",children:[(0,s.jsx)(E.A,{className:"h-8 w-8 animate-spin text-primary"})," ",(0,s.jsx)("p",{className:"ml-2",children:"Loading timeline data..."})]});if(ei)return(0,s.jsxs)("div",{className:"text-center py-10 min-h-[400px]",children:[(0,s.jsx)(L.A,{className:"mx-auto h-12 w-12 text-destructive"}),(0,s.jsx)("p",{className:"mt-4 text-lg font-semibold",children:"Failed to Load Timeline Data"}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:ei}),(0,s.jsx)(Y.$,{onClick:()=>X&&eJ(X),className:"mt-6",children:"Try Again"})]});let e6=(0,o.o)(new Date),e8=(0,T.v)(e6,{start:eH,end:eF}),e3=e8?(0,y.c)(e6,eH)*eU:0,e7=40*eY.length;return(0,s.jsxs)(q.Bc,{children:[(0,s.jsxs)("div",{ref:eE,className:"gantt-chart-root flex flex-col h-[calc(100vh-250px)] overflow-hidden bg-background border border-border rounded-lg shadow-sm",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center p-2 border-b border-border flex-shrink-0",children:["addValidationButton"===a?(0,s.jsx)(em(),{href:"/tasks/new?defaultType=VALIDATION_PROJECT",passHref:!0,children:(0,s.jsxs)(Y.$,{variant:"outline",size:"sm",children:[(0,s.jsx)(S.A,{className:"mr-2 h-4 w-4"})," Add Validation Project"]})}):(0,s.jsx)("div",{}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("div",{className:"flex items-center rounded-md bg-muted p-1 text-sm",children:["day","week","month","quarter"].map(e=>(0,s.jsx)(Y.$,{size:"sm",variant:eu===e?"outline":"ghost",className:"h-7 px-2 capitalize",onClick:()=>eh(e),children:e},e))}),(0,s.jsxs)(Y.$,{variant:"outline",size:"sm",onClick:()=>ec(e=>{switch(eu){case"day":case"week":return(0,w.a)(e,1);case"month":return subQuartersDateFns(e,1);case"quarter":return(0,D.d)(e,1);default:return e}}),children:[(0,s.jsx)(O.A,{className:"h-4 w-4 mr-1"}),"Prev"]}),(0,s.jsxs)("span",{className:"font-medium text-sm text-muted-foreground tabular-nums w-48 text-center",children:[(0,f.GP)(ed,"MMM yyyy")," - ",(0,f.GP)(eF,"MMM yyyy")]}),(0,s.jsxs)(Y.$,{variant:"outline",size:"sm",onClick:()=>ec(e=>{switch(eu){case"day":case"week":return(0,u.P)(e,1);case"month":return(0,k.z)(e,1);case"quarter":return(0,n.e)(e,1);default:return e}}),children:["Next",(0,s.jsx)(z.A,{className:"h-4 w-4 ml-1"})]})]})]}),(0,s.jsxs)("div",{className:"flex flex-1 overflow-hidden",children:[(0,s.jsxs)("div",{style:{width:"".concat(450,"px")},className:"flex-shrink-0 border-r border-border flex flex-col",children:[(0,s.jsx)("div",{className:"h-[60px] flex items-center p-2 font-semibold text-xs border-b border-border flex-shrink-0 sticky top-0 bg-background/95 backdrop-blur-sm z-20 text-muted-foreground uppercase tracking-wider",children:(0,s.jsxs)("div",{className:"grid grid-cols-[1fr_80px_80px] w-full items-center gap-2",children:[(0,s.jsx)("span",{children:"Task Name"}),(0,s.jsx)("span",{className:"text-center",children:"Assignee"}),(0,s.jsx)("span",{className:"text-center",children:"Due Date"})]})}),(0,s.jsxs)("div",{ref:eI,className:"overflow-y-scroll flex-1",children:[0===eY.length&&!en&&(0,s.jsxs)("div",{className:"flex flex-col items-center justify-center h-full p-4 text-center text-sm",children:[(0,s.jsx)("p",{className:"text-muted-foreground",children:"VALIDATION_PROJECT"===t?"No Validation Projects found.":"ALL_EXCEPT_VALIDATION"===t?"No standard tasks found.":"No tasks with valid dates found."}),(0,s.jsx)("p",{className:"text-xs mt-1 text-muted-foreground",children:0===H.length?"Create a new task to get started.":"Try adjusting the date range or zoom."})]}),eY.map(e=>(0,s.jsxs)("div",{className:(0,P.cn)("grid grid-cols-[1fr_80px_80px] items-center gap-2 p-2 border-b border-border/60 text-sm group",e.id===ej?"bg-primary/5":""),style:{height:"".concat(40,"px"),paddingLeft:"".concat(1+1.5*e.level,"rem")},onMouseEnter:()=>ew(e.id),onMouseLeave:()=>ew(null),children:[(0,s.jsxs)("div",{className:"flex items-center gap-1 truncate",children:[e.isParent&&(0,s.jsx)(Y.$,{variant:"ghost",size:"icon",className:"h-5 w-5 -ml-6",onClick:()=>e2(e.id),children:(0,s.jsx)(V.A,{className:(0,P.cn)("h-4 w-4 transition-transform",!e_.has(e.id)&&"rotate-[-90deg]")})}),(0,s.jsx)("span",{className:"font-medium truncate",title:e.title,children:e.title}),e.isParent&&(0,s.jsx)(Y.$,{variant:"ghost",size:"icon",className:"h-5 w-5 opacity-0 group-hover:opacity-100 transition-opacity",onClick:t=>{t.stopPropagation(),J.push("/tasks/new?defaultType=VALIDATION_STEP&dependsOnValidationProject=".concat(e.id))},title:"Add a step to this project",children:(0,s.jsx)(S.A,{className:"h-4 w-4"})})]}),(0,s.jsx)("div",{className:"flex items-center justify-center",children:e.assignee?(0,s.jsxs)(q.m_,{children:[(0,s.jsx)(q.k$,{asChild:!0,children:(0,s.jsx)(ep.eu,{className:"h-6 w-6",children:(0,s.jsx)(ep.q5,{children:ey(e.assignee.name)})})}),(0,s.jsx)(q.ZI,{children:e.assignee.name})]}):(0,s.jsx)("div",{className:"h-6 w-6"})}),(0,s.jsx)("span",{className:(0,P.cn)("text-center text-xs",(0,N.Y)(e.dueDate,e6)&&"Done"!==e.status?"text-destructive":"text-muted-foreground"),children:(0,f.GP)(e.dueDate,"MMM dd")}),(0,s.jsxs)("div",{className:"absolute right-2 top-1/2 -translate-y-1/2 opacity-0 group-hover:opacity-100 transition-opacity",children:[(0,s.jsxs)(es.rI,{children:[(0,s.jsx)(es.ty,{asChild:!0,children:(0,s.jsx)(Y.$,{variant:"ghost",size:"icon",className:"h-6 w-6",children:(0,s.jsx)(R.A,{className:"h-4 w-4"})})}),(0,s.jsxs)(es.SQ,{align:"end",children:[(0,s.jsx)(es._2,{onClick:()=>{eR(e),eG(!0)},children:"Edit"}),e.isParent&&(0,s.jsx)(es._2,{onClick:t=>{t.stopPropagation(),J.push("/tasks/new?defaultType=VALIDATION_STEP&dependsOnValidationProject=".concat(e.id))},children:"Add Step"}),(0,s.jsx)(es._2,{className:"text-destructive",onClick:()=>{ez(e),eS(!0)},children:"Delete"})]})]}),(null==eV?void 0:eV.id)===e.id&&(0,s.jsxs)(ea.AM,{open:eX,onOpenChange:t=>e9(t,e),children:[(0,s.jsx)(ea.Wv,{asChild:!0,children:(0,s.jsx)("span",{})}),(0,s.jsx)(ea.hl,{className:"w-96 p-4",side:"bottom",align:"start",children:(0,s.jsx)(eN,{task:eV,onSave:eK,onClose:()=>eG(!1)})})]})]})]},"".concat(e.id,"-leftpanel")))]})]}),(0,s.jsx)("div",{className:"flex-1 overflow-auto",ref:eC,children:(0,s.jsxs)("div",{className:"relative timeline-inner-content",children:[(0,s.jsxs)("div",{className:"sticky top-0 z-20 bg-background/95 backdrop-blur-sm",children:[(0,s.jsx)("div",{className:"flex h-[30px] border-b border-border",children:e$.map(e=>(0,s.jsx)("div",{style:{width:"".concat(e.width,"px")},className:"flex-shrink-0 flex items-center justify-center border-r border-border font-semibold text-xs text-muted-foreground",children:e.label},e.key))}),(0,s.jsx)("div",{className:"flex h-[30px] border-b border-border",children:eB.map(e=>(0,s.jsx)("div",{style:{width:"".concat(e.width,"px")},className:"flex-shrink-0 flex items-center justify-center border-r border-border text-xs text-muted-foreground",children:e.label},e.key))})]}),(0,s.jsxs)("div",{className:"relative",style:{height:"".concat(e7,"px"),width:"".concat(eW,"px")},children:[(0,s.jsx)("div",{className:"absolute inset-0 flex",children:eB.map(e=>(0,s.jsx)("div",{style:{width:"".concat(e.width,"px")},className:"flex-shrink-0 border-r border-border/40 h-full"},e.key))}),(0,s.jsx)("div",{className:"absolute inset-0",children:eY.map((e,t)=>(0,s.jsx)("div",{className:(0,P.cn)("absolute left-0 right-0 border-b border-border/40",e.id===ej?"bg-primary/5":""),style:{top:"".concat(40*t,"px"),height:"".concat(40,"px"),width:"".concat(eW,"px")}},"row-".concat(e.id)))}),e8&&(0,s.jsx)("div",{className:"absolute top-0 bottom-0 w-0.5 bg-destructive z-[5]",style:{left:"".concat(e3,"px")},title:"Today: ".concat((0,f.GP)(e6,"PPP")),children:(0,s.jsx)("div",{className:"absolute -top-5 left-1/2 -translate-x-1/2 bg-destructive text-white text-[10px] px-1 rounded-sm font-semibold",children:"TODAY"})}),(0,s.jsxs)("svg",{width:eW,height:e7,className:"absolute inset-0 pointer-events-none z-10",children:[(0,s.jsxs)("defs",{children:[(0,s.jsx)("marker",{id:"arrowhead",markerWidth:4.8,markerHeight:3.2,refX:4.4,refY:1.6,orient:"auto-start-reverse",children:(0,s.jsx)("polygon",{points:"0 0, ".concat(4," ").concat(1.6,", 0 ").concat(3.2),className:"fill-muted-foreground/70"})}),(0,s.jsx)("marker",{id:"arrowhead-conflict",markerWidth:4.8,markerHeight:3.2,refX:4.4,refY:1.6,orient:"auto-start-reverse",children:(0,s.jsx)("polygon",{points:"0 0, ".concat(4," ").concat(1.6,", 0 ").concat(3.2),className:"fill-amber-500"})})]}),eQ.map(e=>(0,s.jsx)("path",{d:e.d,strokeWidth:"1.2",fill:"none",markerEnd:e.isConflict?"url(#arrowhead-conflict)":"url(#arrowhead)",className:(0,P.cn)(e.isConflict?"stroke-amber-500":"stroke-muted-foreground/70","transition-stroke")},e.id))]}),eA&&(0,s.jsx)("svg",{className:"absolute top-0 left-0 w-full h-full pointer-events-none z-40",children:(0,s.jsx)("line",{x1:eA.sourceTaskBarEndX,y1:eA.sourceTaskBarCenterY,x2:eA.currentMouseX,y2:eA.currentMouseY,stroke:"hsl(var(--primary))",strokeWidth:"2",strokeDasharray:"4 2"})}),(0,s.jsx)("div",{className:"absolute inset-0",children:eY.map((e,t)=>{let a=eZ.get(e.id);if(!a)return null;let r=(null==ek?void 0:ek.taskId)===e.id,n="VALIDATION_PROJECT"===e.task_type?eb.VALIDATION_PROJECT:"VALIDATION_STEP"===e.task_type?eb.VALIDATION_STEP:eb.DEFAULT;return(0,s.jsxs)(q.m_,{delayDuration:r?999999:100,children:[(0,s.jsx)(q.k$,{asChild:!0,children:(0,s.jsx)("div",{onMouseDown:t=>e0(t,e),onMouseEnter:()=>ew(e.id),onMouseLeave:()=>ew(null),className:(0,P.cn)("absolute transition-opacity duration-150 ease-in-out group z-10 flex items-center justify-center cursor-grab rounded-md"),style:{left:"".concat(a.barStartX,"px"),width:"".concat(a.barWidth<0?0:a.barWidth,"px"),top:"".concat(40*t+6,"px"),height:28},children:e.isMilestone?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:(0,P.cn)("absolute inset-0 flex items-center justify-center pointer-events-none",n.base,n.hover),style:{clipPath:"polygon(50% 0%, 100% 50%, 50% 100%, 0% 50%)",width:14,height:14,left:"50%",top:"50%",transform:"translate(-50%,-50%)"}}),(0,s.jsx)("span",{className:"absolute text-xs text-foreground/80 whitespace-nowrap",style:{left:"calc(100% + 4px)",top:"50%",transform:"translateY(-50%)"},children:e.title})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:(0,P.cn)("h-full w-full rounded-md",e.color.base,e.color.hover),children:(0,s.jsx)("div",{className:(0,P.cn)("h-full rounded-md",e.color.progress),style:{width:"".concat(e.progress||0,"%")}})}),(0,s.jsx)("div",{onMouseDown:t=>e1(t,e,"start"),className:"absolute top-1/2 -translate-y-1/2 -left-1 w-3 h-3 rounded-full bg-background border-2 border-primary cursor-ew-resize z-20 opacity-0 group-hover:opacity-100 transition-opacity",title:"Resize start date"}),(0,s.jsx)("div",{onMouseDown:t=>e1(t,e,"end"),className:"absolute top-1/2 -translate-y-1/2 -right-1 w-3 h-3 rounded-full bg-background border-2 border-primary cursor-ew-resize z-20 opacity-0 group-hover:opacity-100 transition-opacity",title:"Resize end date"}),(0,s.jsx)("div",{className:"absolute right-[-6px] top-1/2 -translate-y-1/2 w-3 h-3 rounded-full bg-primary border-2 border-background cursor-crosshair z-30 opacity-0 group-hover:opacity-100 transition-opacity",onMouseDown:t=>e5(t,e),title:"Draw dependency"})]})})}),(0,s.jsx)(q.ZI,{className:"p-2 shadow-lg bg-popover text-popover-foreground rounded-md border max-w-xs w-auto z-50",children:(0,s.jsxs)("div",{className:"space-y-1",children:[(0,s.jsx)("p",{className:"font-semibold text-sm",children:e.title}),(0,s.jsxs)("p",{className:"text-xs text-muted-foreground",children:["Type: ",(0,s.jsx)("span",{className:"font-medium text-foreground",children:e.task_type.replace(/_/g," ")})]}),(0,s.jsxs)("p",{className:"text-xs text-muted-foreground",children:["Dates: ",(0,f.GP)(e.startDate,"MMM d, yy")," - ",(0,f.GP)(e.dueDate,"MMM d, yy")]}),e.assignee&&(0,s.jsxs)("p",{className:"text-xs text-muted-foreground",children:["Assigned to: ",(0,s.jsx)("span",{className:"font-medium text-foreground",children:e.assignee.name})]})]})})]},"".concat(e.id,"-timeline"))})})]})]})})]})]}),eO&&(0,s.jsx)(F,{open:eL,onOpenChange:eS,children:(0,s.jsxs)($,{children:[(0,s.jsxs)(B,{children:[(0,s.jsx)(Q,{children:"Confirm Deletion"}),(0,s.jsxs)(K,{children:['Are you sure you want to delete the task "',eO.title,'"? This action cannot be undone.']})]}),(0,s.jsxs)(Z,{children:[(0,s.jsx)(et,{onClick:()=>ez(null),children:"Cancel"}),(0,s.jsx)(ee,{onClick:e4,className:(0,P.cn)(eD({variant:"destructive"})),children:"Delete Task"})]})]})})]})},eD=(0,eh.F)("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}})},91394:(e,t,a)=>{a.d(t,{BK:()=>o,eu:()=>i,q5:()=>d});var s=a(95155),r=a(12115),n=a(85977),l=a(59434);let i=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(n.bL,{ref:t,className:(0,l.cn)("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full bg-muted",a),...r})});i.displayName=n.bL.displayName;let o=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(n._V,{ref:t,className:(0,l.cn)("aspect-square h-full w-full",a),...r})});o.displayName=n._V.displayName;let d=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(n.H4,{ref:t,className:(0,l.cn)("flex h-full w-full items-center justify-center rounded-full bg-muted",a),...r})});d.displayName=n.H4.displayName}}]);