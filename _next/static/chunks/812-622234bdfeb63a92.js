"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[812],{11178:(e,t,a)=>{a.d(t,{T:()=>eu});var r=a(95155),s=a(19164),n=a(86622),o=a(44861),i=a(92759),l=a(80644),d=a(76959),c=a(74641),u=a(24386),m=a(7860),f=a(73168),p=a(78039),h=a(1407),x=a(94376),g=a(94260),y=a(67646),b=a(78345),v=a(15175),w=a(70831),N=a(56313),j=a(63482),D=a(37140),k=a(45887),T=a(52873),A=a(12115),C=a(59434),_=a(59576),P=a(77694),E=a(87481),M=a(50172),I=a(31949),L=a(34301),O=a(965),S=a(73158),R=a(79556),V=a(3561),z=a(51920),F=a(24371),J=a(59119),H=a(30285),X=a(44838),q=a(46102),G=a(90010),Y=a(14636),U=a(85511),B=a(47262),$=a(62523),W=a(85057),Z=a(62177),Q=a(90221),K=a(55594),ee=a(6874),et=a.n(ee),ea=a(35695),er=a(91394),es=a(74466);let en=[{base:"bg-blue-500",hover:"hover:bg-blue-600",progress:"bg-blue-700"},{base:"bg-teal-500",hover:"hover:bg-teal-600",progress:"bg-teal-700"},{base:"bg-rose-500",hover:"hover:bg-rose-600",progress:"bg-rose-700"},{base:"bg-amber-500",hover:"hover:bg-amber-600",progress:"bg-amber-700"},{base:"bg-cyan-500",hover:"hover:bg-cyan-600",progress:"bg-cyan-700"},{base:"bg-lime-500",hover:"hover:bg-lime-600",progress:"bg-lime-700"}],eo={base:"bg-gray-400",hover:"hover:bg-gray-500",progress:"bg-gray-600"},ei={VALIDATION_PROJECT:{base:"bg-purple-500",hover:"hover:bg-purple-600"},VALIDATION_STEP:{base:"bg-indigo-500",hover:"hover:bg-indigo-600"},DEFAULT:{base:"bg-amber-500",hover:"hover:bg-amber-600"}},el=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return e.split(" ").map(e=>e[0]).filter((e,t,a)=>0===t||t===a.length-1).join("").toUpperCase()},ed=(e,t)=>{let a="An unexpected error occurred while ".concat(t||"processing your request",".");if(e&&"object"==typeof e){var r,s;"status"in e&&0===e.status?a="Failed to connect to the server while ".concat(t||"processing",". Please check your internet connection."):(null==(r=e.data)?void 0:r.message)?a=e.data.message:e.message&&!e.message.startsWith("PocketBase_ClientResponseError")?a=e.message:(null==(s=e.originalError)?void 0:s.message)&&(a=e.originalError.message),"status"in e&&e.status&&0!==e.status&&(a="".concat(a," (Status: ").concat(e.status,")"))}else"string"==typeof e&&(a=e);return a},ec=K.Ik({title:K.Yj().min(1,"Title is required."),startDate:K.p6().optional(),dueDate:K.p6().optional(),isMilestone:K.zM().optional()}).refine(e=>{if(!0===e.isMilestone){if(!e.startDate||e.dueDate&&e.startDate.getTime()!==e.dueDate.getTime())return!1}else if(e.startDate&&e.dueDate&&e.startDate>e.dueDate)return!1;return!0},{message:"Date configuration invalid. Milestones require a single date (set via Start Date). For ranges, start date must be before or same as due date.",path:["startDate"]}),eu=e=>{let{filterTaskType:t="ALL_EXCEPT_VALIDATION",displayHeaderControls:a="defaultTitle"}=e,{pbClient:z}=(0,_.A)(),{toast:F}=(0,E.dj)(),J=(0,ea.useRouter)(),[U,B]=(0,A.useState)([]),[$,W]=(0,A.useState)(!0),[Z,Q]=(0,A.useState)(null),[K,ee]=(0,A.useState)((0,s.w)(new Date)),[es,ec]=(0,A.useState)("week"),[eu,ep]=(0,A.useState)(null),[eh,ex]=(0,A.useState)(null),[eg,ey]=(0,A.useState)(null),[eb,ev]=(0,A.useState)(new Set),ew=(0,A.useRef)(null),eN=(0,A.useRef)(null),ej=(0,A.useRef)(null),[eD,ek]=(0,A.useState)(!1),[eT,eA]=(0,A.useState)(null),[eC,e_]=(0,A.useState)(null),[eP,eE]=(0,A.useState)(!1),eM=(0,A.useCallback)(async(e,t)=>{if(!e)return void W(!0);W(!0),Q(null);try{let a=(0,n.e)(new Date,5),r=(await (0,P.x1)(e,{signal:t,projectionHorizon:a})).filter(e=>e.startDate&&e.dueDate&&(0,o.f)(new Date(e.startDate))&&(0,o.f)(new Date(e.dueDate)));if(B(r),r.length>0){let e=(0,i.j)(r.map(e=>new Date(e.startDate)));ee((0,s.w)(e))}else ee((0,s.w)(new Date))}catch(e){if((null==e?void 0:e.isAbort)===!0||"string"==typeof(null==e?void 0:e.message)&&e.message.toLowerCase().includes("autocancelled"))console.warn("GanttChart: Timeline data fetch request was ".concat((null==e?void 0:e.isAbort)?"aborted":"autocancelled","."),e);else{let t=ed(e,"fetching timeline data");Q(t),F({title:"Error Loading Timeline Data",description:t,variant:"destructive"}),console.warn("GanttChart: Error fetching data for timeline (after retries):",t,e)}}finally{W(!1)}},[F]);(0,A.useEffect)(()=>{let e=new AbortController;return z?eM(z,e.signal):W(!0),()=>{e.abort()}},[z,eM]);let{tasksToDisplay:eI,tasksById:eL,chartStartDate:eO,chartEndDate:eS,totalWidth:eR,pixelsPerDay:eV,topHeaderCells:ez,bottomHeaderCells:eF}=(0,A.useMemo)(()=>{let e,a=U.map(e=>{var t;let a=(0,l.o)(new Date(e.startDate)),r=(0,l.o)(new Date(e.dueDate)),s=("VALIDATION_PROJECT"===e.task_type||"VALIDATION_STEP"===e.task_type)&&(!0===e.isMilestone||!1!==e.isMilestone&&(0,o.f)(a)&&(0,o.f)(r)&&(0,d.r)(a,r)),n="VALIDATION_PROJECT"===e.task_type,i=n?U.filter(t=>{var a;return"VALIDATION_STEP"===t.task_type&&(null==(a=t.dependencies)?void 0:a.includes(e.id))}):[];return{...e,startDate:a,dueDate:r,progress:"number"==typeof e.progress&&e.progress>=0&&e.progress<=100?e.progress:0,isMilestone:s,isParent:n,dependencies:Array.isArray(e.dependencies)?e.dependencies:[],children:i,assignees:(null==(t=e.expand)?void 0:t.assignedTo)||[]}}),r=a;"VALIDATION_PROJECT"===t?r=a.filter(e=>"VALIDATION_PROJECT"===e.task_type||"VALIDATION_STEP"===e.task_type):"ALL_EXCEPT_VALIDATION"===t&&(r=a.filter(e=>"VALIDATION_PROJECT"!==e.task_type&&"VALIDATION_STEP"!==e.task_type));let n=new Map(r.map(e=>[e.id,e])),i=new Map,w=0;r.filter(e=>e.isParent).sort((e,t)=>new Date(e.startDate).getTime()-new Date(t.startDate).getTime()).forEach(e=>{i.set(e.id,en[w%en.length]),w++});let N=function(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Set;if(a.has(e))return null;a.add(e);let r=t.get(e);if(!r)return null;if(r.isParent)return r.id;if(r.dependencies&&r.dependencies.length>0)for(let e of r.dependencies){let r=N(e,t,a);if(r)return r}return null},j=r.map(e=>{var t;let a=N(e.id,n),r=null!=(t=a?i.get(a):null)?t:eo;return{...e,color:r}}),D=j.filter(e=>"VALIDATION_STEP"!==e.task_type||!e.dependencies.some(e=>{var t;return n.has(e)&&(null==(t=n.get(e))?void 0:t.task_type)==="VALIDATION_PROJECT"})).sort((e,t)=>e.startDate.getTime()-t.startDate.getTime()),k=[];D.forEach(e=>(function e(t,a){k.push({...t,level:a}),t.isParent&&!eb.has(t.id)&&t.children.map(e=>j.find(t=>t.id===e.id)||{...e,color:eo}).sort((e,t)=>e.startDate.getTime()-t.startDate.getTime()).forEach(t=>{n.get(t.id)&&e(t,a+1)})})(e,0));let T={topHeaderCells:[],bottomHeaderCells:[],totalWidth:0,pixelsPerDay:0,chartEndDate:K},A=K;switch(es){case"day":{A=(0,s.w)(K),e=(0,c.p)(K),T.pixelsPerDay=2e3/((0,u.c)(e,A)+1);let t=(0,m.k)({start:A,end:e}),a={};t.forEach(e=>{let t=(0,f.GP)(e,"MMM yyyy");a[t]=(a[t]||0)+1,T.bottomHeaderCells.push({key:(0,f.GP)(e,"yyyy-MM-dd"),label:(0,f.GP)(e,"d"),width:T.pixelsPerDay})}),Object.entries(a).forEach(e=>{let[t,a]=e;T.topHeaderCells.push({key:t,label:t,width:a*T.pixelsPerDay})});break}case"week":{A=(0,s.w)(K),e=(0,c.p)((0,p.P)(A,1)),T.pixelsPerDay=2e3/((0,u.c)(e,A)+1);let t=(0,m.k)({start:A,end:e}),a={};t.forEach(e=>{let t=(0,f.GP)(e,"MMM yyyy");a[t]=(a[t]||0)+1,T.bottomHeaderCells.push({key:(0,f.GP)(e,"yyyy-MM-dd"),label:(0,f.GP)(e,"EEEEE"),width:T.pixelsPerDay})}),Object.entries(a).forEach(e=>{let[t,a]=e;T.topHeaderCells.push({key:t,label:t,width:a*T.pixelsPerDay})});break}case"month":{A=(0,h.D)(K),e=(0,x.Q)(K),T.pixelsPerDay=2e3/((0,u.c)(e,A)+1);let t=(0,g.i)({start:A,end:e});T.topHeaderCells.push({key:(0,f.GP)(A,"yyyy"),label:(0,f.GP)(A,"yyyy"),width:2e3}),t.forEach(e=>{let t=(0,c.p)(e),a=(0,u.c)(t,e)+1;T.bottomHeaderCells.push({key:(0,f.GP)(e,"yyyy-MM"),label:(0,f.GP)(e,"MMMM"),width:a*T.pixelsPerDay})});break}case"quarter":{let t=(0,h.D)(K);e=(0,x.Q)(K),A=t,T.pixelsPerDay=2e3/((0,u.c)(e,A)+1),T.topHeaderCells.push({key:(0,f.GP)(A,"yyyy"),label:(0,f.GP)(A,"yyyy"),width:2e3});for(let e=0;e<4;e++){let t=(0,y.a)((0,b.z)(A,e)),a=(0,v.j)(t),r=(0,u.c)(a,t)+1;T.bottomHeaderCells.push({key:"".concat((0,f.GP)(t,"yyyy"),"-Q").concat(e+1),label:"Q".concat(e+1),width:r*T.pixelsPerDay})}}}return T.chartEndDate=e,T.totalWidth=2e3,{tasksToDisplay:k,tasksById:n,chartStartDate:A,...T}},[U,K,es,eb,t]),eJ=(0,A.useMemo)(()=>{let e=new Map;return eI.forEach((t,a)=>{let r=t.startDate,s=t.dueDate;if(eh&&eh.taskId===t.id){var n;let e=Math.round(((null!=(n=eh.currentMouseX)?n:eh.initialMouseX)-eh.initialMouseX)/eV);"drag"===eh.type?(r=(0,w.f)(eh.originalStartDate,e),s=(0,w.f)(eh.originalDueDate,e)):"resize-start"===eh.type?(r=(0,w.f)(eh.originalStartDate,e),r=(0,i.j)([r,(0,w.f)(eh.originalDueDate,-0)]),s=eh.originalDueDate):"resize-end"===eh.type&&(r=eh.originalStartDate,s=(0,w.f)(eh.originalDueDate,e),s=(0,N.T)([s,(0,w.f)(eh.originalStartDate,0)]))}let o=(0,u.c)(r,eO),l=(0,u.c)(s,r)+1;if(l<=0&&!t.isMilestone)return;let d=o*eV,c=t.isMilestone?14:l*eV;t.isMilestone&&(d+=eV/2-7),e.set(t.id,{task:t,index:a,barStartX:d,barWidth:c,barCenterY:40*a+20,effectiveStartDate:r,effectiveDueDate:s})}),e},[eI,eO,eV,eh]),eH=(0,A.useMemo)(()=>{let e=[];return eI.forEach(t=>{if(!t.dependencies||0===t.dependencies.length)return;let a=eJ.get(t.id);a&&t.dependencies.forEach((r,s)=>{let n,o=eJ.get(r);if(!o)return;let i=o.task.isMilestone?o.barStartX+7:o.barStartX+o.barWidth,l=a.task.isMilestone?a.barStartX+7:a.barStartX,d=o.barCenterY,c=a.barCenterY,u=l-12,m=Math.sign(c-d),f=Math.abs(c-d),p=Math.min(8,Math.abs(u-i)/2,f/2,6);n=p<1||0===f?"M ".concat(i," ").concat(d," L ").concat(u," ").concat(d," L ").concat(u," ").concat(c," L ").concat(l," ").concat(c):"M ".concat(i," ").concat(d)+" L ".concat(u-p," ").concat(d)+" Q ".concat(u," ").concat(d," ").concat(u," ").concat(d+p*m)+" L ".concat(u," ").concat(c-p*m)+" Q ".concat(u," ").concat(c," ").concat(u+p," ").concat(c)+" L ".concat(l," ").concat(c);let h=(0,j.Y)(a.effectiveStartDate,o.effectiveDueDate);e.push({id:"dep-".concat(r,"-to-").concat(t.id,"-").concat(s),d:n,isConflict:h})})}),e},[eI,eJ]),eX=(0,A.useCallback)(async(e,t)=>{if(!z)return;let a=U.find(t=>t.id===e);if(!a)return;let r={...a,...t};B(t=>t.map(t=>t.id===e?r:t));try{let a=await (0,P.lC)(z,e,t);B(t=>t.map(t=>t.id===e?a:t)),F({title:"Task Updated",description:'Task "'.concat(r.title,'" was successfully updated.')})}catch(t){B(t=>t.map(t=>t.id===e?a:t)),(null==t?void 0:t.isAbort)===!0||"string"==typeof(null==t?void 0:t.message)&&t.message.toLowerCase().includes("autocancelled")?console.warn('Task update for "'.concat(r.title,'" was cancelled. This is usually not a problem.'),t):F({title:"Update Failed",description:ed(t,'updating task "'.concat(a.title,'"')),variant:"destructive"})}},[z,U,F]),eq=(0,A.useCallback)((e,t)=>{if(0!==e.button)return;let a=eJ.get(t.id);a&&(e.preventDefault(),e.stopPropagation(),ex({type:"drag",taskId:t.id,initialMouseX:e.clientX,originalStartDate:a.effectiveStartDate,originalDueDate:a.effectiveDueDate}),ej.current&&(ej.current.style.cursor="grabbing"),document.body.style.userSelect="none")},[eJ]),eG=(0,A.useCallback)((e,t,a)=>{if(0!==e.button)return;let r=eJ.get(t.id);r&&(e.preventDefault(),e.stopPropagation(),ex({type:"start"===a?"resize-start":"resize-end",taskId:t.id,initialMouseX:e.clientX,originalStartDate:r.effectiveStartDate,originalDueDate:r.effectiveDueDate}),ej.current&&(ej.current.style.cursor="ew-resize"),document.body.style.userSelect="none")},[eJ]),eY=(0,A.useCallback)((e,t)=>{var a;if(0!==e.button)return;let r=eJ.get(t.id);if(!r||t.isMilestone)return;e.preventDefault(),e.stopPropagation();let s=null==(a=ej.current)?void 0:a.getBoundingClientRect(),n=ew.current;if(!s||!n)return;let o=e.clientX-s.left+n.scrollLeft,i=e.clientY-s.top+n.scrollTop-60;ey({sourceTaskId:t.id,sourceTaskBarEndX:r.barStartX+r.barWidth,sourceTaskBarCenterY:r.barCenterY,currentMouseX:o,currentMouseY:i}),ej.current&&(ej.current.style.cursor="crosshair")},[eJ]),eU=(0,A.useCallback)(async()=>{if(eT&&z)try{await (0,P.vq)(z,eT.id),F({title:"Task Deleted",description:'Task "'.concat(eT.title,'" has been deleted.')}),eM(z)}catch(e){F({title:"Delete Failed",description:ed(e,"deleting task"),variant:"destructive"})}finally{ek(!1),eA(null)}},[eT,z,F,eM]),eB=e=>{ev(t=>{let a=new Set(t);return a.has(e)?a.delete(e):a.add(e),a})};(0,A.useEffect)(()=>{let e=e=>{if(eh)ex(t=>t?{...t,currentMouseX:e.clientX}:null);else if(eg&&ej.current){let t=ej.current.getBoundingClientRect(),a=ew.current;if(!a)return;let r=e.clientX-t.left+a.scrollLeft,s=e.clientY-t.top+a.scrollTop-60;ey(e=>e?{...e,currentMouseX:r,currentMouseY:s}:null)}},t=e=>{if(eh){let e=eJ.get(eh.taskId);if(e){let t=!(0,d.r)(eh.originalStartDate,e.effectiveStartDate),a=!(0,d.r)(eh.originalDueDate,e.effectiveDueDate);(t||a)&&eX(eh.taskId,{startDate:e.effectiveStartDate,dueDate:e.effectiveDueDate})}ex(null),ej.current&&(ej.current.style.cursor="default"),document.body.style.userSelect=""}else if(eg){var t;let a=null==(t=ej.current)?void 0:t.getBoundingClientRect(),r=ew.current;if(a&&r){let t=eI[Math.floor((e.clientY-a.top+r.scrollTop)/40)];if(t&&t.id!==eg.sourceTaskId){let e=t.dependencies||[],a=eL.get(eg.sourceTaskId),r=(null==a?void 0:a.dependencies)||[];e.includes(eg.sourceTaskId)||r.includes(t.id)?F({title:"Invalid Dependency",description:"Cannot create duplicate or circular dependency.",variant:"destructive"}):eX(t.id,{dependencies:[...e,eg.sourceTaskId]})}}ey(null),ej.current&&(ej.current.style.cursor="default")}};return(eh||eg)&&(window.addEventListener("mousemove",e),window.addEventListener("mouseup",t)),()=>{window.removeEventListener("mousemove",e),window.removeEventListener("mouseup",t)}},[eh,eg,eV,eJ,eX,eL,F,eI]);let e$=(e,t)=>{eE(e),e?e_(t):e_(null)};if((0,A.useEffect)(()=>{let e=null,t=()=>{"right"!==e&&(e="left",eN.current&&ew.current&&(ew.current.scrollTop=eN.current.scrollTop),requestAnimationFrame(()=>e=null))},a=()=>{"left"!==e&&(e="right",eN.current&&ew.current&&(eN.current.scrollTop=ew.current.scrollTop),requestAnimationFrame(()=>e=null))},r=eN.current,s=ew.current;return null==r||r.addEventListener("scroll",t),null==s||s.addEventListener("scroll",a),()=>{null==r||r.removeEventListener("scroll",t),null==s||s.removeEventListener("scroll",a)}},[]),$)return(0,r.jsxs)("div",{className:"flex justify-center items-center py-10 min-h-[400px]",children:[(0,r.jsx)(M.A,{className:"h-8 w-8 animate-spin text-primary"})," ",(0,r.jsx)("p",{className:"ml-2",children:"Loading timeline data..."})]});if(Z)return(0,r.jsxs)("div",{className:"text-center py-10 min-h-[400px]",children:[(0,r.jsx)(I.A,{className:"mx-auto h-12 w-12 text-destructive"}),(0,r.jsx)("p",{className:"mt-4 text-lg font-semibold",children:"Failed to Load Timeline Data"}),(0,r.jsx)("p",{className:"text-sm text-muted-foreground",children:Z}),(0,r.jsx)(H.$,{onClick:()=>z&&eM(z),className:"mt-6",children:"Try Again"})]});let eW=(0,l.o)(new Date),eZ=(0,T.v)(eW,{start:eO,end:eS}),eQ=eZ?(0,u.c)(eW,eO)*eV:0,eK=40*eI.length;return(0,r.jsxs)(q.Bc,{children:[(0,r.jsxs)("div",{ref:ej,className:"gantt-chart-root flex flex-col h-[calc(100vh-250px)] overflow-hidden bg-background border border-border rounded-lg shadow-sm",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center p-2 border-b border-border flex-shrink-0",children:["addValidationButton"===a?(0,r.jsx)(et(),{href:"/tasks/new?defaultType=VALIDATION_PROJECT",passHref:!0,children:(0,r.jsxs)(H.$,{variant:"outline",size:"sm",children:[(0,r.jsx)(L.A,{className:"mr-2 h-4 w-4"})," Add Validation Project"]})}):(0,r.jsx)("div",{}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("div",{className:"flex items-center rounded-md bg-muted p-1 text-sm",children:["day","week","month","quarter"].map(e=>(0,r.jsx)(H.$,{size:"sm",variant:es===e?"outline":"ghost",className:"h-7 px-2 capitalize",onClick:()=>ec(e),children:e},e))}),(0,r.jsxs)(H.$,{variant:"outline",size:"sm",onClick:()=>ee(e=>{switch(es){case"day":case"week":return(0,D.a)(e,1);case"month":case"quarter":return(0,k.d)(e,1);default:return e}}),children:[(0,r.jsx)(O.A,{className:"h-4 w-4 mr-1"}),"Prev"]}),(0,r.jsxs)("span",{className:"font-medium text-sm text-muted-foreground tabular-nums w-48 text-center",children:[(0,f.GP)(K,"MMM yyyy")," - ",(0,f.GP)(eS,"MMM yyyy")]}),(0,r.jsxs)(H.$,{variant:"outline",size:"sm",onClick:()=>ee(e=>{switch(es){case"day":case"week":return(0,p.P)(e,1);case"month":case"quarter":return(0,n.e)(e,1);default:return e}}),children:["Next",(0,r.jsx)(S.A,{className:"h-4 w-4 ml-1"})]})]})]}),(0,r.jsxs)("div",{className:"flex flex-1 overflow-hidden",children:[(0,r.jsxs)("div",{style:{width:"".concat(450,"px")},className:"flex-shrink-0 border-r border-border flex flex-col",children:[(0,r.jsx)("div",{className:"h-[60px] flex items-center p-2 font-semibold text-xs border-b border-border flex-shrink-0 sticky top-0 bg-background/95 backdrop-blur-sm z-20 text-muted-foreground uppercase tracking-wider",children:(0,r.jsxs)("div",{className:"grid grid-cols-[1fr_80px_80px] w-full items-center gap-2",children:[(0,r.jsx)("span",{children:"Task Name"}),(0,r.jsx)("span",{className:"text-center",children:"Assignee"}),(0,r.jsx)("span",{className:"text-center",children:"Due Date"})]})}),(0,r.jsxs)("div",{ref:eN,className:"overflow-y-scroll flex-1",children:[0===eI.length&&!$&&(0,r.jsxs)("div",{className:"flex flex-col items-center justify-center h-full p-4 text-center text-sm",children:[(0,r.jsx)("p",{className:"text-muted-foreground",children:"VALIDATION_PROJECT"===t?"No Validation Projects found.":"ALL_EXCEPT_VALIDATION"===t?"No standard tasks found.":"No tasks with valid dates found."}),(0,r.jsx)("p",{className:"text-xs mt-1 text-muted-foreground",children:0===U.length?"Create a new task to get started.":"Try adjusting the date range or zoom."})]}),eI.map(e=>(0,r.jsxs)("div",{className:(0,C.cn)("grid grid-cols-[1fr_80px_80px] items-center gap-2 p-2 border-b border-border/60 text-sm group",e.id===eu?"bg-primary/5":""),style:{height:"".concat(40,"px"),paddingLeft:"".concat(1+1.5*e.level,"rem")},onMouseEnter:()=>ep(e.id),onMouseLeave:()=>ep(null),children:[(0,r.jsxs)("div",{className:"flex items-center gap-1 truncate",children:[e.isParent&&(0,r.jsx)(H.$,{variant:"ghost",size:"icon",className:"h-5 w-5 -ml-6",onClick:()=>eB(e.id),children:(0,r.jsx)(R.A,{className:(0,C.cn)("h-4 w-4 transition-transform",!eb.has(e.id)&&"rotate-[-90deg]")})}),(0,r.jsx)("span",{className:"font-medium truncate flex-1",title:e.title,children:e.title}),(0,r.jsxs)("div",{className:"flex items-center flex-shrink-0",children:[e.isParent&&(0,r.jsx)(H.$,{variant:"ghost",size:"icon",className:"h-6 w-6",onClick:t=>{t.stopPropagation(),J.push("/tasks/new?defaultType=VALIDATION_STEP&dependsOnValidationProject=".concat(e.id))},title:"Add a step to this project",children:(0,r.jsx)(L.A,{className:"h-4 w-4"})}),(0,r.jsxs)(X.rI,{children:[(0,r.jsx)(X.ty,{asChild:!0,children:(0,r.jsx)(H.$,{variant:"ghost",size:"icon",className:"h-6 w-6",children:(0,r.jsx)(V.A,{className:"h-4 w-4"})})}),(0,r.jsxs)(X.SQ,{align:"end",children:[(0,r.jsx)(X._2,{onSelect:t=>{t.preventDefault(),e_(e),eE(!0)},children:"Edit"}),e.isParent&&(0,r.jsx)(X._2,{onClick:t=>{t.stopPropagation(),J.push("/tasks/new?defaultType=VALIDATION_STEP&dependsOnValidationProject=".concat(e.id))},children:"Add Step"}),(0,r.jsx)(X._2,{className:"text-destructive",onClick:()=>{eA(e),ek(!0)},children:"Delete"})]})]}),(null==eC?void 0:eC.id)===e.id&&(0,r.jsxs)(Y.AM,{open:eP,onOpenChange:t=>e$(t,e),children:[(0,r.jsx)(Y.Wv,{asChild:!0,children:(0,r.jsx)("span",{})}),(0,r.jsx)(Y.hl,{className:"w-96 p-4",side:"bottom",align:"start",children:(0,r.jsx)(em,{task:eC,onSave:eX,onClose:()=>eE(!1)})})]})]})]}),(0,r.jsx)("div",{className:"flex items-center justify-center",children:e.assignees&&e.assignees.length>0?(0,r.jsxs)("div",{className:"flex -space-x-2",children:[e.assignees.slice(0,2).map(e=>(0,r.jsxs)(q.m_,{children:[(0,r.jsx)(q.k$,{asChild:!0,children:(0,r.jsx)(er.eu,{className:"h-6 w-6 border-2 border-background",children:(0,r.jsx)(er.q5,{children:el(e.name)})})}),(0,r.jsx)(q.ZI,{children:e.name})]},e.id)),e.assignees.length>2&&(0,r.jsxs)(q.m_,{children:[(0,r.jsx)(q.k$,{asChild:!0,children:(0,r.jsx)(er.eu,{className:"h-6 w-6 border-2 border-background",children:(0,r.jsxs)(er.q5,{children:["+",e.assignees.length-2]})})}),(0,r.jsxs)(q.ZI,{children:["And ",e.assignees.length-2," more"]})]})]}):(0,r.jsx)("div",{className:"h-6 w-6"})}),(0,r.jsx)("span",{className:(0,C.cn)("text-center text-xs",(0,j.Y)(e.dueDate,eW)&&"Done"!==e.status?"text-destructive":"text-muted-foreground"),children:(0,f.GP)(e.dueDate,"MMM dd")})]},"".concat(e.id,"-leftpanel")))]})]}),(0,r.jsx)("div",{className:"flex-1 overflow-auto",ref:ew,children:(0,r.jsxs)("div",{className:"relative timeline-inner-content",children:[(0,r.jsxs)("div",{className:"sticky top-0 z-20 bg-background/95 backdrop-blur-sm",children:[(0,r.jsx)("div",{className:"flex h-[30px] border-b border-border",children:ez.map(e=>(0,r.jsx)("div",{style:{width:"".concat(e.width,"px")},className:"flex-shrink-0 flex items-center justify-center border-r border-border font-semibold text-xs text-muted-foreground",children:e.label},e.key))}),(0,r.jsx)("div",{className:"flex h-[30px] border-b border-border",children:eF.map(e=>(0,r.jsx)("div",{style:{width:"".concat(e.width,"px")},className:"flex-shrink-0 flex items-center justify-center border-r border-border text-xs text-muted-foreground",children:e.label},e.key))})]}),(0,r.jsxs)("div",{className:"relative",style:{height:"".concat(eK,"px"),width:"".concat(eR,"px")},children:[(0,r.jsx)("div",{className:"absolute inset-0 flex",children:eF.map(e=>(0,r.jsx)("div",{style:{width:"".concat(e.width,"px")},className:"flex-shrink-0 border-r border-border/40 h-full"},e.key))}),(0,r.jsx)("div",{className:"absolute inset-0",children:eI.map((e,t)=>(0,r.jsx)("div",{className:(0,C.cn)("absolute left-0 right-0 border-b border-border/40",e.id===eu?"bg-primary/5":""),style:{top:"".concat(40*t,"px"),height:"".concat(40,"px"),width:"".concat(eR,"px")}},"row-".concat(e.id)))}),eZ&&(0,r.jsx)("div",{className:"absolute top-0 bottom-0 w-0.5 bg-destructive z-[5]",style:{left:"".concat(eQ,"px")},title:"Today: ".concat((0,f.GP)(eW,"PPP")),children:(0,r.jsx)("div",{className:"absolute -top-5 left-1/2 -translate-x-1/2 bg-destructive text-white text-[10px] px-1 rounded-sm font-semibold",children:"TODAY"})}),(0,r.jsxs)("svg",{width:eR,height:eK,className:"absolute inset-0 pointer-events-none z-10",children:[(0,r.jsxs)("defs",{children:[(0,r.jsx)("marker",{id:"arrowhead",markerWidth:4.8,markerHeight:3.2,refX:4.4,refY:1.6,orient:"auto-start-reverse",children:(0,r.jsx)("polygon",{points:"0 0, ".concat(4," ").concat(1.6,", 0 ").concat(3.2),className:"fill-muted-foreground/70"})}),(0,r.jsx)("marker",{id:"arrowhead-conflict",markerWidth:4.8,markerHeight:3.2,refX:4.4,refY:1.6,orient:"auto-start-reverse",children:(0,r.jsx)("polygon",{points:"0 0, ".concat(4," ").concat(1.6,", 0 ").concat(3.2),className:"fill-amber-500"})})]}),eH.map(e=>(0,r.jsx)("path",{d:e.d,strokeWidth:"1.2",fill:"none",markerEnd:e.isConflict?"url(#arrowhead-conflict)":"url(#arrowhead)",className:(0,C.cn)(e.isConflict?"stroke-amber-500":"stroke-muted-foreground/70","transition-stroke")},e.id))]}),eg&&(0,r.jsx)("svg",{className:"absolute top-0 left-0 w-full h-full pointer-events-none z-40",children:(0,r.jsx)("line",{x1:eg.sourceTaskBarEndX,y1:eg.sourceTaskBarCenterY,x2:eg.currentMouseX,y2:eg.currentMouseY,stroke:"hsl(var(--primary))",strokeWidth:"2",strokeDasharray:"4 2"})}),(0,r.jsx)("div",{className:"absolute inset-0",children:eI.map((e,t)=>{let a=eJ.get(e.id);if(!a)return null;let s=(null==eh?void 0:eh.taskId)===e.id,n="VALIDATION_PROJECT"===e.task_type?ei.VALIDATION_PROJECT:"VALIDATION_STEP"===e.task_type?ei.VALIDATION_STEP:ei.DEFAULT;return(0,r.jsxs)(q.m_,{delayDuration:s?999999:100,children:[(0,r.jsx)(q.k$,{asChild:!0,children:(0,r.jsx)("div",{onMouseDown:t=>eq(t,e),onMouseEnter:()=>ep(e.id),onMouseLeave:()=>ep(null),className:(0,C.cn)("absolute transition-opacity duration-150 ease-in-out group z-10 flex items-center justify-center cursor-grab rounded-md"),style:{left:"".concat(a.barStartX,"px"),width:"".concat(a.barWidth<0?0:a.barWidth,"px"),top:"".concat(40*t+6,"px"),height:28},children:e.isMilestone?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:(0,C.cn)("absolute inset-0 flex items-center justify-center pointer-events-none",n.base,n.hover),style:{clipPath:"polygon(50% 0%, 100% 50%, 50% 100%, 0% 50%)",width:14,height:14,left:"50%",top:"50%",transform:"translate(-50%,-50%)"}}),(0,r.jsx)("span",{className:"absolute text-xs text-foreground/80 whitespace-nowrap",style:{left:"calc(100% + 4px)",top:"50%",transform:"translateY(-50%)"},children:e.title})]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:(0,C.cn)("h-full w-full rounded-md",e.color.base,e.color.hover),children:(0,r.jsx)("div",{className:(0,C.cn)("h-full rounded-md",e.color.progress),style:{width:"".concat(e.progress||0,"%")}})}),(0,r.jsx)("div",{onMouseDown:t=>eG(t,e,"start"),className:"absolute top-1/2 -translate-y-1/2 -left-1 w-3 h-3 rounded-full bg-background border-2 border-primary cursor-ew-resize z-20 opacity-0 group-hover:opacity-100 transition-opacity",title:"Resize start date"}),(0,r.jsx)("div",{onMouseDown:t=>eG(t,e,"end"),className:"absolute top-1/2 -translate-y-1/2 -right-1 w-3 h-3 rounded-full bg-background border-2 border-primary cursor-ew-resize z-20 opacity-0 group-hover:opacity-100 transition-opacity",title:"Resize end date"}),(0,r.jsx)("div",{className:"absolute right-[-6px] top-1/2 -translate-y-1/2 w-3 h-3 rounded-full bg-primary border-2 border-background cursor-crosshair z-30 opacity-0 group-hover:opacity-100 transition-opacity",onMouseDown:t=>eY(t,e),title:"Draw dependency"})]})})}),(0,r.jsx)(q.ZI,{className:"p-2 shadow-lg bg-popover text-popover-foreground rounded-md border max-w-xs w-auto z-50",children:(0,r.jsxs)("div",{className:"space-y-1",children:[(0,r.jsx)("p",{className:"font-semibold text-sm",children:e.title}),(0,r.jsxs)("p",{className:"text-xs text-muted-foreground",children:["Type: ",(0,r.jsx)("span",{className:"font-medium text-foreground",children:e.task_type.replace(/_/g," ")})]}),(0,r.jsxs)("p",{className:"text-xs text-muted-foreground",children:["Dates: ",(0,f.GP)(e.startDate,"MMM d, yy")," - ",(0,f.GP)(e.dueDate,"MMM d, yy")]}),e.assignees&&e.assignees.length>0&&(0,r.jsxs)("p",{className:"text-xs text-muted-foreground",children:["Assigned to: ",(0,r.jsx)("span",{className:"font-medium text-foreground",children:e.assignees.map(e=>e.name).join(", ")})]})]})})]},"".concat(e.id,"-timeline"))})})]})]})})]})]}),eT&&(0,r.jsx)(G.Lt,{open:eD,onOpenChange:ek,children:(0,r.jsxs)(G.EO,{children:[(0,r.jsxs)(G.wd,{children:[(0,r.jsx)(G.r7,{children:"Confirm Deletion"}),(0,r.jsxs)(G.$v,{children:['Are you sure you want to delete the task "',eT.title,'"? This action cannot be undone.']})]}),(0,r.jsxs)(G.ck,{children:[(0,r.jsx)(G.Zr,{onClick:()=>eA(null),children:"Cancel"}),(0,r.jsx)(G.Rx,{onClick:eU,className:(0,C.cn)(ef({variant:"destructive"})),children:"Delete Task"})]})]})})]})},em=e=>{let{task:t,onSave:a,onClose:s}=e,n=(0,Z.mN)({resolver:(0,Q.u)(ec),defaultValues:{title:t.title,startDate:t.startDate?new Date(t.startDate):void 0,dueDate:t.dueDate?new Date(t.dueDate):void 0,isMilestone:("VALIDATION_PROJECT"===t.task_type||"VALIDATION_STEP"===t.task_type)&&!!t.isMilestone}}),[o,i]=(0,A.useState)(!1),l=n.watch("isMilestone"),d=n.watch("startDate");(0,A.useEffect)(()=>{if(("VALIDATION_PROJECT"===t.task_type||"VALIDATION_STEP"===t.task_type)&&l&&d){var e;n.getValues("dueDate")&&(null==(e=n.getValues("dueDate"))?void 0:e.getTime())===d.getTime()||n.setValue("dueDate",d,{shouldValidate:!0})}},[l,d,t.task_type,n]);let c=async e=>{i(!0);let r={title:e.title,startDate:e.startDate,dueDate:e.dueDate};("VALIDATION_PROJECT"===t.task_type||"VALIDATION_STEP"===t.task_type)&&(r.isMilestone=e.isMilestone,e.isMilestone&&e.startDate&&(r.dueDate=e.startDate));try{await a(t.id,r),s()}finally{i(!1)}};return(0,r.jsxs)("form",{onSubmit:n.handleSubmit(c),className:"space-y-4",children:[(0,r.jsxs)("h4",{className:"font-medium text-sm leading-none",children:["Edit: ",t.title]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(W.J,{htmlFor:"quickEditTitle",children:"Task Name"}),(0,r.jsx)($.p,{id:"quickEditTitle",...n.register("title"),className:"mt-1"}),n.formState.errors.title&&(0,r.jsx)("p",{className:"text-xs text-destructive mt-1",children:n.formState.errors.title.message})]}),("VALIDATION_PROJECT"===t.task_type||"VALIDATION_STEP"===t.task_type)&&(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)(Z.xI,{name:"isMilestone",control:n.control,render:e=>{let{field:t}=e;return(0,r.jsx)(B.S,{id:"quickEditIsMilestone",checked:t.value,onCheckedChange:t.onChange})}})," ",(0,r.jsx)(W.J,{htmlFor:"quickEditIsMilestone",className:"text-sm font-normal",children:"Is Milestone"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(W.J,{children:"Start Date"}),(0,r.jsx)(Z.xI,{control:n.control,name:"startDate",render:e=>{let{field:t}=e;return(0,r.jsxs)(Y.AM,{children:[(0,r.jsx)(Y.Wv,{asChild:!0,children:(0,r.jsxs)(H.$,{variant:"outline",className:(0,C.cn)("w-full justify-start text-left font-normal mt-1",!t.value&&"text-muted-foreground"),children:[(0,r.jsx)(z.A,{className:"mr-2 h-4 w-4"}),t.value?(0,f.GP)(t.value,"PPP"):(0,r.jsx)("span",{children:"Pick a date"})]})}),(0,r.jsx)(Y.hl,{className:"w-auto p-0",children:(0,r.jsx)(U.V,{mode:"single",selected:t.value,onSelect:t.onChange,initialFocus:!0})})]})}}),n.formState.errors.startDate&&(0,r.jsx)("p",{className:"text-xs text-destructive mt-1",children:n.formState.errors.startDate.message})]}),!l&&(0,r.jsxs)("div",{children:[(0,r.jsx)(W.J,{children:"Due Date"}),(0,r.jsx)(Z.xI,{control:n.control,name:"dueDate",render:e=>{let{field:t}=e;return(0,r.jsxs)(Y.AM,{children:[(0,r.jsx)(Y.Wv,{asChild:!0,children:(0,r.jsxs)(H.$,{variant:"outline",className:(0,C.cn)("w-full justify-start text-left font-normal mt-1",!t.value&&"text-muted-foreground"),children:[(0,r.jsx)(z.A,{className:"mr-2 h-4 w-4"}),t.value?(0,f.GP)(t.value,"PPP"):(0,r.jsx)("span",{children:"Pick a date"})]})}),(0,r.jsx)(Y.hl,{className:"w-auto p-0",children:(0,r.jsx)(U.V,{mode:"single",selected:t.value,onSelect:t.onChange,disabled:e=>!!n.watch("startDate")&&e<n.watch("startDate"),initialFocus:!0})})]})}}),n.formState.errors.dueDate&&(0,r.jsx)("p",{className:"text-xs text-destructive mt-1",children:n.formState.errors.dueDate.message})]}),(0,r.jsxs)("div",{className:"flex justify-end space-x-2 pt-2",children:[(0,r.jsxs)(H.$,{type:"button",variant:"ghost",onClick:s,disabled:o,children:[(0,r.jsx)(F.A,{className:"mr-2 h-4 w-4"}),"Cancel"]}),(0,r.jsxs)(H.$,{type:"submit",disabled:o,children:[o?(0,r.jsx)(M.A,{className:"mr-2 h-4 w-4 animate-spin"}):(0,r.jsx)(J.A,{className:"mr-2 h-4 w-4"}),"Save"]})]})]})},ef=(0,es.F)("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}})},14636:(e,t,a)=>{a.d(t,{AM:()=>i,Wv:()=>l,hl:()=>d});var r=a(95155),s=a(12115),n=a(20547),o=a(59434);let i=n.bL,l=n.l9,d=s.forwardRef((e,t)=>{let{className:a,align:s="center",sideOffset:i=4,...l}=e;return(0,r.jsx)(n.ZL,{children:(0,r.jsx)(n.UC,{ref:t,align:s,sideOffset:i,className:(0,o.cn)("z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",a),...l})})});d.displayName=n.UC.displayName},30285:(e,t,a)=>{a.d(t,{$:()=>d,r:()=>l});var r=a(95155),s=a(12115),n=a(99708),o=a(74466),i=a(59434);let l=(0,o.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),d=s.forwardRef((e,t)=>{let{className:a,variant:s,size:o,asChild:d=!1,...c}=e,u=d?n.DX:"button";return(0,r.jsx)(u,{className:(0,i.cn)(l({variant:s,size:o,className:a})),ref:t,...c})});d.displayName="Button"},30645:(e,t,a)=>{a.d(t,{b:()=>o});let r={maxAttempts:4,delayMs:1e3,shouldRetry:e=>!!e&&"object"==typeof e&&!(!0===e.isAbort||"string"==typeof e.message&&e.message.toLowerCase().includes("aborted"))&&!0!==e.isCircuitOpenError&&!0!==e.circuitJustOpened&&(0===e.status||502===e.status||503===e.status||504===e.status),context:"operation"};var s=function(e){return e.Closed="CLOSED",e.Open="OPEN",e.HalfOpen="HALF_OPEN",e}(s||{});let n=new Map;async function o(e,t){let a,s={...r,...t},o=s.context,i=(e,t)=>{let a="[withRetry:".concat(o,"] ").concat(e,". Circuit: ").concat(l.state,".");console.warn(a);let r=Error(a);throw r.isAbort=!0,r.context=o,t&&(r.originalError=t),r};n.has(o)||n.set(o,{state:"CLOSED",failures:0});let l=n.get(o);if("OPEN"===l.state)if(Date.now()<(l.openUntil||0)){let e=Error("Circuit for '".concat(o,"' is open due to repeated failures. Please try again in a few moments."));throw e.isCircuitOpenError=!0,e.context=o,e.openUntil=l.openUntil,e}else l.state="HALF_OPEN",l.failures=0,l.openUntil=void 0,console.log("[withRetry:".concat(o,"] Circuit is now HalfOpen. Allowing one attempt."));let d="HALF_OPEN"===l.state?1:s.maxAttempts;for(let t=1;t<=d;t++){var c,u,m;(null==(c=s.signal)?void 0:c.aborted)&&i("Aborted before attempt ".concat(t));try{let t=await e();return("HALF_OPEN"===l.state||l.failures>0||"OPEN"===l.state)&&(console.log("[withRetry:".concat(o,"] Circuit is now Closed due to successful attempt (was ").concat(l.state,").")),l.state="CLOSED",l.failures=0,l.openUntil=void 0),t}catch(e){if(a=e,(null==(u=s.signal)?void 0:u.aborted)&&i("Aborted during/after attempt ".concat(t," (caught error: ").concat((null==e?void 0:e.message)||e,")"),e),e&&"object"==typeof e&&(!0===e.isAbort||"string"==typeof e.message&&e.message.toLowerCase().includes("aborted")))throw console.warn("[withRetry:".concat(o,"] Caught abort-like error on attempt ").concat(t,": ").concat(e.message,". Circuit: ").concat(l.state,".")),e.isAbort||(e.isAbort=!0),e.context||(e.context=o),e;if(s.shouldRetry(e))if(s.onRetry&&s.onRetry(t,d,e),t<d){let e="HALF_OPEN"===l.state?s.delayMs:s.delayMs*Math.pow(2,t-1);await new Promise(t=>setTimeout(t,e)),(null==(m=s.signal)?void 0:m.aborted)&&i("Aborted during retry delay after attempt ".concat(t))}else throw console.warn("[withRetry:".concat(o,"] All ").concat(d," attempts failed (Circuit: ").concat(l.state,"). Last error: ").concat(e.message||JSON.stringify(e))),"HALF_OPEN"===l.state?(console.warn("[withRetry:".concat(o,"] Circuit failed in HalfOpen state. Re-opening.")),l.state="OPEN",l.openUntil=Date.now()+3e4,a.circuitJustOpened=!0,a.context=o):"CLOSED"===l.state&&(l.failures++,console.log("[withRetry:".concat(o,"] Circuit failure count: ").concat(l.failures," (max: ").concat(1,")")),l.failures>=1&&(console.warn("[withRetry:".concat(o,"] Circuit reached max failures. Opening circuit.")),l.state="OPEN",l.openUntil=Date.now()+3e4,a.circuitJustOpened=!0,a.context=o)),a;else throw e}}if(a)throw a;throw Error("[withRetry:".concat(o,"] Unexpected exit: Max attempts ").concat(d," reached without success or explicit error handling."))}},44838:(e,t,a)=>{a.d(t,{Hr:()=>m,Ht:()=>h,SQ:()=>f,_2:()=>p,lp:()=>x,mB:()=>g,rI:()=>c,ty:()=>u});var r=a(95155),s=a(12115),n=a(48698),o=a(73158),i=a(10518),l=a(70154),d=a(59434);let c=n.bL,u=n.l9;n.YJ,n.ZL,n.Pb;let m=n.z6;s.forwardRef((e,t)=>{let{className:a,inset:s,children:i,...l}=e;return(0,r.jsxs)(n.ZP,{ref:t,className:(0,d.cn)("flex cursor-default gap-2 select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",s&&"pl-8",a),...l,children:[i,(0,r.jsx)(o.A,{className:"ml-auto"})]})}).displayName=n.ZP.displayName,s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)(n.G5,{ref:t,className:(0,d.cn)("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",a),...s})}).displayName=n.G5.displayName;let f=s.forwardRef((e,t)=>{let{className:a,sideOffset:s=4,...o}=e;return(0,r.jsx)(n.ZL,{children:(0,r.jsx)(n.UC,{ref:t,sideOffset:s,className:(0,d.cn)("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",a),...o})})});f.displayName=n.UC.displayName;let p=s.forwardRef((e,t)=>{let{className:a,inset:s,...o}=e;return(0,r.jsx)(n.q7,{ref:t,className:(0,d.cn)("relative flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",s&&"pl-8",a),...o})});p.displayName=n.q7.displayName,s.forwardRef((e,t)=>{let{className:a,children:s,checked:o,...l}=e;return(0,r.jsxs)(n.H_,{ref:t,className:(0,d.cn)("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",a),checked:o,...l,children:[(0,r.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,r.jsx)(n.VF,{children:(0,r.jsx)(i.A,{className:"h-4 w-4"})})}),s]})}).displayName=n.H_.displayName;let h=s.forwardRef((e,t)=>{let{className:a,children:s,...o}=e;return(0,r.jsxs)(n.hN,{ref:t,className:(0,d.cn)("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",a),...o,children:[(0,r.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,r.jsx)(n.VF,{children:(0,r.jsx)(l.A,{className:"h-2 w-2 fill-current"})})}),s]})});h.displayName=n.hN.displayName;let x=s.forwardRef((e,t)=>{let{className:a,inset:s,...o}=e;return(0,r.jsx)(n.JU,{ref:t,className:(0,d.cn)("px-2 py-1.5 text-sm font-semibold",s&&"pl-8",a),...o})});x.displayName=n.JU.displayName;let g=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)(n.wv,{ref:t,className:(0,d.cn)("-mx-1 my-1 h-px bg-muted",a),...s})});g.displayName=n.wv.displayName},46102:(e,t,a)=>{a.d(t,{Bc:()=>i,ZI:()=>c,k$:()=>d,m_:()=>l});var r=a(95155),s=a(12115),n=a(89613),o=a(59434);let i=n.Kq,l=n.bL,d=n.l9,c=s.forwardRef((e,t)=>{let{className:a,sideOffset:s=4,...i}=e;return(0,r.jsx)(n.UC,{ref:t,sideOffset:s,className:(0,o.cn)("z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",a),...i})});c.displayName=n.UC.displayName},47262:(e,t,a)=>{a.d(t,{S:()=>l});var r=a(95155),s=a(12115),n=a(76981),o=a(10518),i=a(59434);let l=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)(n.bL,{ref:t,className:(0,i.cn)("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",a),...s,children:(0,r.jsx)(n.C1,{className:(0,i.cn)("flex items-center justify-center text-current"),children:(0,r.jsx)(o.A,{className:"h-4 w-4"})})})});l.displayName=n.bL.displayName},62523:(e,t,a)=>{a.d(t,{p:()=>o});var r=a(95155),s=a(12115),n=a(59434);let o=s.forwardRef((e,t)=>{let{className:a,type:s,...o}=e;return(0,r.jsx)("input",{type:s,className:(0,n.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",a),ref:t,...o})});o.displayName="Input"},66695:(e,t,a)=>{a.d(t,{BT:()=>d,Wu:()=>c,ZB:()=>l,Zp:()=>o,aR:()=>i,wL:()=>u});var r=a(95155),s=a(12115),n=a(59434);let o=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("div",{ref:t,className:(0,n.cn)("rounded-xl border bg-card text-card-foreground shadow",a),...s})});o.displayName="Card";let i=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("div",{ref:t,className:(0,n.cn)("flex flex-col space-y-1.5 p-6",a),...s})});i.displayName="CardHeader";let l=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("h3",{ref:t,className:(0,n.cn)("font-semibold leading-none tracking-tight",a),...s})});l.displayName="CardTitle";let d=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("p",{ref:t,className:(0,n.cn)("text-sm text-muted-foreground",a),...s})});d.displayName="CardDescription";let c=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("div",{ref:t,className:(0,n.cn)("p-6 pt-0",a),...s})});c.displayName="CardContent";let u=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("div",{ref:t,className:(0,n.cn)("flex items-center p-6 pt-0",a),...s})});u.displayName="CardFooter"},73835:(e,t,a)=>{a.d(t,{w:()=>l});var r=a(70831),s=a(96019),n=a(78039),o=a(86622),i=a(63482);function l(e,t){let a=[];return e.forEach(e=>{if(a.push(e),"None"===e.recurrence||!e.dueDate)return;let l=new Date(e.dueDate),d=e.startDate?new Date(e.dueDate).getTime()-new Date(e.startDate).getTime():0,c=1;for(;;){let u=new Date(l);switch(e.recurrence){case"Daily":l=(0,r.f)(u,1);break;case"Weekly":l=(0,s.J)(u,1);break;case"Monthly":l=(0,n.P)(u,1);break;case"Yearly":l=(0,o.e)(u,1);break;default:return}if((0,i.Y)(l,t)){let t=e.startDate?new Date(l.getTime()-d):void 0,r={...e,id:"".concat(e.id,"_proj_").concat(c),dueDate:l,startDate:t,status:"To Do",progress:0,attachments:[],description:"Recurring instance of: ".concat(e.title,". Original due date: ").concat(new Date(e.dueDate).toLocaleDateString())};a.push(r),c++}else break}}),a}},77694:(e,t,a)=>{a.d(t,{UT:()=>c,lC:()=>u,vq:()=>m,x1:()=>d});var r=a(7140),s=a(30645),n=a(73835);a(97841);let o="tasks",i=(e,t)=>{if(e instanceof r.fp){var a;if(404===e.status)throw Error("Cannot create item: The '".concat(t,"' collection does not exist. Please create it in your PocketBase admin panel."));if(400===e.status&&(null==(a=e.data)?void 0:a.data)){if(e.data.data.id&&e.data.data.id.message)throw Error("There seems to be a configuration issue with your '".concat(t,"' collection. The server is asking for an 'id', which should be automatically generated. Please check in your PocketBase admin panel that the 'id' field is the default system field and not a required text field you created."));let a=Object.entries(e.data.data).map(e=>{let[t,a]=e;return"".concat(t,": ").concat(a.message)}).join("; ");throw Error("Validation failed. Server says: ".concat(a))}}throw console.error("Failed to create item in ".concat(t,":"),e),e},l=e=>({id:e.id,title:e.title||"",task_type:e.task_type,description:e.description,status:e.status,priority:e.priority,startDate:e.startDate?new Date(e.startDate):void 0,dueDate:e.dueDate?new Date(e.dueDate):void 0,assignedTo:e.assignedTo||[],recurrence:e.recurrence||"None",attachments:e.attachments,userId:e.userId,created:new Date(e.created),updated:new Date(e.updated),collectionId:e.collectionId,collectionName:e.collectionName,expand:e.expand,progress:e.progress,isMilestone:"boolean"==typeof e.isMilestone&&e.isMilestone,dependencies:Array.isArray(e.dependencies)?e.dependencies:"string"==typeof e.dependencies&&e.dependencies.startsWith("[")?JSON.parse(e.dependencies):[],instrument_subtype:e.instrument_subtype||void 0,method:e.method||void 0}),d=async(e,t)=>{try{let{onRetry:a,signal:r,projectionHorizon:i,...d}=t||{},c={sort:"-created",fields:"id,title,task_type,status,priority,startDate,dueDate,assignedTo,userId,created,updated,progress,isMilestone,dependencies,instrument_subtype,method,recurrence,expand",expand:"assignedTo",...d},u=(await (0,s.b)(()=>e.collection(o).getFullList(c,{signal:r}),{signal:r,context:"fetching tasks list",onRetry:a})).map(l);if(i)return(0,n.w)(u,i);return u}catch(e){if((null==e?void 0:e.isAbort)===!0||(null==e?void 0:e.message)&&(e.message.toLowerCase().includes("aborted")||e.message.toLowerCase().includes("autocancelled")))throw e;throw console.error("Failed to fetch tasks:",e),e}},c=async(e,t,a)=>{try{t.has("isMilestone")&&t.set("isMilestone","true"===t.get("isMilestone")?"true":"false");let r=await e.collection(o).create(t,{signal:null==a?void 0:a.signal,expand:"assignedTo"});return l(r)}catch(e){throw i(e,o),e}},u=async(e,t,a,r)=>{try{let{signal:n}=r||{};a instanceof FormData&&a.has("isMilestone")?a.set("isMilestone","true"===a.get("isMilestone")||!0===a.get("isMilestone")?"true":"false"):!(a instanceof FormData)&&a.hasOwnProperty("isMilestone")&&(a.isMilestone=!!a.isMilestone);let i=await (0,s.b)(()=>e.collection(o).update(t,a,{signal:n,expand:"assignedTo"}),{context:"updating task ".concat(t),signal:n});return l(i)}catch(e){throw console.error("Failed to update task ".concat(t,":"),e),e}},m=async(e,t,a)=>{try{let{signal:r}=a||{};await (0,s.b)(()=>e.collection(o).delete(t,{signal:r}),{context:"deleting task ".concat(t),signal:r})}catch(e){throw console.error("Failed to delete task ".concat(t,":"),e),e}}},85057:(e,t,a)=>{a.d(t,{J:()=>d});var r=a(95155),s=a(12115),n=a(40968),o=a(74466),i=a(59434);let l=(0,o.F)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),d=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)(n.b,{ref:t,className:(0,i.cn)(l(),a),...s})});d.displayName=n.b.displayName},85511:(e,t,a)=>{a.d(t,{V:()=>d});var r=a(95155);a(12115);var s=a(965),n=a(73158),o=a(43645),i=a(59434),l=a(30285);function d(e){let{className:t,classNames:a,showOutsideDays:d=!0,...c}=e;return(0,r.jsx)(o.hv,{showOutsideDays:d,className:(0,i.cn)("p-3",t),classNames:{months:"flex flex-col sm:flex-row space-y-4 sm:space-x-4 sm:space-y-0",month:"space-y-4",caption:"flex justify-center pt-1 relative items-center",caption_label:"text-sm font-medium",nav:"space-x-1 flex items-center",nav_button:(0,i.cn)((0,l.r)({variant:"outline"}),"h-7 w-7 bg-transparent p-0 opacity-50 hover:opacity-100"),nav_button_previous:"absolute left-1",nav_button_next:"absolute right-1",table:"w-full border-collapse space-y-1",head_row:"flex",head_cell:"text-muted-foreground rounded-md w-9 font-normal text-[0.8rem]",row:"flex w-full mt-2",cell:"h-9 w-9 text-center text-sm p-0 relative [&:has([aria-selected].day-range-end)]:rounded-r-md [&:has([aria-selected].day-outside)]:bg-accent/50 [&:has([aria-selected])]:bg-accent first:[&:has([aria-selected])]:rounded-l-md last:[&:has([aria-selected])]:rounded-r-md focus-within:relative focus-within:z-20",day:(0,i.cn)((0,l.r)({variant:"ghost"}),"h-9 w-9 p-0 font-normal aria-selected:opacity-100"),day_range_end:"day-range-end",day_selected:"bg-primary text-primary-foreground hover:bg-primary hover:text-primary-foreground focus:bg-primary focus:text-primary-foreground",day_today:"bg-accent text-accent-foreground",day_outside:"day-outside text-muted-foreground aria-selected:bg-accent/50 aria-selected:text-muted-foreground",day_disabled:"text-muted-foreground opacity-50",day_range_middle:"aria-selected:bg-accent aria-selected:text-accent-foreground",day_hidden:"invisible",...a},components:{IconLeft:e=>{let{className:t,...a}=e;return(0,r.jsx)(s.A,{className:(0,i.cn)("h-4 w-4",t),...a})},IconRight:e=>{let{className:t,...a}=e;return(0,r.jsx)(n.A,{className:(0,i.cn)("h-4 w-4",t),...a})}},...c})}d.displayName="Calendar"},90010:(e,t,a)=>{a.d(t,{$v:()=>h,EO:()=>u,Lt:()=>l,Rx:()=>x,Zr:()=>g,ck:()=>f,r7:()=>p,wd:()=>m});var r=a(95155),s=a(12115),n=a(17649),o=a(59434),i=a(30285);let l=n.bL;n.l9;let d=n.ZL,c=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)(n.hJ,{className:(0,o.cn)("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",a),...s,ref:t})});c.displayName=n.hJ.displayName;let u=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsxs)(d,{children:[(0,r.jsx)(c,{}),(0,r.jsx)(n.UC,{ref:t,className:(0,o.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",a),...s})]})});u.displayName=n.UC.displayName;let m=e=>{let{className:t,...a}=e;return(0,r.jsx)("div",{className:(0,o.cn)("flex flex-col space-y-2 text-center sm:text-left",t),...a})};m.displayName="AlertDialogHeader";let f=e=>{let{className:t,...a}=e;return(0,r.jsx)("div",{className:(0,o.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",t),...a})};f.displayName="AlertDialogFooter";let p=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)(n.hE,{ref:t,className:(0,o.cn)("text-lg font-semibold",a),...s})});p.displayName=n.hE.displayName;let h=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)(n.VY,{ref:t,className:(0,o.cn)("text-sm text-muted-foreground",a),...s})});h.displayName=n.VY.displayName;let x=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)(n.rc,{ref:t,className:(0,o.cn)((0,i.r)(),a),...s})});x.displayName=n.rc.displayName;let g=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)(n.ZD,{ref:t,className:(0,o.cn)((0,i.r)({variant:"outline"}),"mt-2 sm:mt-0",a),...s})});g.displayName=n.ZD.displayName},91394:(e,t,a)=>{a.d(t,{BK:()=>l,eu:()=>i,q5:()=>d});var r=a(95155),s=a(12115),n=a(85977),o=a(59434);let i=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)(n.bL,{ref:t,className:(0,o.cn)("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",a),...s})});i.displayName=n.bL.displayName;let l=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)(n._V,{ref:t,className:(0,o.cn)("aspect-square h-full w-full",a),...s})});l.displayName=n._V.displayName;let d=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)(n.H4,{ref:t,className:(0,o.cn)("flex h-full w-full items-center justify-center rounded-full bg-muted",a),...s})});d.displayName=n.H4.displayName},97841:(e,t,a)=>{a.d(t,{Oc:()=>l,Qu:()=>u,Y$:()=>c,bV:()=>d});var r=a(7140),s=a(30645);let n="employees",o=(e,t)=>{if(e instanceof r.fp){var a;if(404===e.status)throw Error("Cannot create item: The '".concat(t,"' collection does not exist. Please create it in your PocketBase admin panel."));if(400===e.status&&(null==(a=e.data)?void 0:a.data)){if(e.data.data.id&&e.data.data.id.message)throw Error("There seems to be a configuration issue with your '".concat(t,"' collection. The server is asking for an 'id', which should be automatically generated. Please check in your PocketBase admin panel that the 'id' field is the default system field and not a required text field you created."));let a=Object.entries(e.data.data).map(e=>{let[t,a]=e;return"".concat(t,": ").concat(a.message)}).join("; ");throw Error("Validation failed. Server says: ".concat(a))}}throw console.error("Failed to create item in ".concat(t,":"),e),e},i=e=>({id:e.id,name:e.name,email:e.email,role:e.role,reportsTo_text:e.reportsTo_text,department_text:e.department_text,userId:e.userId,color:e.color,created:e.created?new Date(e.created):void 0,updated:e.updated?new Date(e.updated):void 0,collectionId:e.collectionId,collectionName:e.collectionName,expand:e.expand}),l=async(e,t)=>{try{let{onRetry:a,signal:r,...o}=t||{},l={sort:"name",fields:"id,name,email,role,department_text,reportsTo_text,userId,color,created,updated",...o};return(await (0,s.b)(()=>e.collection(n).getFullList(l,{signal:r}),{signal:r,context:"fetching employees list",onRetry:a})).map(i)}catch(e){if((null==e?void 0:e.isAbort)===!0||(null==e?void 0:e.message)&&(e.message.toLowerCase().includes("aborted")||e.message.toLowerCase().includes("autocancelled")))throw e;throw console.error("Failed to fetch employees:",e),e}},d=async(e,t,a)=>{try{let r=await e.collection(n).create(t,{signal:null==a?void 0:a.signal});return i(r)}catch(e){throw o(e,n),e}},c=async(e,t,a,r)=>{try{let{signal:o}=r||{},l=await (0,s.b)(()=>e.collection(n).update(t,a,{signal:o}),{context:"updating employee ".concat(t),signal:o});return i(l)}catch(e){throw console.error("Failed to update employee ".concat(t,":"),e),e}},u=async(e,t,a)=>{try{let{signal:r}=a||{};await (0,s.b)(()=>e.collection(n).delete(t,{signal:r}),{context:"deleting employee ".concat(t),signal:r})}catch(e){throw console.error("Failed to delete employee ".concat(t,":"),e),e}}}}]);