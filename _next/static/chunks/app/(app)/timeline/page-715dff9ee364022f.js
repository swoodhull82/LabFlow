(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[199],{46102:(e,t,r)=>{"use strict";r.d(t,{Bc:()=>l,ZI:()=>d,k$:()=>c,m_:()=>o});var s=r(95155),n=r(12115),a=r(89613),i=r(59434);let l=a.Kq,o=a.bL,c=a.l9,d=n.forwardRef((e,t)=>{let{className:r,sideOffset:n=4,...l}=e;return(0,s.jsx)(a.UC,{ref:t,sideOffset:n,className:(0,i.cn)("z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",r),...l})});d.displayName=a.UC.displayName},47783:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>B});var s=r(95155),n=r(12115),a=r(66695),i=r(19164),l=r(44861),o=r(92759),c=r(80644),d=r(76959),u=r(74641),m=r(78039),p=r(24386),x=r(73168),h=r(70831),f=r(56313),g=r(37140),b=r(52873),v=r(59434),y=r(59576),j=r(77694),N=r(87481),w=r(50172),D=r(31949),k=r(80848),S=r(799),M=r(965),T=r(73158),C=r(40295),I=r(59119),P=r(30285),E=r(46102),z=r(62523),L=r(14636),X=r(85057),_=r(59409),A=r(91950);let q=(e,t)=>{if(t)return"bg-purple-500 hover:bg-purple-600";if(!e)return"bg-primary hover:bg-primary/90";switch(e.toLowerCase()){case"done":return"bg-green-500 hover:bg-green-600";case"in progress":return"bg-blue-500 hover:bg-blue-600";case"overdue":return"bg-red-500 hover:bg-red-600";case"blocked":return"bg-orange-500 hover:bg-orange-600";case"to do":return"bg-gray-400 hover:bg-gray-500";default:return"bg-primary hover:bg-primary/90"}},O=(e,t)=>{let r="An unexpected error occurred while ".concat(t||"processing your request",".");if(e&&"object"==typeof e){var s,n;"status"in e&&0===e.status?r="Failed to connect to the server while ".concat(t||"processing",". Please check your internet connection."):(null==(s=e.data)?void 0:s.message)?r=e.data.message:e.message&&!e.message.startsWith("PocketBase_ClientResponseError")?r=e.message:(null==(n=e.originalError)?void 0:n.message)&&(r=e.originalError.message),"status"in e&&e.status&&0!==e.status&&(r="".concat(r," (Status: ").concat(e.status,")"))}else"string"==typeof e&&(r=e);return r},Y=()=>{let{pbClient:e}=(0,y.A)(),{toast:t}=(0,N.dj)(),[r,a]=(0,n.useState)([]),[Y,B]=(0,n.useState)(!0),[G,R]=(0,n.useState)(null),[F,$]=(0,n.useState)((0,i.w)(new Date)),[W,V]=(0,n.useState)(30),[Z,J]=(0,n.useState)(null),[U,H]=(0,n.useState)(null),[K,Q]=(0,n.useState)(null),ee=(0,n.useRef)(null),et=(0,n.useRef)(null),er=(0,n.useRef)(null),[es,en]=(0,n.useState)({taskId:null,currentTitle:A.ho[0]||"",currentInstrumentSubtype:void 0,currentStatus:"To Do",currentProgress:0}),[ea,ei]=(0,n.useState)(!1),el=(0,n.useCallback)(async(e,r)=>{if(!e)return void B(!0);B(!0),R(null);try{let t=(await (0,j.x1)(e,{signal:r})).filter(e=>e.startDate&&e.dueDate&&(0,l.f)(new Date(e.startDate))&&(0,l.f)(new Date(e.dueDate)));if(a(t),t.length>0){let e=(0,o.j)(t.map(e=>(0,c.o)(new Date(e.startDate))));$((0,i.w)(e))}else $((0,i.w)(new Date))}catch(s){let e=(null==s?void 0:s.isAbort)===!0||"string"==typeof(null==s?void 0:s.message)&&s.message.toLowerCase().includes("autocancelled"),r=(null==s?void 0:s.status)===0&&!e;if(e)console.warn("GanttChart: Timeline tasks fetch request was ".concat((null==s?void 0:s.isAbort)?"aborted":"autocancelled","."),s);else if(r){let e=O(s,"fetching timeline data");R(e),t({title:"Error Loading Timeline Data",description:e,variant:"destructive"}),console.warn("GanttChart: Timeline tasks fetch (network error):",e,s)}else{let e=O(s,"fetching timeline data");R(e),t({title:"Error Loading Timeline Data",description:e,variant:"destructive"}),console.warn("GanttChart: Error fetching tasks for timeline (after retries):",e,s)}}finally{B(!1)}},[t]);(0,n.useEffect)(()=>{let t=new AbortController;return e?el(e,t.signal):B(!0),()=>{t.abort()}},[e,el]);let{tasksToDisplay:eo,chartStartDate:ec,chartEndDate:ed,totalDaysInView:eu,monthHeaders:em}=(0,n.useMemo)(()=>{let e=r.map(e=>{let t=(0,c.o)(new Date(e.startDate)),r=(0,c.o)(new Date(e.dueDate));return{...e,startDate:t,dueDate:r,progress:"number"==typeof e.progress&&e.progress>=0&&e.progress<=100?e.progress:0,isMilestone:!0===e.isMilestone||!1!==e.isMilestone&&(0,l.f)(t)&&(0,l.f)(r)&&(0,d.r)(t,r),dependencies:Array.isArray(e.dependencies)?e.dependencies:[]}}),t=(0,u.p)((0,m.P)(F,2)),s=e.filter(e=>e.startDate<=t&&e.dueDate>=F).sort((e,t)=>e.startDate.getTime()-t.startDate.getTime()),n=(0,p.c)(t,F)+1,a=e=>(0,x.GP)(e,"MMM yyyy"),i=[];if(n>0){let e=new Date(F),r={};for(;e<=t;){let t=a(e);r[t]=(r[t]||0)+1,e=(0,h.f)(e,1)}Object.entries(r).forEach(e=>{let[t,r]=e;i.push({name:t,span:r})})}return{tasksToDisplay:s,chartStartDate:F,chartEndDate:t,totalDaysInView:n>0?n:0,monthHeaders:i}},[r,F]),ep=(0,n.useMemo)(()=>{let e=new Map;return eo.forEach((t,r)=>{let s=t.startDate,n=t.dueDate;if(U&&U.taskId===t.id){var a;let e=Math.round(((null!=(a=U.currentMouseX)?a:U.initialMouseX)-U.initialMouseX)/W);"drag"===U.type?(s=(0,h.f)(U.originalStartDate,e),n=(0,h.f)(U.originalDueDate,e)):"resize-start"===U.type?(s=(0,h.f)(U.originalStartDate,e),s=(0,o.j)([s,(0,h.f)(U.originalDueDate,-0)]),n=U.originalDueDate):"resize-end"===U.type&&(s=U.originalStartDate,n=(0,h.f)(U.originalDueDate,e),n=(0,f.T)([n,(0,h.f)(U.originalStartDate,0)]))}let i=(0,f.T)([s,ec]),l=(0,o.j)([n,ed]);if(i>l&&!t.isMilestone)return;let c=(0,p.c)(i,ec),d=t.isMilestone?1:(0,p.c)(l,i)+1;if(d<=0&&!t.isMilestone)return;let u=c*W,m=t.isMilestone?16:d*W;t.isMilestone&&(u+=W/2-8),e.set(t.id,{task:t,index:r,barStartX:u,barEndX:u+m,barWidth:m,barCenterY:48*r+(t.isMilestone,24),isMilestone:!!t.isMilestone,effectiveStartDate:s,effectiveDueDate:n})}),e},[eo,ec,ed,W,U]),ex=(0,n.useMemo)(()=>{let e=[];return eo.forEach(t=>{if(!t.dependencies||0===t.dependencies.length)return;let r=ep.get(t.id);r&&t.dependencies.forEach((s,n)=>{let a=ep.get(s);if(!a)return;let i=a.isMilestone?a.barStartX+8:a.barEndX,l=a.barCenterY,o=r.isMilestone?r.barStartX+8:r.barStartX,c=r.barCenterY;if(i>=o&&l===c)return;let d=i+15,u="M ".concat(i," ").concat(l," L ").concat(d," ").concat(l," L ").concat(d," ").concat(c," L ").concat(o," ").concat(c);e.push({id:"dep-".concat(s,"-to-").concat(t.id,"-").concat(n),d:u})})}),e},[eo,ep]),eh=(0,n.useCallback)(async(s,n)=>{if(!e)return;let a=r.find(e=>e.id===s);if(!a)return;let i={...n};n.startDate&&(i.startDate=new Date(n.startDate).toISOString()),n.dueDate&&(i.dueDate=new Date(n.dueDate).toISOString());try{await (0,j.lC)(e,s,i),t({title:"Task Updated",description:'Task "'.concat(a.title,'" was successfully updated.')}),el(e)}catch(r){t({title:"Update Failed",description:O(r,'updating task "'.concat(a.title,'"')),variant:"destructive"}),el(e)}},[e,r,t,el]),ef=(e,t)=>{if(0!==e.button||ea&&es.taskId===t.id)return;let r=ep.get(t.id);r&&(e.preventDefault(),e.stopPropagation(),H({type:"drag",taskId:t.id,initialMouseX:e.clientX,originalStartDate:r.effectiveStartDate,originalDueDate:r.effectiveDueDate}),er.current&&(er.current.style.cursor="grabbing"),document.body.style.userSelect="none")},eg=(e,t,r)=>{if(0!==e.button)return;let s=ep.get(t.id);s&&(e.preventDefault(),e.stopPropagation(),H({type:"start"===r?"resize-start":"resize-end",taskId:t.id,initialMouseX:e.clientX,originalStartDate:s.effectiveStartDate,originalDueDate:s.effectiveDueDate}),er.current&&(er.current.style.cursor="ew-resize"),document.body.style.userSelect="none")},eb=(e,t)=>{var r;if(0!==e.button)return;let s=ep.get(t.id);if(!s||s.isMilestone)return;e.preventDefault(),e.stopPropagation();let n=null==(r=er.current)?void 0:r.getBoundingClientRect(),a=ee.current;if(!n||!a)return;let i=e.clientX-n.left+a.scrollLeft,l=e.clientY-n.top+a.scrollTop-60;Q({sourceTaskId:t.id,sourceTaskBarEndX:s.barEndX,sourceTaskBarCenterY:s.barCenterY,currentMouseX:i,currentMouseY:l}),er.current&&(er.current.style.cursor="crosshair")},ev=(e,t)=>{if(1!==e.detail||Math.abs(e.movementX)>2||Math.abs(e.movementY)>2)return;let r=e.target;r.classList.contains("resize-handle")||r.classList.contains("dependency-connector")||r.closest(".dependency-connector")||(en({taskId:t.id,currentTitle:t.title,currentInstrumentSubtype:t.instrument_subtype,currentStatus:t.status,currentProgress:t.progress||0}),ei(!0))},ey=()=>{if(!es.taskId)return;let e={title:es.currentTitle,instrument_subtype:"MDL"===es.currentTitle||"SOP"===es.currentTitle?es.currentInstrumentSubtype:void 0,status:es.currentStatus,progress:es.currentProgress};eh(es.taskId,e),ei(!1),en({taskId:null,currentTitle:A.ho[0]||"",currentInstrumentSubtype:void 0,currentStatus:"To Do",currentProgress:0})};if((0,n.useEffect)(()=>{let e=e=>{if(U)H(t=>t?{...t,currentMouseX:e.clientX}:null);else if(K&&er.current){let t=er.current.getBoundingClientRect(),r=ee.current;if(!r)return;let s=e.clientX-t.left+r.scrollLeft,n=e.clientY-t.top+r.scrollTop-60;Q(e=>e?{...e,currentMouseX:s,currentMouseY:n}:null)}},s=e=>{if(U){let e=ep.get(U.taskId);e&&eh(U.taskId,{startDate:e.effectiveStartDate,dueDate:e.effectiveDueDate}),H(null),er.current&&(er.current.style.cursor="default"),document.body.style.userSelect=""}else if(K){var s;let n=null==(s=er.current)?void 0:s.getBoundingClientRect(),a=ee.current;if(n&&a){let s=e.clientX-n.left+a.scrollLeft,i=e.clientY-n.top+a.scrollTop-60,l=null;for(let[e,t]of ep.entries()){if(e===K.sourceTaskId)continue;let r=48*t.index,n=r+48;if(i>=r&&i<=n&&s>=t.barStartX-W/2&&s<=t.barStartX+W/2){l=e;break}}if(l){let e=r.find(e=>e.id===K.sourceTaskId),s=r.find(e=>e.id===l);if(e&&s){let r=s.dependencies||[],n=e.dependencies||[];r.includes(e.id)||n.includes(s.id)?t({title:"Invalid Dependency",description:"Cannot create duplicate or circular dependency.",variant:"destructive"}):eh(s.id,{dependencies:[...r,e.id]})}}}Q(null),er.current&&(er.current.style.cursor="default")}};return(U||K)&&(window.addEventListener("mousemove",e),window.addEventListener("mouseup",s)),()=>{window.removeEventListener("mousemove",e),window.removeEventListener("mouseup",s)}},[U,K,W,ep,eh,r,t]),(0,n.useEffect)(()=>{var e;let t=null,r=()=>{if("right"!==t){if(t="left",et.current&&ee.current){let e=ee.current.querySelector(".timeline-inner-content-scrollable-body");e&&(e.scrollTop=et.current.scrollTop)}requestAnimationFrame(()=>t=null)}},s=()=>{if("left"!==t){if(t="right",et.current&&ee.current){let e=ee.current.querySelector(".timeline-inner-content-scrollable-body");e&&(et.current.scrollTop=e.scrollTop)}requestAnimationFrame(()=>t=null)}},n=et.current,a=null==(e=ee.current)?void 0:e.querySelector(".timeline-inner-content-scrollable-body");return null==n||n.addEventListener("scroll",r),null==a||a.addEventListener("scroll",s),()=>{null==n||n.removeEventListener("scroll",r),null==a||a.removeEventListener("scroll",s)}},[eo]),Y)return(0,s.jsxs)("div",{className:"flex justify-center items-center py-10 min-h-[300px]",children:[(0,s.jsx)(w.A,{className:"h-8 w-8 animate-spin text-primary"})," ",(0,s.jsx)("p",{className:"ml-2",children:"Loading timeline data..."})]});if(G)return(0,s.jsxs)("div",{className:"text-center py-10 min-h-[300px]",children:[(0,s.jsx)(D.A,{className:"mx-auto h-12 w-12 text-destructive"}),(0,s.jsx)("p",{className:"mt-4 text-lg font-semibold",children:"Failed to Load Timeline Data"}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:G}),(0,s.jsx)(P.$,{onClick:()=>e&&el(e),className:"mt-6",children:"Try Again"})]});let ej=(0,c.o)(new Date),eN=(0,b.v)(ej,{start:ec,end:ed}),ew=eN&&eu>0?(0,p.c)(ej,ec)*W:0,eD=eu*W,ek=48*eo.length,eS=()=>(0,s.jsxs)("div",{className:"flex flex-col items-center justify-center h-full p-4 text-center text-sm",children:[(0,s.jsx)("p",{className:"text-muted-foreground",children:"No tasks found for current view."}),(0,s.jsx)("p",{className:"text-xs mt-1 text-muted-foreground",children:0===r.length?"Ensure tasks have valid start/due dates.":"Try adjusting date range or zoom."})]});return(0,s.jsx)(E.Bc,{children:(0,s.jsxs)("div",{ref:er,className:"gantt-chart-root flex flex-col h-[calc(100vh-200px)] overflow-hidden",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center p-2 border-b border-border bg-card flex-shrink-0",children:[(0,s.jsx)("h2",{className:"text-lg font-semibold text-card-foreground",children:"Project Timeline"}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(P.$,{variant:"outline",size:"icon",onClick:()=>V(e=>Math.max(15,e-5)),disabled:W<=15,title:"Zoom Out",children:(0,s.jsx)(k.A,{className:"h-4 w-4"})}),(0,s.jsx)(P.$,{variant:"outline",size:"icon",onClick:()=>V(e=>Math.min(60,e+5)),disabled:W>=60,title:"Zoom In",children:(0,s.jsx)(S.A,{className:"h-4 w-4"})}),(0,s.jsxs)(P.$,{variant:"outline",size:"sm",onClick:()=>$(e=>(0,g.a)(e,1)),children:[(0,s.jsx)(M.A,{className:"h-4 w-4 mr-1"}),"Prev"]}),(0,s.jsxs)("span",{className:"font-medium text-sm text-muted-foreground tabular-nums",children:[(0,x.GP)(F,"MMM yyyy")," - ",(0,x.GP)((0,m.P)(F,2),"MMM yyyy")]}),(0,s.jsxs)(P.$,{variant:"outline",size:"sm",onClick:()=>$(e=>(0,m.P)(e,1)),children:["Next",(0,s.jsx)(T.A,{className:"h-4 w-4 ml-1"})]})]})]}),(0,s.jsxs)("div",{className:"flex flex-1 overflow-hidden",children:[(0,s.jsxs)("div",{style:{width:"".concat(450,"px")},className:"flex-shrink-0 bg-card border-r border-border flex flex-col",children:[(0,s.jsx)("div",{className:"h-[60px] flex items-center p-2 font-semibold text-xs border-b border-border flex-shrink-0 sticky top-0 bg-card z-20",children:(0,s.jsxs)("div",{className:"grid grid-cols-[40px_1fr_70px_70px_60px] w-full items-center gap-2",children:[(0,s.jsx)("span",{className:"text-center text-muted-foreground uppercase",children:"WBS"}),(0,s.jsx)("span",{className:"text-muted-foreground uppercase",children:"Task Name"}),(0,s.jsx)("span",{className:"text-center text-muted-foreground uppercase",children:"Start"}),(0,s.jsx)("span",{className:"text-center text-muted-foreground uppercase",children:"End"}),(0,s.jsx)("span",{className:"text-center text-muted-foreground uppercase",children:"Prog."})]})}),(0,s.jsxs)("div",{ref:et,className:"overflow-y-auto flex-1",children:[0===eo.length&&!Y&&eS(),eo.map((e,t)=>(0,s.jsxs)("div",{className:(0,v.cn)("grid grid-cols-[40px_1fr_70px_70px_60px] items-center gap-2 p-2 border-b border-border text-xs transition-opacity duration-150",e.id===Z?"bg-primary/10 dark:bg-primary/20":"",U&&U.taskId!==e.id&&"draw-dependency"!==U.type||K&&K.sourceTaskId!==e.id||Z&&e.id!==Z?"opacity-60":"opacity-100"),style:{height:"".concat(48,"px")},onMouseEnter:()=>J(e.id),onMouseLeave:()=>J(null),children:[(0,s.jsx)("span",{className:"text-center text-muted-foreground",children:t+1}),(0,s.jsx)("span",{className:"font-medium truncate cursor-default",title:e.title,children:("MDL"===e.title||"SOP"===e.title)&&e.instrument_subtype?"".concat(e.title," (").concat(e.instrument_subtype,")"):e.title}),(0,s.jsx)("span",{className:"text-center text-[10px]",children:(0,x.GP)(e.startDate,"ddMMMyy")}),(0,s.jsx)("span",{className:"text-center text-[10px]",children:(0,x.GP)(e.dueDate,"ddMMMyy")}),(0,s.jsxs)("span",{className:"text-center text-[10px] font-semibold",children:[e.progress,"%"]})]},e.id))]})]}),(0,s.jsx)("div",{className:"flex-1 overflow-auto",ref:ee,children:(0,s.jsxs)("div",{className:"relative timeline-inner-content",children:[(0,s.jsxs)("div",{className:"sticky top-0 z-20 bg-card",children:[(0,s.jsxs)("div",{className:"grid h-[30px] border-b border-border",style:{gridTemplateColumns:em.map(e=>"".concat(e.span*W,"px")).join(" ")||"1fr"},children:[em.map((e,t)=>(0,s.jsx)("div",{className:"flex items-center justify-center border-r border-border font-semibold text-xs",children:e.name},t)),0===em.length&&(0,s.jsx)("div",{className:"h-full col-span-1"})]}),(0,s.jsxs)("div",{className:"grid h-[30px] border-b border-border",style:{gridTemplateColumns:"repeat(".concat(eu>0?eu:1,", ").concat(W,"px)")},children:[Array.from({length:eu>0?eu:0}).map((e,t)=>{let r=(0,h.f)(ec,t);return(0,s.jsx)("div",{className:(0,v.cn)("flex items-center justify-center border-r border-border text-muted-foreground text-[10px]",(0,d.r)(r,ej)?"bg-primary/10 dark:bg-primary/20":""),title:(0,x.GP)(r,"EEE, MMM d"),children:(0,x.GP)(r,"d")},"".concat(t))}),eu<=0&&(0,s.jsx)("div",{className:"h-full col-span-1"})]})]}),(0,s.jsxs)("div",{className:"relative timeline-inner-content-scrollable-body",style:{height:"".concat(ek,"px"),width:"".concat(eD,"px")},children:[eo.length>0&&(0,s.jsxs)(s.Fragment,{children:[eo.map((e,t)=>(0,s.jsx)("div",{className:"absolute left-0 right-0 border-b border-border/30",style:{top:"".concat((t+1)*48-1,"px"),height:"1px",zIndex:1}},"row-line-".concat(t))),eN&&eu>0&&(0,s.jsx)("div",{className:"absolute top-0 bottom-0 w-[2px] bg-destructive/70 z-[5]",style:{left:"".concat(ew,"px")},title:"Today: ".concat((0,x.GP)(ej,"PPP")),children:(0,s.jsx)("div",{className:"absolute -top-1.5 left-1/2 -translate-x-1/2 bg-destructive text-white text-[8px] px-0.5 rounded-sm",children:"TODAY"})}),eo.map((e,t)=>{var n;let a=ep.get(e.id);if(!a)return null;let{barStartX:i,barWidth:l,isMilestone:o}=a,c=(null==U?void 0:U.taskId)===e.id,d=(null==K?void 0:K.sourceTaskId)===e.id;return(0,s.jsxs)(L.AM,{open:ea&&es.taskId===e.id,onOpenChange:t=>{t?e.id!==es.taskId&&(en({taskId:e.id,currentTitle:e.title,currentInstrumentSubtype:e.instrument_subtype,currentStatus:e.status,currentProgress:e.progress||0}),ei(!0)):(ei(!1),en({taskId:null,currentTitle:A.ho[0]||"",currentInstrumentSubtype:void 0,currentStatus:"To Do",currentProgress:0}))},children:[(0,s.jsxs)(E.m_,{delayDuration:c||d||ea&&es.taskId===e.id?999999:100,children:[(0,s.jsx)(E.k$,{asChild:!0,children:(0,s.jsx)(L.Wv,{asChild:!0,children:(0,s.jsxs)("div",{onMouseDown:t=>ef(t,e),onClick:t=>ev(t,e),onMouseEnter:()=>J(e.id),onMouseLeave:()=>J(null),className:(0,v.cn)("absolute transition-opacity duration-150 ease-in-out group cursor-grab z-10",q(e.status,o),!o&&"rounded-sm",c||d?"ring-2 ring-ring ring-offset-background ring-offset-1 shadow-lg":e.id===Z?"ring-1 ring-primary/70":"",U&&U.taskId!==e.id||K&&K.sourceTaskId!==e.id||Z&&e.id!==Z?"opacity-50":"opacity-100"),style:{left:"".concat(i,"px"),width:"".concat(l<0?0:l,"px"),top:"".concat(48*t+(o?16:8),"px"),height:o?"".concat(16,"px"):"".concat(32,"px")},children:[!o&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"resize-handle absolute left-0 top-0 bottom-0 w-2 cursor-ew-resize z-20",onMouseDown:t=>eg(t,e,"start"),title:"Resize start date",children:(0,s.jsx)(C.A,{className:"h-full w-2 text-white/30 hover:text-white/70"})}),(0,s.jsx)("div",{className:"resize-handle absolute right-0 top-0 bottom-0 w-2 cursor-ew-resize z-20",onMouseDown:t=>eg(t,e,"end"),title:"Resize end date",children:(0,s.jsx)(C.A,{className:"h-full w-2 text-white/30 hover:text-white/70"})}),(0,s.jsx)("div",{className:"dependency-connector absolute right-[-6px] top-1/2 -translate-y-1/2 w-3 h-3 rounded-full bg-primary border-2 border-background cursor-crosshair z-30 opacity-0 group-hover:opacity-100 transition-opacity",onMouseDown:t=>eb(t,e),title:"Draw dependency"})]}),!o&&(null==(n=e.status)?void 0:n.toLowerCase())!=="done"&&void 0!==e.progress&&e.progress>0&&l>0&&(0,s.jsx)("div",{className:"absolute top-0 left-0 h-full bg-black/40 rounded-sm",style:{width:"".concat(e.progress,"%")}}),o&&(0,s.jsx)("div",{className:"absolute inset-0 flex items-center justify-center",children:(0,s.jsx)("svg",{viewBox:"0 0 100 100",className:"w-full h-full fill-current text-white/80",preserveAspectRatio:"none",children:(0,s.jsx)("polygon",{points:"50,0 100,50 50,100 0,50"})})}),!o&&l>.75*W&&(0,s.jsx)("div",{className:"absolute inset-0 flex items-center px-1.5 overflow-hidden",children:(0,s.jsx)("span",{className:"text-[10px] text-white/90 font-medium whitespace-nowrap overflow-hidden text-ellipsis",children:("MDL"===e.title||"SOP"===e.title)&&e.instrument_subtype?"".concat(e.title," (").concat(e.instrument_subtype,")"):e.title})})]})})}),(0,s.jsx)(E.ZI,{className:"p-2 shadow-lg bg-popover text-popover-foreground rounded-md border max-w-xs w-auto z-50",children:(0,s.jsxs)("div",{className:"space-y-1",children:[(0,s.jsx)("p",{className:"font-semibold text-sm",children:("MDL"===e.title||"SOP"===e.title)&&e.instrument_subtype?"".concat(e.title," (").concat(e.instrument_subtype,")"):e.title}),(0,s.jsxs)("p",{className:"text-xs text-muted-foreground",children:["Status: ",(0,s.jsx)("span",{className:"font-medium text-foreground",children:e.status})]}),(0,s.jsxs)("p",{className:"text-xs text-muted-foreground",children:["Priority: ",(0,s.jsx)("span",{className:"font-medium text-foreground",children:e.priority})]}),(0,s.jsxs)("p",{className:"text-xs text-muted-foreground",children:["Progress: ",(0,s.jsxs)("span",{className:"font-medium text-foreground",children:[e.progress||0,"%"]})]}),(0,s.jsxs)("p",{className:"text-xs text-muted-foreground",children:["Dates: ",(0,x.GP)(e.startDate,"MMM d, yy")," - ",(0,x.GP)(e.dueDate,"MMM d, yy")]}),e.assignedTo_text&&(0,s.jsxs)("p",{className:"text-xs text-muted-foreground",children:["Assigned to: ",(0,s.jsx)("span",{className:"font-medium text-foreground",children:e.assignedTo_text})]}),e.dependencies&&e.dependencies.length>0&&(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-xs text-muted-foreground mt-1",children:"Depends on:"}),(0,s.jsx)("ul",{className:"list-disc list-inside pl-2 space-y-0.5",children:e.dependencies.map(e=>{let t=r.find(t=>t.id===e);return(0,s.jsx)("li",{className:"text-xs font-medium text-foreground truncate",title:null==t?void 0:t.title,children:(null==t?void 0:t.title)||"Unknown Task"},e)})})]}),!e.dependencies||0===e.dependencies.length&&(0,s.jsx)("p",{className:"text-xs text-muted-foreground",children:"Dependencies: None"})]})})]}),(0,s.jsx)(L.hl,{className:"w-80 z-50",side:"bottom",align:"start",children:(0,s.jsxs)("div",{className:"grid gap-4",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)("h4",{className:"font-medium leading-none",children:["Quick Edit: ",es.currentTitle,("MDL"===es.currentTitle||"SOP"===es.currentTitle)&&es.currentInstrumentSubtype?" (".concat(es.currentInstrumentSubtype,")"):""]}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"Modify task details."})]}),(0,s.jsxs)("div",{className:"grid gap-2",children:[(0,s.jsxs)("div",{className:"grid grid-cols-3 items-center gap-4",children:[(0,s.jsx)(X.J,{htmlFor:"qe-title-".concat(e.id),children:"Type"}),(0,s.jsxs)(_.l6,{value:es.currentTitle,onValueChange:e=>en(t=>({...t,currentTitle:e,currentInstrumentSubtype:"MDL"!==e&&"SOP"!==e?void 0:t.currentInstrumentSubtype})),children:[(0,s.jsx)(_.bq,{id:"qe-title-".concat(e.id),className:"col-span-2 h-8",children:(0,s.jsx)(_.yv,{placeholder:"Select type"})}),(0,s.jsx)(_.gC,{children:A.ho.map(e=>(0,s.jsx)(_.eb,{value:e,children:e},e))})]})]}),"MDL"===es.currentTitle&&(0,s.jsxs)("div",{className:"grid grid-cols-3 items-center gap-4",children:[(0,s.jsx)(X.J,{htmlFor:"qe-instrument-".concat(e.id),children:"Instrument"}),(0,s.jsxs)(_.l6,{value:es.currentInstrumentSubtype||"",onValueChange:e=>en(t=>({...t,currentInstrumentSubtype:e})),children:[(0,s.jsx)(_.bq,{id:"qe-instrument-".concat(e.id),className:"col-span-2 h-8",children:(0,s.jsx)(_.yv,{placeholder:"Select instrument"})}),(0,s.jsx)(_.gC,{children:A.oe.map(e=>(0,s.jsx)(_.eb,{value:e,children:e},e))})]})]}),"SOP"===es.currentTitle&&(0,s.jsxs)("div",{className:"grid grid-cols-3 items-center gap-4",children:[(0,s.jsx)(X.J,{htmlFor:"qe-sop-".concat(e.id),children:"SOP Code"}),(0,s.jsxs)(_.l6,{value:es.currentInstrumentSubtype||"",onValueChange:e=>en(t=>({...t,currentInstrumentSubtype:e})),children:[(0,s.jsx)(_.bq,{id:"qe-sop-".concat(e.id),className:"col-span-2 h-8",children:(0,s.jsx)(_.yv,{placeholder:"Select SOP Code"})}),(0,s.jsx)(_.gC,{children:A.tk.map(e=>(0,s.jsx)(_.eb,{value:e,children:e},e))})]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-3 items-center gap-4",children:[(0,s.jsx)(X.J,{htmlFor:"qe-status-".concat(e.id),children:"Status"}),(0,s.jsxs)(_.l6,{value:es.currentStatus,onValueChange:e=>en(t=>({...t,currentStatus:e})),children:[(0,s.jsx)(_.bq,{id:"qe-status-".concat(e.id),className:"col-span-2 h-8",children:(0,s.jsx)(_.yv,{placeholder:"Select status"})}),(0,s.jsx)(_.gC,{children:A.Hi.map(e=>(0,s.jsx)(_.eb,{value:e,children:e},e))})]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-3 items-center gap-4",children:[(0,s.jsx)(X.J,{htmlFor:"qe-progress-".concat(e.id),children:"Progress (%)"}),(0,s.jsx)(z.p,{id:"qe-progress-".concat(e.id),type:"number",min:"0",max:"100",value:es.currentProgress,onChange:e=>en(t=>({...t,currentProgress:parseInt(e.target.value,10)||0})),className:"col-span-2 h-8"})]})]}),(0,s.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,s.jsx)(P.$,{variant:"ghost",size:"sm",onClick:()=>ei(!1),children:"Cancel"}),(0,s.jsxs)(P.$,{size:"sm",onClick:ey,children:[(0,s.jsx)(I.A,{className:"mr-1 h-4 w-4"}),"Save"]})]})]})})]},"".concat(e.id,"-popover"))}),K&&(0,s.jsx)("svg",{className:"absolute top-0 left-0 w-full h-full pointer-events-none z-40",style:{width:eD,height:ek},children:(0,s.jsx)("line",{x1:K.sourceTaskBarEndX,y1:K.sourceTaskBarCenterY,x2:K.currentMouseX,y2:K.currentMouseY,stroke:"hsl(var(--primary))",strokeWidth:"2",strokeDasharray:"4 2"})}),ex.length>0&&(0,s.jsxs)("svg",{className:"absolute top-0 left-0 pointer-events-none",width:eD,height:ek,xmlns:"http://www.w3.org/2000/svg",style:{zIndex:20},children:[(0,s.jsx)("defs",{children:(0,s.jsx)("marker",{id:"arrowhead",markerWidth:6,markerHeight:4,refX:5.5,refY:2,orient:"auto-start-reverse",children:(0,s.jsx)("polygon",{points:"0 0, ".concat(5," ").concat(2,", 0 ").concat(4),fill:"hsl(var(--foreground) / 0.6)"})})}),ex.map(e=>(0,s.jsx)("path",{d:e.d,stroke:"hsl(var(--foreground) / 0.6)",strokeWidth:"1.5",fill:"none",markerEnd:"url(#arrowhead)"},e.id))]})]}),0===eo.length&&!Y&&(0,s.jsx)("div",{style:{height:144},className:"flex items-center justify-center",children:eS()})]})]})})]})]})})};function B(){return(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsx)("h1",{className:"text-2xl md:text-3xl font-headline font-semibold",children:"Timeline / Gantt Chart"}),(0,s.jsxs)("p",{className:"text-muted-foreground",children:["Visualize task schedules and progress.",(0,s.jsx)("span",{className:"text-xs block mt-1",children:"Note: Advanced features like drag-and-drop rescheduling and dependency linking are planned for future updates."})]}),(0,s.jsxs)(a.Zp,{className:"shadow-md",children:[(0,s.jsxs)(a.aR,{children:[(0,s.jsx)(a.ZB,{className:"font-headline",children:"Project Schedule"}),(0,s.jsx)(a.BT,{children:"Overview of task timelines."})]}),(0,s.jsx)(a.Wu,{className:"overflow-x-auto p-0 md:p-6",children:(0,s.jsx)(Y,{})})]})]})}},53662:(e,t,r)=>{Promise.resolve().then(r.bind(r,47783))},62523:(e,t,r)=>{"use strict";r.d(t,{p:()=>i});var s=r(95155),n=r(12115),a=r(59434);let i=n.forwardRef((e,t)=>{let{className:r,type:n,...i}=e;return(0,s.jsx)("input",{type:n,className:(0,a.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",r),ref:t,...i})});i.displayName="Input"}},e=>{var t=t=>e(e.s=t);e.O(0,[383,897,125,977,192,114,517,666,480,441,303,358],()=>t(53662)),_N_E=e.O()}]);