(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[346],{3567:(e,t,a)=>{"use strict";a.d(t,{R:()=>s});var r=a(35476);function s(e){return+(0,r.a)(e)<Date.now()}},6101:(e,t,a)=>{"use strict";a.d(t,{s:()=>o,t:()=>n});var r=a(12115);function s(e,t){if("function"==typeof e)return e(t);null!=e&&(e.current=t)}function n(...e){return t=>{let a=!1,r=e.map(e=>{let r=s(e,t);return a||"function"!=typeof r||(a=!0),r});if(a)return()=>{for(let t=0;t<r.length;t++){let a=r[t];"function"==typeof a?a():s(e[t],null)}}}}function o(...e){return r.useCallback(n(...e),e)}},13813:(e,t,a)=>{Promise.resolve().then(a.bind(a,97297))},30285:(e,t,a)=>{"use strict";a.d(t,{$:()=>d,r:()=>i});var r=a(95155),s=a(12115),n=a(99708),o=a(74466),l=a(59434);let i=(0,o.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),d=s.forwardRef((e,t)=>{let{className:a,variant:s,size:o,asChild:d=!1,...c}=e,u=d?n.DX:"button";return(0,r.jsx)(u,{className:(0,l.cn)(i({variant:s,size:o,className:a})),ref:t,...c})});d.displayName="Button"},30645:(e,t,a)=>{"use strict";a.d(t,{b:()=>s});let r={maxAttempts:3,delayMs:500,shouldRetry:e=>!!e&&"object"==typeof e&&!(!0===e.isAbort||"string"==typeof e.message&&e.message.toLowerCase().includes("aborted"))&&(0===e.status||502===e.status||503===e.status||504===e.status)};async function s(e,t){let a,s={...r,...t};for(let t=1;t<=s.maxAttempts;t++)try{return await e()}catch(e){if(a=e,s.shouldRetry(e))s.onRetry&&s.onRetry(t,e),t<s.maxAttempts?(console.warn("Attempt ".concat(t," failed for operation. Retrying in ").concat(s.delayMs*Math.pow(2,t-1),"ms... Error: ").concat(e.message||JSON.stringify(e))),await new Promise(e=>setTimeout(e,s.delayMs*Math.pow(2,t-1)))):console.warn("All ".concat(s.maxAttempts," attempts failed for operation. Last error: ").concat(e.message||JSON.stringify(e)));else throw e}throw a}},50172:(e,t,a)=>{"use strict";a.d(t,{A:()=>r});let r=(0,a(40157).A)("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},59434:(e,t,a)=>{"use strict";a.d(t,{cn:()=>n});var r=a(52596),s=a(39688);function n(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return(0,s.QP)((0,r.$)(t))}},59576:(e,t,a)=>{"use strict";a.d(t,{A:()=>m,AuthProvider:()=>u});var r=a(95155),s=a(35695),n=a(12115),o=a(7140),l=a(87481);let i=new o.Ay("https://swoodhu.pockethost.io/"),d=(0,n.createContext)(void 0),c=["Supervisor","Team Lead","Chem I","Chem II"],u=e=>{let{children:t}=e,[a,o]=(0,n.useState)(null),[u,m]=(0,n.useState)(!0),f=(0,s.useRouter)(),{toast:p}=(0,l.dj)();(0,n.useEffect)(()=>{m(!0),(async()=>{if(i.authStore.isValid&&i.authStore.model){var e;let t=i.authStore.model,a=t.role;if("Analyst"===a&&(a="Chem I"),!a||!c.includes(a)){let e=localStorage.getItem("labflowUserRole"),t="Chem I";e&&("Analyst"===e?t="Chem I":c.includes(e)&&(t=e)),a=t}o({id:t.id,email:t.email||"",name:t.name||(null==(e=t.email)?void 0:e.split("@")[0])||"User",role:a,avatarUrl:t.avatar?i.files.getUrl(t,t.avatar,{thumb:"100x100"}):"https://placehold.co/100x100.png?text=".concat((t.name||t.email||"U")[0].toUpperCase())}),localStorage.setItem("labflowUserRole",a)}})().finally(()=>m(!1))},[]);let h=async(e,t)=>{m(!0);try{if(await i.collection("users").authWithPassword(e,t),i.authStore.model){var a;let e=i.authStore.model,t=e.role;"Analyst"===t&&(t="Chem I"),t&&c.includes(t)||(console.warn("User ".concat(e.email," has an invalid or missing role ('").concat(e.role,"') in PocketBase. Defaulting to 'Chem I'.")),t="Chem I");let r={id:e.id,email:e.email||"",name:e.name||(null==(a=e.email)?void 0:a.split("@")[0])||"User",role:t,avatarUrl:e.avatar?i.files.getUrl(e,e.avatar,{thumb:"100x100"}):"https://placehold.co/100x100.png?text=".concat((e.name||e.email||"U")[0].toUpperCase())};o(r),localStorage.setItem("labflowUserRole",r.role),p({title:"Login Successful",description:"Welcome back, ".concat(r.name,"!")}),f.push("/dashboard")}else throw Error("Authentication successful but no user model found.")}catch(t){console.error("Login failed:",t);let e="Login failed. Please check your credentials.";if(t.data&&t.data.data){let a=Object.values(t.data.data).map(e=>e.message).join(", ");a&&(e=a)}else t.message&&(e=t.message);p({title:"Login Failed",description:e,variant:"destructive"}),o(null)}finally{m(!1)}};return(0,r.jsx)(d.Provider,{value:{user:a,login:h,logout:()=>{i.authStore.clear(),o(null),localStorage.removeItem("labflowUserRole"),f.push("/"),p({title:"Logged Out",description:"You have been successfully logged out."})},loading:u,pbClient:i},children:t})},m=()=>{let e=(0,n.useContext)(d);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},66695:(e,t,a)=>{"use strict";a.d(t,{BT:()=>d,Wu:()=>c,ZB:()=>i,Zp:()=>o,aR:()=>l});var r=a(95155),s=a(12115),n=a(59434);let o=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("div",{ref:t,className:(0,n.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",a),...s})});o.displayName="Card";let l=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("div",{ref:t,className:(0,n.cn)("flex flex-col space-y-1.5 p-6",a),...s})});l.displayName="CardHeader";let i=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("div",{ref:t,className:(0,n.cn)("text-2xl font-semibold leading-none tracking-tight",a),...s})});i.displayName="CardTitle";let d=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("div",{ref:t,className:(0,n.cn)("text-sm text-muted-foreground",a),...s})});d.displayName="CardDescription";let c=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("div",{ref:t,className:(0,n.cn)("p-6 pt-0",a),...s})});c.displayName="CardContent",s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("div",{ref:t,className:(0,n.cn)("flex items-center p-6 pt-0",a),...s})}).displayName="CardFooter"},74466:(e,t,a)=>{"use strict";a.d(t,{F:()=>o});var r=a(52596);let s=e=>"boolean"==typeof e?`${e}`:0===e?"0":e,n=r.$,o=(e,t)=>a=>{var r;if((null==t?void 0:t.variants)==null)return n(e,null==a?void 0:a.class,null==a?void 0:a.className);let{variants:o,defaultVariants:l}=t,i=Object.keys(o).map(e=>{let t=null==a?void 0:a[e],r=null==l?void 0:l[e];if(null===t)return null;let n=s(t)||s(r);return o[e][n]}),d=a&&Object.entries(a).reduce((e,t)=>{let[a,r]=t;return void 0===r||(e[a]=r),e},{});return n(e,i,null==t||null==(r=t.compoundVariants)?void 0:r.reduce((e,t)=>{let{class:a,className:r,...s}=t;return Object.entries(s).every(e=>{let[t,a]=e;return Array.isArray(a)?a.includes({...l,...d}[t]):({...l,...d})[t]===a})?[...e,a,r]:e},[]),null==a?void 0:a.class,null==a?void 0:a.className)}},85511:(e,t,a)=>{"use strict";a.d(t,{V:()=>d});var r=a(95155);a(12115);var s=a(965),n=a(73158),o=a(71499),l=a(59434),i=a(30285);function d(e){let{className:t,classNames:a,showOutsideDays:d=!0,...c}=e;return(0,r.jsx)(o.hv,{showOutsideDays:d,className:(0,l.cn)("p-3",t),classNames:{months:"flex flex-col sm:flex-row space-y-4 sm:space-x-4 sm:space-y-0",month:"space-y-4",caption:"flex justify-center pt-1 relative items-center",caption_label:"text-sm font-medium",nav:"space-x-1 flex items-center",nav_button:(0,l.cn)((0,i.r)({variant:"outline"}),"h-7 w-7 bg-transparent p-0 opacity-50 hover:opacity-100"),nav_button_previous:"absolute left-1",nav_button_next:"absolute right-1",table:"w-full border-collapse space-y-1",head_row:"flex",head_cell:"text-muted-foreground rounded-md w-9 font-normal text-[0.8rem]",row:"flex w-full mt-2",cell:"h-9 w-9 text-center text-sm p-0 relative [&:has([aria-selected].day-range-end)]:rounded-r-md [&:has([aria-selected].day-outside)]:bg-accent/50 [&:has([aria-selected])]:bg-accent first:[&:has([aria-selected])]:rounded-l-md last:[&:has([aria-selected])]:rounded-r-md focus-within:relative focus-within:z-20",day:(0,l.cn)((0,i.r)({variant:"ghost"}),"h-9 w-9 p-0 font-normal aria-selected:opacity-100"),day_range_end:"day-range-end",day_selected:"bg-primary text-primary-foreground hover:bg-primary hover:text-primary-foreground focus:bg-primary focus:text-primary-foreground",day_today:"bg-accent text-accent-foreground",day_outside:"day-outside text-muted-foreground aria-selected:bg-accent/50 aria-selected:text-muted-foreground",day_disabled:"text-muted-foreground opacity-50",day_range_middle:"aria-selected:bg-accent aria-selected:text-accent-foreground",day_hidden:"invisible",...a},components:{IconLeft:e=>{let{className:t,...a}=e;return(0,r.jsx)(s.A,{className:(0,l.cn)("h-4 w-4",t),...a})},IconRight:e=>{let{className:t,...a}=e;return(0,r.jsx)(n.A,{className:(0,l.cn)("h-4 w-4",t),...a})}},...c})}d.displayName="Calendar"},87481:(e,t,a)=>{"use strict";a.d(t,{dj:()=>m});var r=a(12115);let s=0,n=new Map,o=e=>{if(n.has(e))return;let t=setTimeout(()=>{n.delete(e),c({type:"REMOVE_TOAST",toastId:e})},1e6);n.set(e,t)},l=(e,t)=>{switch(t.type){case"ADD_TOAST":return{...e,toasts:[t.toast,...e.toasts].slice(0,1)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(e=>e.id===t.toast.id?{...e,...t.toast}:e)};case"DISMISS_TOAST":{let{toastId:a}=t;return a?o(a):e.toasts.forEach(e=>{o(e.id)}),{...e,toasts:e.toasts.map(e=>e.id===a||void 0===a?{...e,open:!1}:e)}}case"REMOVE_TOAST":if(void 0===t.toastId)return{...e,toasts:[]};return{...e,toasts:e.toasts.filter(e=>e.id!==t.toastId)}}},i=[],d={toasts:[]};function c(e){d=l(d,e),i.forEach(e=>{e(d)})}function u(e){let{...t}=e,a=(s=(s+1)%Number.MAX_SAFE_INTEGER).toString(),r=()=>c({type:"DISMISS_TOAST",toastId:a});return c({type:"ADD_TOAST",toast:{...t,id:a,open:!0,onOpenChange:e=>{e||r()}}}),{id:a,dismiss:r,update:e=>c({type:"UPDATE_TOAST",toast:{...e,id:a}})}}function m(){let[e,t]=r.useState(d);return r.useEffect(()=>(i.push(t),()=>{let e=i.indexOf(t);e>-1&&i.splice(e,1)}),[e]),{...e,toast:u,dismiss:e=>c({type:"DISMISS_TOAST",toastId:e})}}},97297:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>j});var r=a(95155),s=a(85511),n=a(66695),o=a(12115),l=a(83013),i=a(80644),d=a(3567),c=a(76959),u=a(39140),m=a(35476),f=a(30285),p=a(59576),h=a(30645);let g=e=>({id:e.id,title:e.title,eventDate:e.dueDate?new Date(e.dueDate):new Date,description:e.description,status:e.status,userId:e.userId,created:e.created?new Date(e.created):new Date,updated:e.updated?new Date(e.updated):new Date,collectionId:e.collectionId,collectionName:e.collectionName,expand:e.expand}),y=async e=>{try{return(await (0,h.b)(()=>e.collection("tasks").getFullList({filter:'dueDate != null && dueDate != ""',sort:"-dueDate"}))).map(g).filter(e=>e.eventDate)}catch(e){throw e}};var v=a(87481),x=a(50172),b=a(31949);let w=e=>{let t="An unexpected error occurred while fetching tasks for the calendar.";if(e&&"object"==typeof e){if("status"in e&&0===e.status)t="Network error: Failed to communicate with the server. Please check your connection and try again.";else if(e.data&&"object"==typeof e.data){if(e.data.message&&"string"==typeof e.data.message&&(t=e.data.message),e.data.data&&"object"==typeof e.data.data&&Object.keys(e.data.data).length>0){let a=Object.entries(e.data.data).map(e=>{let[t,a]=e;return"".concat(t,": ").concat(a&&a.message?a.message:"Invalid value")}).join("; ");t=a?"".concat(t,". Details: ").concat(a):t}}else e.message&&"string"==typeof e.message&&!e.message.startsWith("PocketBase_ClientResponseError")?t=e.message:e.originalError&&"string"==typeof e.originalError.message?t=e.originalError.message:e.message&&"string"==typeof e.message&&(t=e.message);if("status"in e&&0!==e.status){let a=e.status;404===a?t="The 'tasks' collection (used for calendar events) was not found (404). ".concat(t):403===a?t="You do not have permission to view tasks for the calendar (403). ".concat(t):400===a&&(t=t.toLowerCase().includes("something went wrong")||t.startsWith("PocketBase_ClientResponseError")||e.data&&0===Object.keys(e.data.data||{}).length?"Request error (400): ".concat(t,". Please check the 'tasks' collection schema, especially ensure 'dueDate' exists and is a sortable Date type."):"Request error (400) when fetching tasks for calendar: ".concat(t,"."))}}else"string"==typeof e&&(t=e);return t};function j(){let{pbClient:e}=(0,p.A)(),{toast:t}=(0,v.dj)(),[a,h]=(0,o.useState)([]),[g,j]=(0,o.useState)(!0),[N,D]=(0,o.useState)(null),[k,S]=(0,o.useState)(void 0);(0,o.useEffect)(()=>{S(new Date)},[]);let A=(0,o.useCallback)(async e=>{if(!e)return void j(!0);let a=!1;j(!0),D(null);try{let t=await y(e);a||h(t)}catch(e){if(!a){let a=(null==e?void 0:e.isAbort)===!0||"string"==typeof(null==e?void 0:e.message)&&e.message.toLowerCase().includes("autocancelled"),r=(null==e?void 0:e.status)===0&&!a;if(a)console.warn("Calendar events (tasks) fetch request was ".concat((null==e?void 0:e.isAbort)?"aborted":"autocancelled","."),e);else if(r){let a=w(e);D(a),t({title:"Network Error",description:a,variant:"destructive"}),console.warn("Calendar events (tasks) fetch (network error):",a,e)}else{console.warn("Error fetching tasks for calendar (after retries):",e);let a=w(e);D(a),t({title:"Error Loading Calendar Data",description:a,variant:"destructive"})}}}finally{a||j(!1)}return()=>{a=!0}},[t]);(0,o.useEffect)(()=>{if(e){let t=A(e);return()=>{"function"==typeof t&&t()}}j(!0)},[e,A]);let C=(0,o.useMemo)(()=>k?a.filter(e=>e.eventDate&&(0,l.GP)(new Date(e.eventDate),"yyyy-MM-dd")===(0,l.GP)(k,"yyyy-MM-dd")):[],[k,a]),{overdueEventDates:E,completedEventDates:_,almostDueEventDates:R,activeEventDates:T}=(0,o.useMemo)(()=>{let e=(0,i.o)(new Date),t=[],r=[],s=[],n=[];return a.forEach(a=>{if(!a.eventDate||!a.status)return;let o=(0,i.o)(new Date(a.eventDate));if("Done"===a.status)r.push(o);else if((0,d.R)(o)&&!(0,c.r)(o,e))t.push(o);else{let t=(0,u.m)(o,e);if(t>=0&&t<3)s.push(o);else(+(0,m.a)(o)>Date.now()||(0,c.r)(o,e))&&n.push(o)}}),{overdueEventDates:[...new Set(t.map(e=>e.getTime()))].map(e=>new Date(e)),completedEventDates:[...new Set(r.map(e=>e.getTime()))].map(e=>new Date(e)),almostDueEventDates:[...new Set(s.map(e=>e.getTime()))].map(e=>new Date(e)),activeEventDates:[...new Set(n.map(e=>e.getTime()))].map(e=>new Date(e))}},[a]);return(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsx)("h1",{className:"text-3xl font-headline font-semibold",children:"Task Calendar"}),g&&(0,r.jsxs)("div",{className:"flex justify-center items-center py-10",children:[(0,r.jsx)(x.A,{className:"h-8 w-8 animate-spin text-primary"}),(0,r.jsx)("p",{className:"ml-2",children:"Loading tasks for calendar..."})]}),N&&!g&&(0,r.jsxs)("div",{className:"text-center py-10 text-destructive",children:[(0,r.jsx)(b.A,{className:"mx-auto h-12 w-12 text-destructive"}),(0,r.jsx)("p",{className:"mt-4 text-lg font-semibold",children:"Failed to Load Calendar Data"}),(0,r.jsx)("p",{className:"text-sm whitespace-pre-wrap",children:N}),(0,r.jsx)(f.$,{onClick:()=>{e&&A(e)},className:"mt-6",children:"Try Again"})]}),!g&&!N&&(0,r.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[(0,r.jsx)(n.Zp,{className:"lg:col-span-2 shadow-md",children:(0,r.jsx)(n.Wu,{className:"p-0",children:(0,r.jsx)(s.V,{mode:"single",selected:k,onSelect:S,className:"rounded-md",modifiers:{completed:_,overdue:E,almostDue:R,active:T},modifiersClassNames:{completed:"!bg-green-100 !text-green-800 dark:!bg-green-800/30 dark:!text-green-200 border !border-green-300 dark:!border-green-700 rounded-md",overdue:"!bg-red-100 !text-red-800 dark:!bg-red-800/30 dark:!text-red-200 border !border-red-300 dark:!border-red-700 rounded-md",almostDue:"!bg-yellow-100 !text-yellow-800 dark:!bg-yellow-700/30 dark:!text-yellow-200 border !border-yellow-300 dark:!border-yellow-600 rounded-md",active:"!bg-blue-100 !text-blue-800 dark:!bg-blue-800/30 dark:!text-blue-200 border !border-blue-300 dark:!border-blue-700 rounded-md"}})})}),(0,r.jsxs)(n.Zp,{className:"shadow-md",children:[(0,r.jsx)(n.aR,{children:(0,r.jsxs)(n.ZB,{className:"font-headline",children:["Tasks for ",k?(0,l.GP)(k,"PPP"):"selected date"]})}),(0,r.jsx)(n.Wu,{children:C.length>0?(0,r.jsx)("ul",{className:"space-y-3",children:C.map(e=>(0,r.jsxs)("li",{className:"p-3 rounded-md border hover:bg-muted transition-colors",children:[(0,r.jsx)("h3",{className:"font-semibold",children:e.title}),e.description&&(0,r.jsx)("p",{className:"text-sm text-muted-foreground mt-1",children:e.description})]},e.id))}):(0,r.jsx)("p",{className:"text-muted-foreground",children:"No tasks due on this day."})})]})]})]})}},99708:(e,t,a)=>{"use strict";a.d(t,{DX:()=>o,xV:()=>i});var r=a(12115),s=a(6101),n=a(95155),o=r.forwardRef((e,t)=>{let{children:a,...s}=e,o=r.Children.toArray(a),i=o.find(d);if(i){let e=i.props.children,a=o.map(t=>t!==i?t:r.Children.count(e)>1?r.Children.only(null):r.isValidElement(e)?e.props.children:null);return(0,n.jsx)(l,{...s,ref:t,children:r.isValidElement(e)?r.cloneElement(e,void 0,a):null})}return(0,n.jsx)(l,{...s,ref:t,children:a})});o.displayName="Slot";var l=r.forwardRef((e,t)=>{let{children:a,...n}=e;if(r.isValidElement(a)){let e=function(e){let t=Object.getOwnPropertyDescriptor(e.props,"ref")?.get,a=t&&"isReactWarning"in t&&t.isReactWarning;return a?e.ref:(a=(t=Object.getOwnPropertyDescriptor(e,"ref")?.get)&&"isReactWarning"in t&&t.isReactWarning)?e.props.ref:e.props.ref||e.ref}(a),o=function(e,t){let a={...t};for(let r in t){let s=e[r],n=t[r];/^on[A-Z]/.test(r)?s&&n?a[r]=(...e)=>{n(...e),s(...e)}:s&&(a[r]=s):"style"===r?a[r]={...s,...n}:"className"===r&&(a[r]=[s,n].filter(Boolean).join(" "))}return{...e,...a}}(n,a.props);return a.type!==r.Fragment&&(o.ref=t?(0,s.t)(t,e):e),r.cloneElement(a,o)}return r.Children.count(a)>1?r.Children.only(null):null});l.displayName="SlotClone";var i=({children:e})=>(0,n.jsx)(n.Fragment,{children:e});function d(e){return r.isValidElement(e)&&e.type===i}}},e=>{var t=t=>e(e.s=t);e.O(0,[284,73,532,441,303,358],()=>t(13813)),_N_E=e.O()}]);