(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[536],{30645:(e,t,a)=>{"use strict";a.d(t,{b:()=>o});let s={maxAttempts:4,delayMs:1e3,shouldRetry:e=>!!e&&"object"==typeof e&&!(!0===e.isAbort||"string"==typeof e.message&&e.message.toLowerCase().includes("aborted"))&&!0!==e.isCircuitOpenError&&!0!==e.circuitJustOpened&&(0===e.status||502===e.status||503===e.status||504===e.status),context:"operation"};var r=function(e){return e.Closed="CLOSED",e.Open="OPEN",e.HalfOpen="HALF_OPEN",e}(r||{});let l=new Map;async function o(e,t){let a,r={...s,...t},o=r.context,n=(e,t)=>{let a="[withRetry:".concat(o,"] ").concat(e,". Circuit: ").concat(c.state,".");console.warn(a);let s=Error(a);throw s.isAbort=!0,s.context=o,t&&(s.originalError=t),s};l.has(o)||l.set(o,{state:"CLOSED",failures:0});let c=l.get(o);if("OPEN"===c.state)if(Date.now()<(c.openUntil||0)){let e=Error("Circuit for '".concat(o,"' is open due to repeated failures. Please try again in a few moments."));throw e.isCircuitOpenError=!0,e.context=o,e.openUntil=c.openUntil,e}else c.state="HALF_OPEN",c.failures=0,c.openUntil=void 0,console.log("[withRetry:".concat(o,"] Circuit is now HalfOpen. Allowing one attempt."));let i="HALF_OPEN"===c.state?1:r.maxAttempts;for(let t=1;t<=i;t++){var d,u,m;(null==(d=r.signal)?void 0:d.aborted)&&n("Aborted before attempt ".concat(t));try{let t=await e();return("HALF_OPEN"===c.state||c.failures>0||"OPEN"===c.state)&&(console.log("[withRetry:".concat(o,"] Circuit is now Closed due to successful attempt (was ").concat(c.state,").")),c.state="CLOSED",c.failures=0,c.openUntil=void 0),t}catch(e){if(a=e,(null==(u=r.signal)?void 0:u.aborted)&&n("Aborted during/after attempt ".concat(t," (caught error: ").concat((null==e?void 0:e.message)||e,")"),e),e&&"object"==typeof e&&(!0===e.isAbort||"string"==typeof e.message&&e.message.toLowerCase().includes("aborted")))throw console.warn("[withRetry:".concat(o,"] Caught abort-like error on attempt ").concat(t,": ").concat(e.message,". Circuit: ").concat(c.state,".")),e.isAbort||(e.isAbort=!0),e.context||(e.context=o),e;if(r.shouldRetry(e))if(r.onRetry&&r.onRetry(t,i,e),t<i){let e="HALF_OPEN"===c.state?r.delayMs:r.delayMs*Math.pow(2,t-1);await new Promise(t=>setTimeout(t,e)),(null==(m=r.signal)?void 0:m.aborted)&&n("Aborted during retry delay after attempt ".concat(t))}else throw console.warn("[withRetry:".concat(o,"] All ").concat(i," attempts failed (Circuit: ").concat(c.state,"). Last error: ").concat(e.message||JSON.stringify(e))),"HALF_OPEN"===c.state?(console.warn("[withRetry:".concat(o,"] Circuit failed in HalfOpen state. Re-opening.")),c.state="OPEN",c.openUntil=Date.now()+3e4,a.circuitJustOpened=!0,a.context=o):"CLOSED"===c.state&&(c.failures++,console.log("[withRetry:".concat(o,"] Circuit failure count: ").concat(c.failures," (max: ").concat(1,")")),c.failures>=1&&(console.warn("[withRetry:".concat(o,"] Circuit reached max failures. Opening circuit.")),c.state="OPEN",c.openUntil=Date.now()+3e4,a.circuitJustOpened=!0,a.context=o)),a;else throw e}}if(a)throw a;throw Error("[withRetry:".concat(o,"] Unexpected exit: Max attempts ").concat(i," reached without success or explicit error handling."))}},46102:(e,t,a)=>{"use strict";a.d(t,{Bc:()=>n,ZI:()=>d,k$:()=>i,m_:()=>c});var s=a(95155),r=a(12115),l=a(89613),o=a(59434);let n=l.Kq,c=l.bL,i=l.l9,d=r.forwardRef((e,t)=>{let{className:a,sideOffset:r=4,...n}=e;return(0,s.jsx)(l.UC,{ref:t,sideOffset:r,className:(0,o.cn)("z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",a),...n})});d.displayName=l.UC.displayName},59409:(e,t,a)=>{"use strict";a.d(t,{bq:()=>m,eb:()=>x,gC:()=>f,l6:()=>d,yv:()=>u});var s=a(95155),r=a(12115),l=a(31992),o=a(79556),n=a(77381),c=a(10518),i=a(59434);let d=l.bL;l.YJ;let u=l.WT,m=r.forwardRef((e,t)=>{let{className:a,children:r,...n}=e;return(0,s.jsxs)(l.l9,{ref:t,className:(0,i.cn)("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",a),...n,children:[r,(0,s.jsx)(l.In,{asChild:!0,children:(0,s.jsx)(o.A,{className:"h-4 w-4 opacity-50"})})]})});m.displayName=l.l9.displayName;let h=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(l.PP,{ref:t,className:(0,i.cn)("flex cursor-default items-center justify-center py-1",a),...r,children:(0,s.jsx)(n.A,{className:"h-4 w-4"})})});h.displayName=l.PP.displayName;let p=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(l.wn,{ref:t,className:(0,i.cn)("flex cursor-default items-center justify-center py-1",a),...r,children:(0,s.jsx)(o.A,{className:"h-4 w-4"})})});p.displayName=l.wn.displayName;let f=r.forwardRef((e,t)=>{let{className:a,children:r,position:o="popper",...n}=e;return(0,s.jsx)(l.ZL,{children:(0,s.jsxs)(l.UC,{ref:t,className:(0,i.cn)("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===o&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",a),position:o,...n,children:[(0,s.jsx)(h,{}),(0,s.jsx)(l.LM,{className:(0,i.cn)("p-1","popper"===o&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:r}),(0,s.jsx)(p,{})]})})});f.displayName=l.UC.displayName,r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(l.JU,{ref:t,className:(0,i.cn)("py-1.5 pl-8 pr-2 text-sm font-semibold",a),...r})}).displayName=l.JU.displayName;let x=r.forwardRef((e,t)=>{let{className:a,children:r,...o}=e;return(0,s.jsxs)(l.q7,{ref:t,className:(0,i.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",a),...o,children:[(0,s.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,s.jsx)(l.VF,{children:(0,s.jsx)(c.A,{className:"h-4 w-4"})})}),(0,s.jsx)(l.p4,{children:r})]})});x.displayName=l.q7.displayName,r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(l.wv,{ref:t,className:(0,i.cn)("-mx-1 my-1 h-px bg-muted",a),...r})}).displayName=l.wv.displayName},66695:(e,t,a)=>{"use strict";a.d(t,{BT:()=>i,Wu:()=>d,ZB:()=>c,Zp:()=>o,aR:()=>n});var s=a(95155),r=a(12115),l=a(59434);let o=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("div",{ref:t,className:(0,l.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",a),...r})});o.displayName="Card";let n=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("div",{ref:t,className:(0,l.cn)("flex flex-col space-y-1.5 p-6",a),...r})});n.displayName="CardHeader";let c=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("div",{ref:t,className:(0,l.cn)("text-xl md:text-2xl font-semibold leading-none tracking-tight",a),...r})});c.displayName="CardTitle";let i=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("div",{ref:t,className:(0,l.cn)("text-sm text-muted-foreground",a),...r})});i.displayName="CardDescription";let d=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("div",{ref:t,className:(0,l.cn)("p-6 pt-0",a),...r})});d.displayName="CardContent",r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("div",{ref:t,className:(0,l.cn)("flex items-center p-6 pt-0",a),...r})}).displayName="CardFooter"},68856:(e,t,a)=>{"use strict";a.d(t,{E:()=>l});var s=a(95155),r=a(59434);function l(e){let{className:t,...a}=e;return(0,s.jsx)("div",{className:(0,r.cn)("rounded-md bg-muted",t),...a})}},74848:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>et});var s=a(95155),r=a(12115),l=a(66695),o=a(89829),n=a(31949),c=a(763),i=a(58127),d=a(25299),u=a(50286),m=a(80659),h=a(3401),p=a(94754),f=a(96025),x=a(16238),g=a(94517),y=a(24026),v=a(58227),b=a(93504),w=a(21374),j=a(83540),N=a(59434);let k={light:"",dark:".dark"},D=r.createContext(null);function C(){let e=r.useContext(D);if(!e)throw Error("useChart must be used within a <ChartContainer />");return e}let O=r.forwardRef((e,t)=>{let{id:a,className:l,children:o,config:n,...c}=e,i=r.useId(),d="chart-".concat(a||i.replace(/:/g,""));return(0,s.jsx)(D.Provider,{value:{config:n},children:(0,s.jsxs)("div",{"data-chart":d,ref:t,className:(0,N.cn)("flex aspect-video justify-center text-xs [&_.recharts-cartesian-axis-tick_text]:fill-muted-foreground [&_.recharts-cartesian-grid_line[stroke='#ccc']]:stroke-border/50 [&_.recharts-curve.recharts-tooltip-cursor]:stroke-border [&_.recharts-dot[stroke='#fff']]:stroke-transparent [&_.recharts-layer]:outline-none [&_.recharts-polar-grid_[stroke='#ccc']]:stroke-border [&_.recharts-radial-bar-background-sector]:fill-muted [&_.recharts-rectangle.recharts-tooltip-cursor]:fill-muted [&_.recharts-reference-line_[stroke='#ccc']]:stroke-border [&_.recharts-sector[stroke='#fff']]:stroke-transparent [&_.recharts-sector]:outline-none [&_.recharts-surface]:outline-none",l),...c,children:[(0,s.jsx)(E,{id:d,config:n}),(0,s.jsx)(j.u,{children:o})]})})});O.displayName="Chart";let E=e=>{let{id:t,config:a}=e,r=Object.entries(a).filter(e=>{let[,t]=e;return t.theme||t.color});return r.length?(0,s.jsx)("style",{dangerouslySetInnerHTML:{__html:Object.entries(k).map(e=>{let[a,s]=e;return"\n".concat(s," [data-chart=").concat(t,"] {\n").concat(r.map(e=>{var t;let[s,r]=e,l=(null==(t=r.theme)?void 0:t[a])||r.color;return l?"  --color-".concat(s,": ").concat(l,";"):null}).join("\n"),"\n}\n")}).join("\n")}}):null};g.m;let A=r.forwardRef((e,t)=>{let{active:a,payload:l,className:o,indicator:n="dot",hideLabel:c=!1,hideIndicator:i=!1,label:d,labelFormatter:u,labelClassName:m,formatter:h,color:p,nameKey:f,labelKey:x}=e,{config:g}=C(),y=r.useMemo(()=>{var e;if(c||!(null==l?void 0:l.length))return null;let[t]=l,a="".concat(x||t.dataKey||t.name||"value"),r=_(g,t,a),o=x||"string"!=typeof d?null==r?void 0:r.label:(null==(e=g[d])?void 0:e.label)||d;return u?(0,s.jsx)("div",{className:(0,N.cn)("font-medium",m),children:u(o,l)}):o?(0,s.jsx)("div",{className:(0,N.cn)("font-medium",m),children:o}):null},[d,u,l,c,m,g,x]);if(!a||!(null==l?void 0:l.length))return null;let v=1===l.length&&"dot"!==n;return(0,s.jsxs)("div",{ref:t,className:(0,N.cn)("grid min-w-[8rem] items-start gap-1.5 rounded-lg border border-border/50 bg-background px-2.5 py-1.5 text-xs shadow-xl",o),children:[v?null:y,(0,s.jsx)("div",{className:"grid gap-1.5",children:l.map((e,t)=>{let a="".concat(f||e.name||e.dataKey||"value"),r=_(g,e,a),l=p||e.payload.fill||e.color;return(0,s.jsx)("div",{className:(0,N.cn)("flex w-full flex-wrap items-stretch gap-2 [&>svg]:h-2.5 [&>svg]:w-2.5 [&>svg]:text-muted-foreground","dot"===n&&"items-center"),children:h&&(null==e?void 0:e.value)!==void 0&&e.name?h(e.value,e.name,e,t,e.payload):(0,s.jsxs)(s.Fragment,{children:[(null==r?void 0:r.icon)?(0,s.jsx)(r.icon,{}):!i&&(0,s.jsx)("div",{className:(0,N.cn)("shrink-0 rounded-[2px] border-[--color-border] bg-[--color-bg]",{"h-2.5 w-2.5":"dot"===n,"w-1":"line"===n,"w-0 border-[1.5px] border-dashed bg-transparent":"dashed"===n,"my-0.5":v&&"dashed"===n}),style:{"--color-bg":l,"--color-border":l}}),(0,s.jsxs)("div",{className:(0,N.cn)("flex flex-1 justify-between leading-none",v?"items-end":"items-center"),children:[(0,s.jsxs)("div",{className:"grid gap-1.5",children:[v?y:null,(0,s.jsx)("span",{className:"text-muted-foreground",children:(null==r?void 0:r.label)||e.name})]}),e.value&&(0,s.jsx)("span",{className:"font-mono font-medium tabular-nums text-foreground",children:e.value.toLocaleString()})]})]})},e.dataKey)})})]})});function _(e,t,a){if("object"!=typeof t||null===t)return;let s="payload"in t&&"object"==typeof t.payload&&null!==t.payload?t.payload:void 0,r=a;return a in t&&"string"==typeof t[a]?r=t[a]:s&&a in s&&"string"==typeof s[a]&&(r=s[a]),r in e?e[r]:e[a]}A.displayName="ChartTooltip",y.s,r.forwardRef((e,t)=>{let{className:a,hideIcon:r=!1,payload:l,verticalAlign:o="bottom",nameKey:n}=e,{config:c}=C();return(null==l?void 0:l.length)?(0,s.jsx)("div",{ref:t,className:(0,N.cn)("flex items-center justify-center gap-4","top"===o?"pb-3":"pt-3",a),children:l.map(e=>{let t="".concat(n||e.dataKey||"value"),a=_(c,e,t);return(0,s.jsxs)("div",{className:(0,N.cn)("flex items-center gap-1.5 [&>svg]:h-3 [&>svg]:w-3 [&>svg]:text-muted-foreground"),children:[(null==a?void 0:a.icon)&&!r?(0,s.jsx)(a.icon,{}):(0,s.jsx)("div",{className:"h-2 w-2 shrink-0 rounded-[2px]",style:{backgroundColor:e.color}}),null==a?void 0:a.label]},e.value)})}):null}).displayName="ChartLegend";var T=a(30285),R=a(59409),P=a(46102),L=a(59576),M=a(77694),S=a(97841),I=a(87481),F=a(80644),B=a(70831),U=a(3567),W=a(67690),H=a(20908),Z=a(56499),K=a(73168),J=a(68856);let q=a(91950).ci.filter(e=>"VALIDATION_PROJECT"!==e),V=[{title:"Active Tasks",value:"0",icon:o.A,description:"Tasks currently in progress or to do.",color:"text-blue-500",bgColor:"bg-blue-50",tasks:[]},{title:"Overdue Tasks",value:"0",icon:n.A,description:"Tasks past their due date.",color:"text-red-500",bgColor:"bg-red-50",tasks:[]},{title:"Upcoming Tasks",value:"0",icon:c.A,description:"Tasks due in the next 7 days.",color:"text-yellow-500",bgColor:"bg-yellow-50",tasks:[]},{title:"Completed Today",value:"0",icon:i.A,description:"Tasks marked as done today.",color:"text-green-500",bgColor:"bg-green-50",tasks:[]}],Q={count:{label:"Tasks"},"To Do":{label:"To Do",color:"hsl(var(--chart-1))"},"In Progress":{label:"In Progress",color:"hsl(var(--chart-2))"},Blocked:{label:"Blocked",color:"hsl(var(--chart-3))"},Done:{label:"Done",color:"hsl(var(--chart-4))"},Overdue:{label:"Overdue",color:"hsl(var(--chart-5))"}},z={activeTasks:{label:"Active Tasks",color:"hsl(var(--chart-2))"}},Y=q.reduce((e,t,a)=>(e[t]={label:"".concat(t.replace(/_/g," ")," Rate"),color:"hsl(var(--chart-".concat(a%5+1,"))")},e["".concat(t,"_total")]={label:"".concat(t.replace(/_/g," ")," Total")},e["".concat(t,"_completed")]={label:"".concat(t.replace(/_/g," ")," Completed")},e),{goalRate:{label:"Goal Rate",color:"hsl(var(--muted-foreground))"}}),G={"To Do":"hsl(var(--chart-1))","In Progress":"hsl(var(--chart-2))",Blocked:"hsl(var(--chart-3))",Done:"hsl(var(--chart-4))",Overdue:"hsl(var(--chart-5))"},$=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"dashboard data",a="An unexpected error occurred while fetching ".concat(t,".");if(e&&"object"==typeof e){if("status"in e&&0===e.status?a="Failed to communicate with the server while fetching ".concat(t,". Please check your connection and try again."):e.data&&"object"==typeof e.data&&e.data.message&&"string"==typeof e.data.message?a=e.data.message:e.message&&"string"==typeof e.message&&!e.message.startsWith("PocketBase_ClientResponseError")?a=e.message:e.originalError&&"string"==typeof e.originalError.message?a=e.originalError.message:e.message&&"string"==typeof e.message&&(a=e.message),"status"in e&&0!==e.status){let s=e.status,r=t.includes("tasks")?"tasks":t.includes("employees")?"employees":"data";404===s?a="The '".concat(r,"' collection was not found (404). ").concat(a):403===s&&(a="You do not have permission to view ".concat(r," (403). ").concat(a))}}else"string"==typeof e&&(a=e);return a},X=()=>(0,s.jsxs)(l.Zp,{className:"shadow-md",children:[(0,s.jsxs)(l.aR,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,s.jsx)(J.E,{className:"h-4 w-2/3"}),(0,s.jsx)(J.E,{className:"h-5 w-5 rounded-full"})]}),(0,s.jsxs)(l.Wu,{children:[(0,s.jsx)(J.E,{className:"h-7 w-1/3 mb-2"}),(0,s.jsx)(J.E,{className:"h-3 w-full"})]})]}),ee=()=>(0,s.jsxs)(l.Zp,{className:"shadow-md",children:[(0,s.jsxs)(l.aR,{children:[(0,s.jsx)(J.E,{className:"h-5 w-1/2 mb-1"}),(0,s.jsx)(J.E,{className:"h-4 w-3/4"})]}),(0,s.jsx)(l.Wu,{className:"h-[300px]",children:(0,s.jsx)(J.E,{className:"h-full w-full"})})]});function et(){let{pbClient:e}=(0,L.A)(),{toast:t}=(0,I.dj)(),[a,o]=(0,r.useState)(V),[c,i]=(0,r.useState)([]),[j,N]=(0,r.useState)([]),[k,D]=(0,r.useState)(new Date().getFullYear()),[C,E]=(0,r.useState)([]),[_,J]=(0,r.useState)([]),[et,ea]=(0,r.useState)(!0),[es,er]=(0,r.useState)(null),el=(0,r.useCallback)((e,t)=>{let a=(0,F.o)(new Date),s=(0,B.f)(a,7),r=0,l=0,n=0,c=0,d=[],u=[],m=[],h=[],p={"To Do":0,"In Progress":0,Blocked:0,Done:0,Overdue:0},f={};e.forEach(e=>{let t=e.dueDate?(0,F.o)(new Date(e.dueDate)):null,o="Done"===e.status,i=t&&(0,U.R)(t)&&!(0,W.c)(t)&&!o,x="Overdue"===e.status||i;if("Overdue"===e.status||i?p.Overdue++:e.status&&p.hasOwnProperty(e.status)?p[e.status]++:p["To Do"]++,o||x||"VALIDATION_PROJECT"===e.task_type||!e.assignedTo_text||(f[e.assignedTo_text]=(f[e.assignedTo_text]||0)+1),o){let t=new Date(e.updated?e.updated:e.created);(0,W.c)(t)&&(c++,h.push(e))}else x&&(l++,u.push(e)),x||"In Progress"!==e.status&&"To Do"!==e.status&&"Blocked"!==e.status||(r++,d.push(e)),!x&&t&&t>=a&&t<s&&(n++,m.push(e))}),o([{...V[0],value:r.toString(),tasks:d},{...V[1],value:l.toString(),tasks:u},{...V[2],value:n.toString(),tasks:m},{...V[3],value:c.toString(),tasks:h}]),i(Object.keys(p).map(e=>({status:e,count:p[e]||0,fill:G[e]||"hsl(var(--muted))"})).filter(e=>e.count>0)),N(Object.entries(f).map(e=>{let[t,a]=e;return{employee:t,activeTasks:a}}).sort((e,t)=>t.activeTasks-e.activeTasks));let x={},g={Q1:{},Q2:{},Q3:{},Q4:{}};e.forEach(e=>{if("VALIDATION_PROJECT"===e.task_type||!q.includes(e.task_type))return;let a=e.task_type,s=e.dueDate?(0,F.o)(new Date(e.dueDate)):null;if(s&&(0,H.C)(s)===t&&(x[a]=(x[a]||0)+1,"Done"===e.status)){let e=(0,Z.F)(s),t="Q".concat(e);g[t][a]=(g[t][a]||0)+1}});let y=[],v=(0,K.GP)(new Date(t,0,1),"yy"),b=[25,50,75,100],w={};q.forEach(e=>w[e]=0);for(let e=1;e<=4;e++){let t="Q".concat(e),a={},s={};q.forEach(e=>{var r;let l=(null==(r=g[t])?void 0:r[e])||0;w[e]=(w[e]||0)+l;let o=x[e]||0;a[e]=o>0?parseFloat(((w[e]||0)/o*100).toFixed(1)):0,s[e]={total:o,completed:w[e]||0}}),y.push({quarter:"Q".concat(e," '").concat(v),rates:a,totals:s,goalRate:b[e-1]})}E(y)},[]),eo=(0,r.useCallback)(async(e,a)=>{if(!e)return void ea(!0);ea(!0),er(null);try{let[t,s]=await Promise.all([(0,M.x1)(e,{signal:a}),(0,S.Oc)(e,{signal:a})]);J(t),el(t,k)}catch(r){let e=(null==r?void 0:r.isAbort)===!0||"string"==typeof(null==r?void 0:r.message)&&r.message.toLowerCase().includes("autocancelled"),a=(null==r?void 0:r.status)===0&&!e;if(e)console.warn("Dashboard data fetch request was ".concat((null==r?void 0:r.isAbort)?"aborted":"autocancelled","."),r);else if(a){let e=$(r,"dashboard data");er(e),t({title:"Error Loading Data",description:e,variant:"destructive"}),console.warn("Dashboard data fetch (network error):",e,r)}else{var s;let e=(null==(s=r.message)?void 0:s.toLowerCase().includes("employee"))?"employees":"tasks",a=$(r,e);er(a),t({title:"Error Loading Data",description:a,variant:"destructive"}),console.warn("Error fetching dashboard data (after retries):",a,r)}}finally{ea(!1)}},[t,el,k]);(0,r.useEffect)(()=>{let t=new AbortController;return e?eo(e,t.signal):ea(!0),()=>{t.abort()}},[e,eo]),(0,r.useEffect)(()=>{_.length>0&&el(_,k)},[k,_,el]);let en=new Date().getFullYear();return(0,s.jsx)(P.Bc,{children:(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsx)("h1",{className:"text-2xl md:text-3xl font-headline font-semibold",children:"Dashboard"}),es&&!et?(0,s.jsxs)("div",{className:"flex flex-col items-center justify-center py-10 text-destructive bg-destructive/10 rounded-lg",children:[(0,s.jsx)(n.A,{className:"h-12 w-12"}),(0,s.jsx)("p",{className:"mt-4 text-xl font-semibold",children:"Failed to Load Dashboard Data"}),(0,s.jsx)("p",{className:"text-md mt-1 text-center max-w-md",children:es}),(0,s.jsx)(T.$,{onClick:()=>{e&&eo(e)},className:"mt-6",variant:"destructive",children:"Try Again"})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:et?Array.from({length:4}).map((e,t)=>(0,s.jsx)(X,{},t)):!es&&a.map(e=>(0,s.jsxs)(P.m_,{children:[(0,s.jsx)(P.k$,{asChild:!0,children:(0,s.jsxs)(l.Zp,{className:"shadow-md hover:shadow-lg transition-shadow duration-300",children:[(0,s.jsxs)(l.aR,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,s.jsx)(l.ZB,{className:"text-sm font-medium",children:e.title}),(0,s.jsx)(e.icon,{className:"h-5 w-5 ".concat(e.color)})]}),(0,s.jsxs)(l.Wu,{children:[(0,s.jsx)("div",{className:"text-2xl font-bold",children:e.value}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground",children:e.description})]})]})}),(0,s.jsx)(P.ZI,{className:"max-w-xs w-auto bg-card border shadow-lg rounded-md p-2",side:"bottom",align:"center",children:e.tasks&&e.tasks.length>0?(0,s.jsxs)("div",{className:"text-left",children:[(0,s.jsxs)("p",{className:"font-semibold text-sm mb-1 text-card-foreground",children:[e.title,":"]}),(0,s.jsx)("ul",{className:"list-disc list-inside space-y-0.5 max-h-60 overflow-y-auto",children:e.tasks.map(e=>(0,s.jsxs)("li",{className:"text-xs text-card-foreground truncate",title:e.title,children:[e.title,e.dueDate&&(0,s.jsxs)("span",{className:"text-muted-foreground text-[10px] ml-1",children:[" (Due: ",(0,K.GP)(new Date(e.dueDate),"MM/dd"),")"]})]},e.id))})]}):(0,s.jsx)("p",{className:"text-xs text-muted-foreground",children:"No tasks in this category."})})]},e.title))}),(0,s.jsxs)("div",{className:"grid gap-6 md:grid-cols-2",children:[et?(0,s.jsx)(ee,{}):!es&&(0,s.jsxs)(l.Zp,{className:"shadow-md",children:[(0,s.jsxs)(l.aR,{children:[(0,s.jsxs)(l.ZB,{className:"font-headline flex items-center",children:[(0,s.jsx)(d.A,{className:"mr-2 h-5 w-5 text-primary"}),"Task Status Distribution"]}),(0,s.jsx)(l.BT,{children:"Overview of tasks by their current status."})]}),(0,s.jsx)(l.Wu,{children:c.length>0?(0,s.jsx)(O,{config:Q,className:"h-[300px] w-full",children:(0,s.jsxs)(h.E,{data:c,layout:"vertical",margin:{left:10,right:30},children:[(0,s.jsx)(p.d,{horizontal:!1}),(0,s.jsx)(f.W,{type:"number",dataKey:"count",allowDecimals:!1}),(0,s.jsx)(x.h,{dataKey:"status",type:"category",tickLine:!1,axisLine:!1,width:80}),(0,s.jsx)(g.m,{cursor:{fill:"hsl(var(--muted))"},content:(0,s.jsx)(A,{hideLabel:!0})}),(0,s.jsx)(y.s,{}),(0,s.jsx)(v.y,{dataKey:"count",radius:4})]})}):(0,s.jsx)("div",{className:"h-[300px] flex items-center justify-center text-muted-foreground",children:"No task data available for distribution chart."})})]}),et?(0,s.jsx)(ee,{}):!es&&(0,s.jsxs)(l.Zp,{className:"shadow-md",children:[(0,s.jsxs)(l.aR,{children:[(0,s.jsxs)(l.ZB,{className:"font-headline flex items-center",children:[(0,s.jsx)(u.A,{className:"mr-2 h-5 w-5 text-primary"}),"Active Tasks by Employee"]}),(0,s.jsx)(l.BT,{children:"Breakdown of active non-validation tasks assigned per employee."})]}),(0,s.jsx)(l.Wu,{children:j.length>0?(0,s.jsx)(O,{config:z,className:"h-[300px] w-full",children:(0,s.jsxs)(h.E,{data:j,margin:{top:5,right:20,left:0,bottom:5},children:[(0,s.jsx)(p.d,{strokeDasharray:"3 3",vertical:!1}),(0,s.jsx)(f.W,{dataKey:"employee",type:"category"}),(0,s.jsx)(x.h,{dataKey:"activeTasks",type:"number",allowDecimals:!1}),(0,s.jsx)(g.m,{cursor:{fill:"hsl(var(--muted))"},content:(0,s.jsx)(A,{})}),(0,s.jsx)(v.y,{dataKey:"activeTasks",fill:"var(--color-activeTasks)",radius:[4,4,0,0]})]})}):(0,s.jsx)("div",{className:"h-[300px] flex items-center justify-center text-muted-foreground",children:"No active tasks assigned to employees or employee data not loaded."})})]}),et?(0,s.jsx)("div",{className:"md:col-span-2",children:(0,s.jsx)(ee,{})}):!es&&(0,s.jsxs)(l.Zp,{className:"shadow-md md:col-span-2",children:[(0,s.jsx)(l.aR,{children:(0,s.jsxs)("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center",children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)(l.ZB,{className:"font-headline flex items-center",children:[(0,s.jsx)(m.A,{className:"mr-2 h-5 w-5 text-primary"}),"Quarterly Task Completion Rate (by Type)"]}),(0,s.jsx)(l.BT,{children:"Cumulative completion vs. yearly totals for non-validation tasks."})]}),(0,s.jsxs)(R.l6,{value:k.toString(),onValueChange:e=>D(parseInt(e)),children:[(0,s.jsx)(R.bq,{className:"w-full sm:w-[120px] mt-2 sm:mt-0",children:(0,s.jsx)(R.yv,{placeholder:"Select Year"})}),(0,s.jsx)(R.gC,{children:[en,en-1,en-2].map(e=>(0,s.jsx)(R.eb,{value:e.toString(),children:e},e))})]})]})}),(0,s.jsx)(l.Wu,{children:C.length>0?(0,s.jsx)(O,{config:Y,className:"h-[300px] w-full",children:(0,s.jsxs)(b.b,{data:C,margin:{top:5,right:30,left:0,bottom:5},children:[(0,s.jsx)(p.d,{strokeDasharray:"3 3",vertical:!1}),(0,s.jsx)(f.W,{dataKey:"quarter"}),(0,s.jsx)(x.h,{domain:[0,100],tickFormatter:e=>"".concat(e,"%")}),(0,s.jsx)(g.m,{content:e=>{let{active:t,payload:a,label:r}=e;if(t&&a&&a.length){let e=C.find(e=>e.quarter===r);return e?(0,s.jsxs)("div",{className:"p-2 rounded-md border bg-background shadow-lg text-xs",children:[(0,s.jsx)("p",{className:"font-medium text-sm mb-1",children:r}),q.map(t=>{let a=e.rates[t],r=e.totals[t],l=Y[t];return void 0!==a||r&&0!==r.total?(0,s.jsxs)("p",{style:{color:(null==l?void 0:l.color)||"inherit"},children:[(null==l?void 0:l.label)||t,": ",void 0!==a?"".concat(a,"%"):"N/A",r&&r.total>0&&" (".concat(r.completed,"/").concat(r.total," yearly)"),r&&0===r.total&&" (0/0 yearly)"]},t):null}),(0,s.jsxs)("p",{style:{color:Y.goalRate.color||"inherit"},className:"mt-1",children:["Overall Goal: ",e.goalRate,"%"]})]}):null}return null},cursor:{fill:"hsl(var(--muted))"}}),(0,s.jsx)(y.s,{}),q.map(e=>{var t;return(0,s.jsx)(w.N,{type:"monotone",dataKey:"rates.".concat(e),stroke:"var(--color-".concat(e,")"),strokeWidth:2,dot:{r:4,fill:"var(--color-".concat(e,")")},activeDot:{r:6,fill:"var(--color-".concat(e,")")},name:(null==(t=Y[e])?void 0:t.label)||"".concat(e.replace(/_/g," ")," Rate"),connectNulls:!1},e)}),(0,s.jsx)(w.N,{type:"monotone",dataKey:"goalRate",stroke:Y.goalRate.color,strokeDasharray:"5 5",strokeWidth:2,dot:{r:4,fill:Y.goalRate.color},activeDot:{r:6,fill:Y.goalRate.color},name:"Goal Rate"})]})}):(0,s.jsx)("div",{className:"h-[300px] flex items-center justify-center text-muted-foreground",children:"No task data available for the selected year."})})]})]})]})]})})}},77694:(e,t,a)=>{"use strict";a.d(t,{UT:()=>n,lC:()=>c,vq:()=>i,x1:()=>o});var s=a(30645);let r="tasks",l=e=>({...e,task_type:e.task_type,title:e.title||"",startDate:e.startDate?new Date(e.startDate):void 0,dueDate:e.dueDate?new Date(e.dueDate):void 0,created:new Date(e.created),updated:new Date(e.updated),dependencies:Array.isArray(e.dependencies)?e.dependencies:"string"==typeof e.dependencies&&e.dependencies.startsWith("[")?JSON.parse(e.dependencies):[],isMilestone:"boolean"==typeof e.isMilestone&&e.isMilestone,instrument_subtype:e.instrument_subtype||void 0,method:e.method||void 0}),o=async(e,t)=>{try{let{onRetry:a,signal:o,...n}=t||{},c={sort:"-created",fields:"id,title,task_type,status,priority,startDate,dueDate,assignedTo_text,userId,created,updated,progress,isMilestone,dependencies,instrument_subtype,method",...n};return(await (0,s.b)(()=>e.collection(r).getFullList(c,{signal:o}),{signal:o,context:"fetching tasks list",onRetry:a})).map(l)}catch(e){throw e}},n=async(e,t,a)=>{try{t.has("isMilestone")&&t.set("isMilestone","true"===t.get("isMilestone")?"true":"false");let s=await e.collection(r).create(t,{signal:null==a?void 0:a.signal});return l(s)}catch(e){throw console.error("Failed to create task:",e),e}},c=async(e,t,a,o)=>{try{let{signal:n}=o||{};a instanceof FormData&&a.has("isMilestone")?a.set("isMilestone","true"===a.get("isMilestone")||!0===a.get("isMilestone")?"true":"false"):!(a instanceof FormData)&&a.hasOwnProperty("isMilestone")&&(a.isMilestone=!!a.isMilestone);let c=await (0,s.b)(()=>e.collection(r).update(t,a,{signal:n}),{context:"updating task ".concat(t),signal:n});return l(c)}catch(e){throw console.error("Failed to update task ".concat(t,":"),e),e}},i=async(e,t,a)=>{try{let{signal:l}=a||{};await (0,s.b)(()=>e.collection(r).delete(t,{signal:l}),{context:"deleting task ".concat(t),signal:l})}catch(e){throw console.error("Failed to delete task ".concat(t,":"),e),e}}},86249:(e,t,a)=>{Promise.resolve().then(a.bind(a,74848))},91950:(e,t,a)=>{"use strict";a.d(t,{C3:()=>o,Hi:()=>s,PN:()=>r,ci:()=>n,oe:()=>i,tk:()=>d,xJ:()=>c,y4:()=>l});let s=["To Do","In Progress","Blocked","Done","Overdue"],r=["Low","Medium","High","Urgent"],l=["None","Daily","Weekly","Monthly","Yearly"],o="LabFlow",n=["MDL","SOP","IA","iDOC","oDOC","VALIDATION_PROJECT","VALIDATION_STEP"],c={"Hydra AA":["Mercury by EPA 245.1","Mercury by EPA 7471B & 7470A"],"Hydra II":["Mercury by EPA 245.1","Mercury by EPA 7471B & 7470A"],"PE Optima 5300V":["Metals by EPA 200.7"],"PE Optima 8300":["Metals by EPA 200.7"],"iCAP 7400 DUO":["Metals by EPA 200.7"],"PE Optima 7300V":["Metals by EPA 200.7"],"PE Elan 9000":["Metals by EPA 200.8"],"Agilent 7900":["Metals by EPA 200.8"],"PE NexION 300X":[],"PE NexION 300D":[]},i=Object.keys(c),d=(()=>{let e=[];for(let t=0;t<=16;t++)e.push("BOL50".concat(String(t).padStart(2,"0")));for(let t=18;t<=24;t++)e.push("BOL50".concat(String(t).padStart(2,"0")));for(let t=26;t<=28;t++)e.push("BOL50".concat(String(t).padStart(2,"0")));for(let t=0;t<=2;t++)e.push("BOL55".concat(String(t).padStart(2,"0")));return e})()},97841:(e,t,a)=>{"use strict";a.d(t,{Oc:()=>o,Qu:()=>i,Y$:()=>c,bV:()=>n});var s=a(30645);let r="employees",l=e=>({id:e.id,name:e.name,email:e.email,role:e.role,reportsTo_text:e.reportsTo_text,department_text:e.department_text,userId:e.userId,created:e.created?new Date(e.created):void 0,updated:e.updated?new Date(e.updated):void 0,collectionId:e.collectionId,collectionName:e.collectionName,expand:e.expand}),o=async(e,t)=>{try{let{onRetry:a,signal:o,...n}=t||{},c={sort:"name",fields:"id,name,email,role,department_text,reportsTo_text,userId,created,updated",...n};return(await (0,s.b)(()=>e.collection(r).getFullList(c,{signal:o}),{signal:o,context:"fetching employees list",onRetry:a})).map(l)}catch(e){throw e}},n=async(e,t,a)=>{try{let s=await e.collection(r).create(t,{signal:null==a?void 0:a.signal});return l(s)}catch(e){throw console.error("Failed to create employee:",e),e}},c=async(e,t,a,o)=>{try{let{signal:n}=o||{},c=await (0,s.b)(()=>e.collection(r).update(t,a,{signal:n}),{context:"updating employee ".concat(t),signal:n});return l(c)}catch(e){throw console.error("Failed to update employee ".concat(t,":"),e),e}},i=async(e,t,a)=>{try{let{signal:l}=a||{};await (0,s.b)(()=>e.collection(r).delete(t,{signal:l}),{context:"deleting employee ".concat(t),signal:l})}catch(e){throw console.error("Failed to delete employee ".concat(t,":"),e),e}}}},e=>{var t=t=>e(e.s=t);e.O(0,[383,90,386,977,859,613,580,876,441,303,358],()=>t(86249)),_N_E=e.O()}]);