(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5519],{14636:(e,t,a)=>{"use strict";a.d(t,{AM:()=>d,Wv:()=>i,hl:()=>o});var s=a(95155),r=a(12115),n=a(20547),l=a(59434);let d=n.bL,i=n.l9,o=r.forwardRef((e,t)=>{let{className:a,align:r="center",sideOffset:d=4,...i}=e;return(0,s.jsx)(n.ZL,{children:(0,s.jsx)(n.UC,{ref:t,align:r,sideOffset:d,className:(0,l.cn)("z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",a),...i})})});o.displayName=n.UC.displayName},17313:(e,t,a)=>{"use strict";a.d(t,{Xi:()=>o,j7:()=>i,tU:()=>d});var s=a(95155),r=a(12115),n=a(60704),l=a(59434);let d=n.bL,i=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(n.B8,{ref:t,className:(0,l.cn)("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",a),...r})});i.displayName=n.B8.displayName;let o=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(n.l9,{ref:t,className:(0,l.cn)("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",a),...r})});o.displayName=n.l9.displayName,r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(n.UC,{ref:t,className:(0,l.cn)("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",a),...r})}).displayName=n.UC.displayName},18656:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>ex});var s=a(95155),r=a(12115),n=a(91394),l=a(66695),d=a(59434),i=a(75143);let o=e=>{let{id:t,children:a,className:r}=e,{isOver:n,setNodeRef:l}=(0,i.zM)({id:t});return(0,s.jsx)("div",{className:(0,d.cn)("flex h-full min-h-40 flex-col gap-2 rounded-md border bg-secondary p-2 text-xs shadow-sm outline outline-2 transition-all",n?"outline-primary":"outline-transparent",r),ref:l,children:a})},c=e=>{let{id:t,name:a,index:r,parent:n,children:o,className:c}=e,{attributes:m,listeners:u,setNodeRef:p,transform:x,isDragging:h}=(0,i.PM)({id:t,data:{index:r,parent:n}});return(0,s.jsx)(l.Zp,{className:(0,d.cn)("rounded-md p-3 shadow-sm",h&&"cursor-grabbing",c),style:{transform:x?"translateX(".concat(x.x,"px) translateY(").concat(x.y,"px)"):"none"},...u,...m,ref:p,children:null!=o?o:(0,s.jsx)("p",{className:"m-0 font-medium text-sm",children:a})})},m=e=>{let{children:t,className:a}=e;return(0,s.jsx)("div",{className:(0,d.cn)("flex flex-1 flex-col gap-2",a),children:t})},u=e=>"children"in e?e.children:(0,s.jsxs)("div",{className:(0,d.cn)("flex shrink-0 items-center gap-2",e.className),children:[(0,s.jsx)("div",{className:"h-2 w-2 rounded-full",style:{backgroundColor:e.color}}),(0,s.jsx)("p",{className:"m-0 font-semibold text-sm",children:e.name})]}),p=e=>{let{children:t,onDragEnd:a,className:r}=e,n=(0,i.FR)((0,i.MS)(i.AN,{activationConstraint:{distance:8}}),(0,i.MS)(i.IG,{activationConstraint:{delay:250,tolerance:5}}));return(0,s.jsx)(i.Mp,{sensors:n,collisionDetection:i.Qo,onDragEnd:a,children:(0,s.jsx)("div",{className:(0,d.cn)("grid w-full auto-cols-fr grid-flow-col gap-4",r),children:t})})};var x=a(21206);let h=e=>{let{children:t,className:a}=e;return(0,s.jsx)("div",{className:(0,d.cn)("flex flex-1 flex-col gap-2 p-3",a),children:t})},f=e=>"children"in e?e.children:(0,s.jsxs)("div",{className:(0,d.cn)("flex shrink-0 items-center gap-2 bg-foreground/5 p-3",e.className),children:[(0,s.jsx)("div",{className:"h-2 w-2 rounded-full",style:{backgroundColor:e.color}}),(0,s.jsx)("p",{className:"m-0 font-semibold text-sm",children:e.name})]}),g=e=>{let{id:t,children:a,className:r}=e,{setNodeRef:n,isOver:l}=(0,i.zM)({id:t});return(0,s.jsx)("div",{className:(0,d.cn)("bg-secondary transition-colors",l&&"bg-foreground/10",r),ref:n,children:a})},j=e=>{let{id:t,name:a,index:r,parent:n,children:l,className:o}=e,{attributes:c,listeners:m,setNodeRef:u,transform:p,isDragging:x}=(0,i.PM)({id:t,data:{index:r,parent:n}});return(0,s.jsx)("div",{className:(0,d.cn)("flex cursor-grab items-center gap-2 rounded-md border bg-background p-2 shadow-sm",x&&"cursor-grabbing",o),style:{transform:p?"translateX(".concat(p.x,"px) translateY(").concat(p.y,"px)"):"none"},...m,...c,ref:u,children:null!=l?l:(0,s.jsx)("p",{className:"m-0 font-medium text-sm",children:a})})},b=e=>{let{children:t,onDragEnd:a,className:r}=e;return(0,s.jsx)(i.Mp,{collisionDetection:i.Qo,onDragEnd:a,modifiers:[x.FN],children:(0,s.jsx)("div",{className:(0,d.cn)("flex flex-col",r),children:t})})};var N=a(9091),w=a(22346),v=a(30285),y=a(77223),k=a(50286),C=a(10518),_=a(50172),A=a(31949),S=a(59966),B=a(92560),D=a(34214),F=a(18046),L=a(25318),E=a(54165),R=a(90010),I=a(62523),P=a(85057),z=a(59409),T=a(59576),M=a(97841),U=a(30645);let q=Date.now(),O=e=>({id:e.id,name:e.name,color:e.color,order:e.order}),$=e=>({id:e.id,name:e.name,order:e.order}),K=e=>({id:e.id,card:e.card,name:e.name,completed:e.completed,assignees:e.assignees||[],order:e.order}),V=e=>{var t,a;return{id:e.id,name:e.name,status:e.status,group:e.group,owners:e.owners||[],createdBy:e.createdBy,startAt:new Date(e.startAt?e.startAt:q-6048e5),endAt:e.endAt?new Date(e.endAt):new Date,order:e.order,created:new Date(e.created),updated:new Date(e.updated),steps:(null==(a=e.expand)||null==(t=a["kanban_steps(card)"])?void 0:t.map(K))||[],expand:e.expand}},Z=async(e,t)=>{try{let[a,s,r]=await Promise.all([(0,U.b)(()=>e.collection("kanban_statuses").getFullList({sort:"order"},t),{...t,context:"fetching kanban statuses"}),(0,U.b)(()=>e.collection("kanban_groups").getFullList({sort:"order"},t),{...t,context:"fetching kanban groups"}),(0,U.b)(()=>e.collection("kanban_cards").getFullList({sort:"order",expand:"kanban_steps(card),status,group,owners,createdBy"},t),{...t,context:"fetching kanban cards"})]);return{statuses:a.map(O),groups:s.map($),cards:r.map(V)}}catch(e){if(e.isAbort)throw e;if(console.error("Failed to fetch Kanban board data:",e),404===e.status)throw Error("Could not load the Kanban board because one or more required collections (kanban_statuses, kanban_groups, kanban_cards) were not found. Please check your PocketBase setup.");throw Error("Could not load the Kanban board. Please ensure the required collections exist and have the correct permissions.")}},G=async(e,t)=>{try{let a=await e.collection("kanban_cards").create(t,{expand:"kanban_steps(card),status,group,owners,createdBy"});return V(a)}catch(e){throw console.error("Failed to create Kanban card:",e),e}},J=async(e,t,a)=>{try{let s=await e.collection("kanban_cards").update(t,{status:a},{expand:"kanban_steps(card),status,group,owners,createdBy"});return V(s)}catch(e){throw console.error("Failed to update status for card ".concat(t,":"),e),e}},X=async(e,t)=>{try{let a=await e.collection("kanban_steps").create(t);return K(a)}catch(e){throw console.error("Failed to create Kanban step:",e),e}},Y=async(e,t,a)=>{try{let s=await e.collection("kanban_steps").update(t,a);return K(s)}catch(e){throw console.error("Failed to update step ".concat(t,":"),e),e}},H=async(e,t)=>{try{let a=(await (0,U.b)(()=>e.collection("kanban_steps").getFullList({filter:'card = "'.concat(t,'"')}),{context:"finding steps for card ".concat(t)})).map(t=>(0,U.b)(()=>e.collection("kanban_steps").delete(t.id),{context:"deleting step ".concat(t.id)}));await Promise.all(a),await (0,U.b)(()=>e.collection("kanban_cards").delete(t),{context:"deleting card ".concat(t)})}catch(e){throw console.error("Failed to delete card ".concat(t," and its steps:"),e),e}};var Q=a(47262),W=a(17313),ee=a(14636),et=a(77740),ea=a(75074);let es=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(et.uB,{ref:t,className:(0,d.cn)("flex h-full w-full flex-col overflow-hidden rounded-md bg-popover text-popover-foreground",a),...r})});es.displayName=et.uB.displayName;let er=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsxs)("div",{className:"flex items-center border-b px-3","cmdk-input-wrapper":"",children:[(0,s.jsx)(ea.A,{className:"mr-2 h-4 w-4 shrink-0 opacity-50"}),(0,s.jsx)(et.uB.Input,{ref:t,className:(0,d.cn)("flex h-11 w-full rounded-md bg-transparent py-3 text-sm outline-none placeholder:text-muted-foreground disabled:cursor-not-allowed disabled:opacity-50",a),...r})]})});er.displayName=et.uB.Input.displayName;let en=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(et.uB.List,{ref:t,className:(0,d.cn)("max-h-[300px] overflow-y-auto overflow-x-hidden",a),...r})});en.displayName=et.uB.List.displayName;let el=r.forwardRef((e,t)=>(0,s.jsx)(et.uB.Empty,{ref:t,className:"py-6 text-center text-sm",...e}));el.displayName=et.uB.Empty.displayName;let ed=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(et.uB.Group,{ref:t,className:(0,d.cn)("overflow-hidden p-1 text-foreground [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground",a),...r})});ed.displayName=et.uB.Group.displayName,r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(et.uB.Separator,{ref:t,className:(0,d.cn)("-mx-1 h-px bg-border",a),...r})}).displayName=et.uB.Separator.displayName;let ei=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(et.uB.Item,{ref:t,className:(0,d.cn)("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none aria-selected:bg-accent aria-selected:text-accent-foreground data-[disabled=true]:pointer-events-none data-[disabled=true]:opacity-50",a),...r})});ei.displayName=et.uB.Item.displayName;var eo=a(87481);let ec=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return e.split(" ").map(e=>e[0]).join("")},em=[{id:"status-todo",name:"To Do",color:"#F59E0B",order:1},{id:"status-inprogress",name:"In Progress",color:"#3B82F6",order:2},{id:"status-done",name:"Done",color:"#10B981",order:3}],eu=[{id:"group-general",name:"General Tasks",order:1}],ep=e=>{let{className:t}=e,{setNodeRef:a,isOver:r}=(0,i.zM)({id:"delete-zone"});return(0,s.jsxs)("div",{ref:a,className:(0,d.cn)("flex flex-col items-center justify-center gap-2 rounded-md border-2 border-dashed border-destructive/50 bg-destructive/10 p-4 transition-colors h-full",r&&"bg-destructive/20 border-destructive",t),children:[(0,s.jsx)(y.A,{className:"h-10 w-10 text-destructive"}),(0,s.jsx)("p",{className:"text-destructive font-medium text-center",children:"Drag here to delete"})]})},ex=()=>{let{pbClient:e,user:t}=(0,T.A)(),{toast:a}=(0,eo.dj)(),[l,i]=(0,r.useState)([]),[x,y]=(0,r.useState)([]),[U,q]=(0,r.useState)([]),[O,$]=(0,r.useState)([]),[K,V]=(0,r.useState)(!0),[et,ea]=(0,r.useState)(null),[ex,eh]=(0,r.useState)(!1),[ef,eg]=(0,r.useState)("board"),[ej,eb]=(0,r.useState)(null),[eN,ew]=(0,r.useState)(null),[ev,ey]=(0,r.useState)(""),[ek,eC]=(0,r.useState)([]),[e_,eA]=(0,r.useState)(""),[eS,eB]=(0,r.useState)([]),[eD,eF]=(0,r.useState)(""),eL=(0,r.useCallback)(async(e,t)=>{if(e){V(!0),ea(null);try{let[a,s]=await Promise.all([Z(e,{signal:t}),(0,M.Oc)(e,{signal:t})]),r=a.statuses.length>0?a.statuses:em,n=a.groups.length>0?a.groups:eu;i(r),y(n),q(a.cards),$(s),r.length>0&&eA(r[0].id)}catch(e){(null==e?void 0:e.isAbort)===!0||"string"==typeof(null==e?void 0:e.message)&&e.message.toLowerCase().includes("autocancelled")||(console.error("Failed to fetch Kanban data:",e),ea(e.message||"An unexpected error occurred."),a({title:"Error",description:e.message,variant:"destructive"}))}finally{V(!1)}}},[a]);(0,r.useEffect)(()=>{let t=new AbortController;return e&&eL(e,t.signal),()=>t.abort()},[eL,e]);let eE=async t=>{let{active:s,over:r}=t;if(!r||!e)return;if("delete-zone"===r.id){let e=U.find(e=>e.id===s.id);e&&eb(e);return}let n=r.id.toString().split("-")[0],d=l.find(e=>e.name===n);if(!d||s.id===d.id)return;let i=U.find(e=>e.id===s.id);if(i&&i.status!==d.id){q(e=>e.map(e=>e.id===s.id?{...e,status:d.id}:e));try{await J(e,s.id.toString(),d.id),a({title:"Card Updated",description:'Moved to "'.concat(d.name,'".')})}catch(e){q(e=>e.map(e=>e.id===s.id?i:e)),a({title:"Update Failed",description:e.message,variant:"destructive"})}}},eR=async(t,s)=>{if(!e)return;let r=!s.completed;q(e=>e.map(e=>e.id===t?{...e,steps:e.steps.map(e=>e.id===s.id?{...e,completed:r}:e)}:e));try{await Y(e,s.id,{completed:r})}catch(e){q(e=>e.map(e=>e.id===t&&U.find(e=>e.id===t)||e)),a({title:"Update Failed",description:"Could not update the step.",variant:"destructive"})}},eI=async s=>{if(s.preventDefault(),!ev||!e_||!eN||!t||!e)return;let r=U.filter(e=>e.group===eN.id).reduce((e,t)=>Math.max(t.order,e),0),n={name:ev,status:e_,group:eN.id,createdBy:t.id,order:r+10,owners:ek.length>0?ek:[]};try{let t=await G(e,n);if(eS.length>0){let a=eS.map((a,s)=>X(e,{card:t.id,name:a.name,completed:!1,assignees:a.assigneeIds,order:(s+1)*10}));t.steps=await Promise.all(a)}q(e=>[...e,t]),a({title:"Success",description:'Card "'.concat(t.name,'" created.')}),ez()}catch(e){console.error("Error creating card on page:",e),a({title:"Error Creating Card",description:e.message,variant:"destructive"})}},eP=async()=>{if(!ej||!e)return;let t=[...U];q(e=>e.filter(e=>e.id!==ej.id));try{await H(e,ej.id),a({title:"Card Deleted",description:'"'.concat(ej.name,'" has been removed.')})}catch(e){console.error("Failed to delete card:",e),q(t),a({title:"Delete Failed",description:e.message,variant:"destructive"})}finally{eb(null)}},ez=()=>{eh(!1),ey(""),eC([]),l.length>0&&eA(l[0].id),eB([]),eF(""),ew(null)},eT=e=>{ew(e),eh(!0)},eM=()=>{eD.trim()&&(eB([...eS,{id:"new-step-".concat(Date.now()),name:eD.trim(),completed:!1,assigneeIds:[]}]),eF(""))},eU=e=>{eB(eS.filter(t=>t.id!==e))},eq=(e,t)=>{eB(a=>a.map(a=>{if(a.id===e){let e=a.assigneeIds.includes(t)?a.assigneeIds.filter(e=>e!==t):[...a.assigneeIds,t];return{...a,assigneeIds:e}}return a}))},eO=(0,r.useMemo)(()=>U.reduce((e,t)=>{var a,s;let r=(null==(a=x.find(e=>e.id===t.group))?void 0:a.name)||"Uncategorized",n=(null==(s=l.find(e=>e.id===t.status))?void 0:s.name)||"Uncategorized";return e[r]||(e[r]={}),e[r][n]||(e[r][n]=[]),e[r][n].push(t),e},{}),[U,x,l]),e$=(0,r.useMemo)(()=>U.reduce((e,t)=>{var a;let s=(null==(a=l.find(e=>e.id===t.status))?void 0:a.name)||"Uncategorized";return e[s]||(e[s]=[]),e[s].push(t),e},{}),[U,l]),eK=e=>{var t,a;let r=(null==(t=e.expand)?void 0:t.owners)||[],l=null==(a=e.expand)?void 0:a.createdBy;return(0,s.jsxs)("div",{className:"group relative",children:[(0,s.jsxs)("div",{className:"flex items-start justify-between gap-2",children:[(0,s.jsx)("p",{className:"m-0 flex-1 font-medium text-sm pr-6",children:e.name}),l&&(0,s.jsx)(n.eu,{className:"h-5 w-5 shrink-0 border-2 border-background",title:"Created by: ".concat(l.name),children:(0,s.jsx)(n.q5,{children:ec(l.name)})})]}),e.steps&&e.steps.length>0&&(0,s.jsx)("div",{className:"space-y-1.5 mt-2 ml-2 pl-2 border-l",children:e.steps.map(t=>{let a=O.filter(e=>t.assignees.includes(e.id));return(0,s.jsxs)("div",{className:"flex items-center justify-between gap-2",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(Q.S,{id:"step-".concat(t.id),checked:t.completed,onCheckedChange:()=>eR(e.id,t),className:"h-3 w-3"}),(0,s.jsx)("label",{htmlFor:"step-".concat(t.id),className:"text-xs font-normal leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",children:t.name})]}),a.length>0&&(0,s.jsxs)("div",{className:"flex -space-x-1",children:[a.slice(0,2).map(e=>(0,s.jsx)(n.eu,{className:"h-4 w-4 shrink-0 border border-background",title:"Step assigned to: ".concat(e.name),children:(0,s.jsx)(n.q5,{className:"text-[10px]",children:ec(e.name)})},e.id)),a.length>2&&(0,s.jsx)(n.eu,{className:"h-4 w-4 shrink-0 border border-background",title:"And ".concat(a.length-2," more"),children:(0,s.jsx)(n.q5,{className:"text-[8px]",children:"+".concat(a.length-2)})})]})]},t.id)})}),(0,s.jsxs)("div",{className:"flex items-center justify-between text-muted-foreground text-xs mt-2",children:[(0,s.jsx)("p",{className:"m-0",title:new Date(e.created).toLocaleString(),children:(0,N.m)(new Date(e.created),{addSuffix:!0})}),r.length>0&&(0,s.jsxs)("div",{className:"flex -space-x-2",children:[r.slice(0,2).map(e=>(0,s.jsx)(n.eu,{className:"h-5 w-5 shrink-0 border-2 border-background",title:"Assigned to: ".concat(e.name),children:(0,s.jsx)(n.q5,{className:"text-[10px]",children:ec(e.name)})},e.id)),r.length>2&&(0,s.jsx)(n.eu,{className:"h-5 w-5 shrink-0 border-2 border-background",title:"And ".concat(r.length-2," more"),children:(0,s.jsx)(n.q5,{className:"text-[10px]",children:"+".concat(r.length-2)})})]})]})]})},eV=e=>{var t,a;let{label:r,selectedAssigneeIds:n,onSelectionChange:l,isLoading:i,options:o,className:c}=e,m=0===n.length?"Select ".concat(r,"..."):1===n.length?null!=(a=null==(t=o.find(e=>e.id===n[0]))?void 0:t.name)?a:"1 selected":"".concat(n.length," selected");return(0,s.jsxs)(ee.AM,{children:[(0,s.jsx)(ee.Wv,{asChild:!0,children:(0,s.jsxs)(v.$,{variant:"outline",className:(0,d.cn)("w-full justify-start font-normal",c),disabled:i,children:[(0,s.jsx)(k.A,{className:"mr-2 h-4 w-4"})," ",m]})}),(0,s.jsx)(ee.hl,{className:"w-[var(--radix-popover-trigger-width)] p-0",children:(0,s.jsxs)(es,{children:[(0,s.jsx)(er,{placeholder:"Search ".concat(r,"...")}),(0,s.jsxs)(en,{children:[(0,s.jsx)(el,{children:"No results found."}),(0,s.jsx)(ed,{children:o.map(e=>(0,s.jsxs)(ei,{onSelect:()=>l(e.id),children:[(0,s.jsx)("div",{className:(0,d.cn)("mr-2 flex h-4 w-4 items-center justify-center rounded-sm border border-primary",n.includes(e.id)?"bg-primary text-primary-foreground":"opacity-50 [&_svg]:invisible"),children:(0,s.jsx)(C.A,{className:"h-4 w-4"})}),(0,s.jsx)("span",{children:e.name})]},e.id))})]})]})})]})};return K?(0,s.jsx)("div",{className:"flex h-full items-center justify-center p-4",children:(0,s.jsx)(_.A,{className:"h-8 w-8 animate-spin"})}):!et||l.length&&x.length?l.length&&x.length||K?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"flex justify-end p-4",children:(0,s.jsx)(W.tU,{value:ef,onValueChange:e=>eg(e),children:(0,s.jsxs)(W.j7,{children:[(0,s.jsxs)(W.Xi,{value:"board",children:[(0,s.jsx)(B.A,{className:"mr-2 h-4 w-4"})," Board"]}),(0,s.jsxs)(W.Xi,{value:"list",children:[(0,s.jsx)(D.A,{className:"mr-2 h-4 w-4"})," List"]})]})})}),"board"===ef?(0,s.jsx)(p,{onDragEnd:eE,className:"p-4 pt-0",children:(0,s.jsxs)("div",{className:"grid grid-cols-[200px_1fr_1fr_1fr_200px] grid-rows-[auto_1fr] gap-4 w-full",children:[(0,s.jsx)("div",{className:"font-semibold text-lg p-2 row-start-1",children:"Category"}),l.map(e=>(0,s.jsx)("div",{className:"p-2 row-start-1",children:(0,s.jsx)(u,{name:e.name,color:e.color})},e.name)),(0,s.jsx)("div",{className:"font-semibold text-lg p-2 text-destructive row-start-1",children:"Actions"}),(0,s.jsx)("div",{className:"col-span-5 row-start-1",children:(0,s.jsx)(w.w,{})}),(0,s.jsx)("div",{className:"col-span-1 row-start-2 flex flex-col gap-4",children:x.map(e=>(0,s.jsxs)("div",{className:"p-2 flex-1 flex flex-col min-h-40",children:[(0,s.jsx)("h3",{className:"text-md font-semibold text-foreground sticky top-4",children:e.name}),(0,s.jsxs)(v.$,{variant:"ghost",className:"w-full mt-2 text-muted-foreground justify-start px-0",onClick:()=>eT(e),children:[(0,s.jsx)(F.A,{className:"mr-2 h-4 w-4"})," Add a card"]})]},e.id))}),(0,s.jsx)("div",{className:"col-span-3 row-start-2 flex gap-4",children:l.map(e=>(0,s.jsx)("div",{className:"flex flex-col gap-4 w-full",children:x.map(t=>{var a;return(0,s.jsx)(o,{id:"".concat(e.name,"-").concat(t.name),children:(0,s.jsx)(m,{children:((null==(a=eO[t.name])?void 0:a[e.name])||[]).map((a,r)=>(0,s.jsx)(c,{id:a.id,name:a.name,parent:"".concat(e.name,"-").concat(t.name),index:r,children:eK(a)},a.id))})},"".concat(t.name,"-").concat(e.name))})},e.name))}),(0,s.jsx)("div",{className:"col-span-1 row-start-2",children:(0,s.jsx)(ep,{})})]})}):(0,s.jsx)(b,{onDragEnd:eE,children:l.map(e=>(0,s.jsxs)(g,{id:"".concat(e.name,"-list"),children:[(0,s.jsx)(f,{name:e.name,color:e.color}),(0,s.jsx)(h,{children:(e$[e.name]||[]).map((t,a)=>(0,s.jsx)(j,{id:t.id,name:t.name,parent:"".concat(e.name,"-list"),index:a,children:eK(t)},t.id))})]},e.id))}),(0,s.jsx)(R.Lt,{open:!!ej,onOpenChange:e=>!e&&eb(null),children:(0,s.jsxs)(R.EO,{children:[(0,s.jsxs)(R.wd,{children:[(0,s.jsx)(R.r7,{children:"Are you sure?"}),(0,s.jsxs)(R.$v,{children:['This will permanently delete the card "',null==ej?void 0:ej.name,'" and all its steps. This action cannot be undone.']})]}),(0,s.jsxs)(R.ck,{children:[(0,s.jsx)(R.Zr,{onClick:()=>eb(null),children:"Cancel"}),(0,s.jsx)(R.Rx,{onClick:eP,className:"bg-destructive hover:bg-destructive/90",children:"Delete"})]})]})}),(0,s.jsx)(E.lG,{open:ex,onOpenChange:eh,children:(0,s.jsxs)(E.Cf,{className:"max-w-lg",children:[(0,s.jsxs)(E.c7,{children:[(0,s.jsxs)(E.L3,{children:["Add New Card to ",null==eN?void 0:eN.name]}),(0,s.jsx)(E.rr,{children:"Fill in the details for your new task."})]}),(0,s.jsxs)("form",{onSubmit:eI,children:[(0,s.jsxs)("div",{className:"grid gap-4 py-4",children:[(0,s.jsxs)("div",{className:"grid grid-cols-4 items-center gap-4",children:[(0,s.jsx)(P.J,{htmlFor:"cardName",className:"text-right",children:"Name"}),(0,s.jsx)(I.p,{id:"cardName",name:"cardName",value:ev,onChange:e=>ey(e.target.value),className:"col-span-3",required:!0})]}),(0,s.jsxs)("div",{className:"grid grid-cols-4 items-center gap-4",children:[(0,s.jsx)(P.J,{htmlFor:"assignees",className:"text-right",children:"Owners"}),(0,s.jsx)("div",{className:"col-span-3",children:(0,s.jsx)(eV,{label:"Owners",selectedAssigneeIds:ek,onSelectionChange:e=>eC(t=>t.includes(e)?t.filter(t=>t!==e):[...t,e]),isLoading:K,options:O})})]}),(0,s.jsxs)("div",{className:"grid grid-cols-4 items-center gap-4",children:[(0,s.jsx)(P.J,{htmlFor:"statusId",className:"text-right",children:"Status"}),(0,s.jsxs)(z.l6,{name:"statusId",value:e_,onValueChange:eA,required:!0,children:[(0,s.jsx)(z.bq,{className:"col-span-3",children:(0,s.jsx)(z.yv,{placeholder:"Select a status"})}),(0,s.jsx)(z.gC,{children:l.map(e=>(0,s.jsx)(z.eb,{value:e.id,children:e.name},e.id))})]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-4 items-start gap-4",children:[(0,s.jsx)(P.J,{htmlFor:"newStep",className:"text-right pt-2",children:"Steps"}),(0,s.jsxs)("div",{className:"col-span-3 space-y-2",children:[eS.length>0&&(0,s.jsx)("div",{className:"space-y-2 rounded-md border p-2",children:eS.map(e=>(0,s.jsxs)("div",{className:"flex items-center justify-between text-sm gap-2",children:[(0,s.jsx)("span",{className:"flex-1 truncate",children:e.name}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(eV,{label:"Assignees",selectedAssigneeIds:e.assigneeIds,onSelectionChange:t=>eq(e.id,t),isLoading:K,options:O,className:"h-7 text-xs"}),(0,s.jsx)(v.$,{type:"button",variant:"ghost",size:"icon",className:"h-5 w-5",onClick:()=>eU(e.id),children:(0,s.jsx)(L.A,{className:"h-3 w-3"})})]})]},e.id))}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)(I.p,{id:"newStep",placeholder:"Add a new step...",value:eD,onChange:e=>eF(e.target.value),onKeyDown:e=>{"Enter"===e.key&&(e.preventDefault(),eM())}}),(0,s.jsx)(v.$,{type:"button",onClick:eM,children:"Add"})]})]})]})]}),(0,s.jsxs)(E.Es,{children:[(0,s.jsx)(v.$,{type:"button",variant:"ghost",onClick:ez,children:"Cancel"}),(0,s.jsx)(v.$,{type:"submit",disabled:K,children:"Add Card"})]})]})]})})]}):(0,s.jsxs)("div",{className:"flex flex-col h-full items-center justify-center p-4 text-center",children:[(0,s.jsx)(S.A,{className:"h-12 w-12 text-muted-foreground mb-4"}),(0,s.jsx)("h2",{className:"text-xl font-semibold",children:"Kanban Board Needs Setup"}),(0,s.jsx)("p",{className:"text-muted-foreground mt-2 max-w-md",children:'To get started, please add at least one status (e.g., "To Do", "In Progress") and one group (e.g., "General Tasks") in your PocketBase admin panel for the `kanban_statuses` and `kanban_groups` collections.'}),(0,s.jsx)(v.$,{className:"mt-6",onClick:()=>eL(e,new AbortController().signal),children:"Refresh Data"})]}):(0,s.jsxs)("div",{className:"flex flex-col h-full items-center justify-center p-4 text-center text-destructive",children:[(0,s.jsx)(A.A,{className:"h-12 w-12 mb-4"}),(0,s.jsx)("h2",{className:"text-xl font-semibold",children:"Could Not Load Kanban Board"}),(0,s.jsx)("p",{className:"text-muted-foreground mt-2 max-w-md",children:"There was an issue fetching board data. This might be due to a network issue or incorrect API rules on your PocketBase collections (kanban_statuses, kanban_groups, kanban_cards)."}),(0,s.jsxs)("p",{className:"text-xs mt-2 text-muted-foreground max-w-md",children:["Error: ",et]}),(0,s.jsx)(v.$,{className:"mt-6",onClick:()=>eL(e,new AbortController().signal),children:"Try Again"})]})}},22346:(e,t,a)=>{"use strict";a.d(t,{w:()=>d});var s=a(95155),r=a(12115),n=a(87489),l=a(59434);let d=r.forwardRef((e,t)=>{let{className:a,orientation:r="horizontal",decorative:d=!0,...i}=e;return(0,s.jsx)(n.b,{ref:t,decorative:d,orientation:r,className:(0,l.cn)("shrink-0 bg-border","horizontal"===r?"h-[1px] w-full":"h-full w-[1px]",a),...i})});d.displayName=n.b.displayName},46454:(e,t,a)=>{Promise.resolve().then(a.bind(a,18656))},47262:(e,t,a)=>{"use strict";a.d(t,{S:()=>i});var s=a(95155),r=a(12115),n=a(76981),l=a(10518),d=a(59434);let i=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(n.bL,{ref:t,className:(0,d.cn)("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",a),...r,children:(0,s.jsx)(n.C1,{className:(0,d.cn)("flex items-center justify-center text-current"),children:(0,s.jsx)(l.A,{className:"h-4 w-4"})})})});i.displayName=n.bL.displayName},90010:(e,t,a)=>{"use strict";a.d(t,{$v:()=>h,EO:()=>m,Lt:()=>i,Rx:()=>f,Zr:()=>g,ck:()=>p,r7:()=>x,wd:()=>u});var s=a(95155),r=a(12115),n=a(17649),l=a(59434),d=a(30285);let i=n.bL;n.l9;let o=n.ZL,c=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(n.hJ,{className:(0,l.cn)("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",a),...r,ref:t})});c.displayName=n.hJ.displayName;let m=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsxs)(o,{children:[(0,s.jsx)(c,{}),(0,s.jsx)(n.UC,{ref:t,className:(0,l.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",a),...r})]})});m.displayName=n.UC.displayName;let u=e=>{let{className:t,...a}=e;return(0,s.jsx)("div",{className:(0,l.cn)("flex flex-col space-y-2 text-center sm:text-left",t),...a})};u.displayName="AlertDialogHeader";let p=e=>{let{className:t,...a}=e;return(0,s.jsx)("div",{className:(0,l.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",t),...a})};p.displayName="AlertDialogFooter";let x=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(n.hE,{ref:t,className:(0,l.cn)("text-lg font-semibold",a),...r})});x.displayName=n.hE.displayName;let h=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(n.VY,{ref:t,className:(0,l.cn)("text-sm text-muted-foreground",a),...r})});h.displayName=n.VY.displayName;let f=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(n.rc,{ref:t,className:(0,l.cn)((0,d.r)(),a),...r})});f.displayName=n.rc.displayName;let g=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(n.ZD,{ref:t,className:(0,l.cn)((0,d.r)({variant:"outline"}),"mt-2 sm:mt-0",a),...r})});g.displayName=n.ZD.displayName},91394:(e,t,a)=>{"use strict";a.d(t,{BK:()=>i,eu:()=>d,q5:()=>o});var s=a(95155),r=a(12115),n=a(85977),l=a(59434);let d=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(n.bL,{ref:t,className:(0,l.cn)("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",a),...r})});d.displayName=n.bL.displayName;let i=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(n._V,{ref:t,className:(0,l.cn)("aspect-square h-full w-full",a),...r})});i.displayName=n._V.displayName;let o=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(n.H4,{ref:t,className:(0,l.cn)("flex h-full w-full items-center justify-center rounded-full bg-muted",a),...r})});o.displayName=n.H4.displayName},97841:(e,t,a)=>{"use strict";a.d(t,{Oc:()=>i,Qu:()=>m,Y$:()=>c,bV:()=>o});var s=a(7140),r=a(30645);let n="employees",l=(e,t)=>{if(e instanceof s.fp){var a;if(404===e.status)throw Error("Cannot create item: The '".concat(t,"' collection does not exist. Please create it in your PocketBase admin panel."));if(400===e.status&&(null==(a=e.data)?void 0:a.data)){if(e.data.data.id&&e.data.data.id.message)throw Error("There seems to be a configuration issue with your '".concat(t,"' collection. The server is asking for an 'id', which should be automatically generated. Please check in your PocketBase admin panel that the 'id' field is the default system field and not a required text field you created."));let a=Object.entries(e.data.data).map(e=>{let[t,a]=e;return"".concat(t,": ").concat(a.message)}).join("; ");throw Error("Validation failed. Server says: ".concat(a))}}throw console.error("Failed to create item in ".concat(t,":"),e),e},d=e=>({id:e.id,name:e.name,email:e.email,role:e.role,reportsTo_text:e.reportsTo_text,department_text:e.department_text,userId:e.userId,color:e.color,created:e.created?new Date(e.created):void 0,updated:e.updated?new Date(e.updated):void 0,collectionId:e.collectionId,collectionName:e.collectionName,expand:e.expand}),i=async(e,t)=>{try{let{onRetry:a,signal:s,...l}=t||{},i={sort:"name",fields:"id,name,email,role,department_text,reportsTo_text,userId,color,created,updated",...l};return(await (0,r.b)(()=>e.collection(n).getFullList(i,{signal:s}),{signal:s,context:"fetching employees list",onRetry:a})).map(d)}catch(e){if((null==e?void 0:e.isAbort)===!0||(null==e?void 0:e.message)&&(e.message.toLowerCase().includes("aborted")||e.message.toLowerCase().includes("autocancelled")))throw e;throw console.error("Failed to fetch employees:",e),e}},o=async(e,t,a)=>{try{let s=await e.collection(n).create(t,{signal:null==a?void 0:a.signal});return d(s)}catch(e){throw l(e,n),e}},c=async(e,t,a,s)=>{try{let{signal:l}=s||{},i=await (0,r.b)(()=>e.collection(n).update(t,a,{signal:l}),{context:"updating employee ".concat(t),signal:l});return d(i)}catch(e){throw console.error("Failed to update employee ".concat(t,":"),e),e}},m=async(e,t,a)=>{try{let{signal:s}=a||{};await (0,r.b)(()=>e.collection(n).delete(t,{signal:s}),{context:"deleting employee ".concat(t),signal:s})}catch(e){throw console.error("Failed to delete employee ".concat(t,":"),e),e}}}},e=>{var t=t=>e(e.s=t);e.O(0,[2383,4897,9052,1859,7164,5452,5280,6950,3933,9467,5229,8441,1684,7358],()=>t(46454)),_N_E=e.O()}]);