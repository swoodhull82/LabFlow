(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[867],{21326:(e,t,s)=>{Promise.resolve().then(s.bind(s,96679))},28905:(e,t,s)=>{"use strict";s.d(t,{C:()=>i});var a=s(12115),r=s(6101),n=s(52712),i=e=>{let{present:t,children:s}=e,i=function(e){var t,s;let[r,i]=a.useState(),d=a.useRef({}),o=a.useRef(e),c=a.useRef("none"),[u,m]=(t=e?"mounted":"unmounted",s={mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}},a.useReducer((e,t)=>{let a=s[e][t];return null!=a?a:e},t));return a.useEffect(()=>{let e=l(d.current);c.current="mounted"===u?e:"none"},[u]),(0,n.N)(()=>{let t=d.current,s=o.current;if(s!==e){let a=c.current,r=l(t);e?m("MOUNT"):"none"===r||(null==t?void 0:t.display)==="none"?m("UNMOUNT"):s&&a!==r?m("ANIMATION_OUT"):m("UNMOUNT"),o.current=e}},[e,m]),(0,n.N)(()=>{if(r){var e;let t,s=null!=(e=r.ownerDocument.defaultView)?e:window,a=e=>{let a=l(d.current).includes(e.animationName);if(e.target===r&&a&&(m("ANIMATION_END"),!o.current)){let e=r.style.animationFillMode;r.style.animationFillMode="forwards",t=s.setTimeout(()=>{"forwards"===r.style.animationFillMode&&(r.style.animationFillMode=e)})}},n=e=>{e.target===r&&(c.current=l(d.current))};return r.addEventListener("animationstart",n),r.addEventListener("animationcancel",a),r.addEventListener("animationend",a),()=>{s.clearTimeout(t),r.removeEventListener("animationstart",n),r.removeEventListener("animationcancel",a),r.removeEventListener("animationend",a)}}m("ANIMATION_END")},[r,m]),{isPresent:["mounted","unmountSuspended"].includes(u),ref:a.useCallback(e=>{e&&(d.current=getComputedStyle(e)),i(e)},[])}}(t),d="function"==typeof s?s({present:i.isPresent}):a.Children.only(s),o=(0,r.s)(i.ref,function(e){var t,s;let a=null==(t=Object.getOwnPropertyDescriptor(e.props,"ref"))?void 0:t.get,r=a&&"isReactWarning"in a&&a.isReactWarning;return r?e.ref:(r=(a=null==(s=Object.getOwnPropertyDescriptor(e,"ref"))?void 0:s.get)&&"isReactWarning"in a&&a.isReactWarning)?e.props.ref:e.props.ref||e.ref}(d));return"function"==typeof s||i.isPresent?a.cloneElement(d,{ref:o}):null};function l(e){return(null==e?void 0:e.animationName)||"none"}i.displayName="Presence"},40968:(e,t,s)=>{"use strict";s.d(t,{b:()=>l});var a=s(12115),r=s(63655),n=s(95155),i=a.forwardRef((e,t)=>(0,n.jsx)(r.sG.label,{...e,ref:t,onMouseDown:t=>{var s;t.target.closest("button, input, select, textarea")||(null==(s=e.onMouseDown)||s.call(e,t),!t.defaultPrevented&&t.detail>1&&t.preventDefault())}}));i.displayName="Label";var l=i},50172:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(40157).A)("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},59409:(e,t,s)=>{"use strict";s.d(t,{bq:()=>m,eb:()=>x,gC:()=>h,l6:()=>c,yv:()=>u});var a=s(95155),r=s(12115),n=s(31992),i=s(79556),l=s(77381),d=s(10518),o=s(59434);let c=n.bL;n.YJ;let u=n.WT,m=r.forwardRef((e,t)=>{let{className:s,children:r,...l}=e;return(0,a.jsxs)(n.l9,{ref:t,className:(0,o.cn)("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",s),...l,children:[r,(0,a.jsx)(n.In,{asChild:!0,children:(0,a.jsx)(i.A,{className:"h-4 w-4 opacity-50"})})]})});m.displayName=n.l9.displayName;let p=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(n.PP,{ref:t,className:(0,o.cn)("flex cursor-default items-center justify-center py-1",s),...r,children:(0,a.jsx)(l.A,{className:"h-4 w-4"})})});p.displayName=n.PP.displayName;let f=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(n.wn,{ref:t,className:(0,o.cn)("flex cursor-default items-center justify-center py-1",s),...r,children:(0,a.jsx)(i.A,{className:"h-4 w-4"})})});f.displayName=n.wn.displayName;let h=r.forwardRef((e,t)=>{let{className:s,children:r,position:i="popper",...l}=e;return(0,a.jsx)(n.ZL,{children:(0,a.jsxs)(n.UC,{ref:t,className:(0,o.cn)("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===i&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",s),position:i,...l,children:[(0,a.jsx)(p,{}),(0,a.jsx)(n.LM,{className:(0,o.cn)("p-1","popper"===i&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:r}),(0,a.jsx)(f,{})]})})});h.displayName=n.UC.displayName,r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(n.JU,{ref:t,className:(0,o.cn)("py-1.5 pl-8 pr-2 text-sm font-semibold",s),...r})}).displayName=n.JU.displayName;let x=r.forwardRef((e,t)=>{let{className:s,children:r,...i}=e;return(0,a.jsxs)(n.q7,{ref:t,className:(0,o.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",s),...i,children:[(0,a.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,a.jsx)(n.VF,{children:(0,a.jsx)(d.A,{className:"h-4 w-4"})})}),(0,a.jsx)(n.p4,{children:r})]})});x.displayName=n.q7.displayName,r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(n.wv,{ref:t,className:(0,o.cn)("-mx-1 my-1 h-px bg-muted",s),...r})}).displayName=n.wv.displayName},62523:(e,t,s)=>{"use strict";s.d(t,{p:()=>i});var a=s(95155),r=s(12115),n=s(59434);let i=r.forwardRef((e,t)=>{let{className:s,type:r,...i}=e;return(0,a.jsx)("input",{type:r,className:(0,n.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",s),ref:t,...i})});i.displayName="Input"},66424:(e,t,s)=>{"use strict";s.d(t,{F:()=>l});var a=s(95155),r=s(12115),n=s(47655),i=s(59434);let l=r.forwardRef((e,t)=>{let{className:s,children:r,...l}=e;return(0,a.jsxs)(n.bL,{ref:t,className:(0,i.cn)("relative overflow-hidden",s),...l,children:[(0,a.jsx)(n.LM,{className:"h-full w-full rounded-[inherit]",children:r}),(0,a.jsx)(d,{}),(0,a.jsx)(n.OK,{})]})});l.displayName=n.bL.displayName;let d=r.forwardRef((e,t)=>{let{className:s,orientation:r="vertical",...l}=e;return(0,a.jsx)(n.VM,{ref:t,orientation:r,className:(0,i.cn)("flex touch-none select-none transition-colors","vertical"===r&&"h-full w-2.5 border-l border-l-transparent p-[1px]","horizontal"===r&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",s),...l,children:(0,a.jsx)(n.lr,{className:"relative flex-1 rounded-full bg-border"})})});d.displayName=n.VM.displayName},88539:(e,t,s)=>{"use strict";s.d(t,{T:()=>i});var a=s(95155),r=s(12115),n=s(59434);let i=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("textarea",{className:(0,n.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",s),ref:t,...r})});i.displayName="Textarea"},91950:(e,t,s)=>{"use strict";s.d(t,{C3:()=>i,Hi:()=>a,PN:()=>r,ci:()=>l,oe:()=>o,tk:()=>c,xJ:()=>d,y4:()=>n});let a=["To Do","In Progress","Blocked","Done","Overdue"],r=["Low","Medium","High","Urgent"],n=["None","Daily","Weekly","Monthly","Yearly"],i="LabFlow",l=["MDL","SOP","IA","iDOC","oDOC","VALIDATION_PROJECT","VALIDATION_STEP"],d={"Hydra AA":["Mercury by EPA 245.1","Mercury by EPA 7471B & 7470A"],"Hydra II":["Mercury by EPA 245.1","Mercury by EPA 7471B & 7470A"],"PE Optima 5300V":["Metals by EPA 200.7"],"PE Optima 8300":["Metals by EPA 200.7"],"iCAP 7400 DUO":["Metals by EPA 200.7"],"PE Optima 7300V":["Metals by EPA 200.7"],"PE Elan 9000":["Metals by EPA 200.8"],"Agilent 7900":["Metals by EPA 200.8"],"PE NexION 300X":[],"PE NexION 300D":[]},o=Object.keys(d),c=(()=>{let e=[];for(let t=0;t<=16;t++)e.push("BOL50".concat(String(t).padStart(2,"0")));for(let t=18;t<=24;t++)e.push("BOL50".concat(String(t).padStart(2,"0")));for(let t=26;t<=28;t++)e.push("BOL50".concat(String(t).padStart(2,"0")));for(let t=0;t<=2;t++)e.push("BOL55".concat(String(t).padStart(2,"0")));return e})()},96679:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>_});var a=s(95155),r=s(30285),n=s(66695),i=s(62523),l=s(85057),d=s(88539),o=s(59409),c=s(14636),u=s(85511),m=s(47262),p=s(66424),f=s(50172),h=s(44972),x=s(51920),N=s(31949),g=s(86318);let v=(0,s(40157).A)("CloudUpload",[["path",{d:"M12 13v8",key:"1l5pq0"}],["path",{d:"M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242",key:"1pljnt"}],["path",{d:"m8 17 4-4 4 4",key:"1quai1"}]]);var j=s(59119),y=s(73168),A=s(12115),T=s(35695),b=s(6874),O=s.n(b),I=s(59576),P=s(77694),E=s(97841),S=s(87481),w=s(91950);let D=e=>{let t="Could not load employees for assignment.";if(e&&"object"==typeof e)if("status"in e&&0===e.status)return"Failed to load employees for assignment: Could not connect to the server. Please check your internet connection and try again.";else e.message&&(t=e.message);return t},L=e=>{let t="Could not load tasks for dependency selection.";if(e&&"object"==typeof e)if("status"in e&&0===e.status)return"Failed to load tasks for dependency selection: Could not connect to the server. Please check your internet connection and try again.";else e.message&&(t=e.message);return t},k=e=>{let t=e.get("defaultType");return t&&w.ci.includes(t)?t:w.ci.find(e=>"VALIDATION_PROJECT"!==e&&"VALIDATION_STEP"!==e)||w.ci[0]};function _(){let{pbClient:e,user:t}=(0,I.A)(),s=(0,T.useRouter)(),{toast:b}=(0,S.dj)(),_=(0,T.useSearchParams)(),C=_.get("defaultType"),V=_.get("dependsOnValidationProject"),[M,R]=(0,A.useState)(()=>k(_)),[J,F]=(0,A.useState)(),[q,U]=(0,A.useState)(),[B,W]=(0,A.useState)(""),[z,G]=(0,A.useState)(w.Hi[0]||"To Do"),[H,Z]=(0,A.useState)(w.PN.find(e=>"medium"===e.toLowerCase())||w.PN[0]||"Medium"),[$,Y]=(0,A.useState)(),[K,X]=(0,A.useState)(),[Q,ee]=(0,A.useState)(!1),[et,es]=(0,A.useState)(()=>{let e=k(_);if("VALIDATION_PROJECT"===e||"VALIDATION_STEP"===e)return"None"!==localStorage.getItem("newTaskFormRecurrence")&&localStorage.setItem("newTaskFormRecurrence","None"),"None";let t=localStorage.getItem("newTaskFormRecurrence");return t&&w.y4.includes(t)?t:"Daily"}),[ea,er]=(0,A.useState)(),[en,ei]=(0,A.useState)(null),[el,ed]=(0,A.useState)(!1),[eo,ec]=(0,A.useState)(!1),[eu,em]=(0,A.useState)([]),[ep,ef]=(0,A.useState)(!0),[eh,ex]=(0,A.useState)(null),[eN,eg]=(0,A.useState)([]),[ev,ej]=(0,A.useState)(!0),[ey,eA]=(0,A.useState)(null),[eT,eb]=(0,A.useState)(V?[V]:[]),[eO,eI]=(0,A.useState)(!1),[eP,eE]=(0,A.useState)([]),eS=(0,A.useMemo)(()=>"VALIDATION_PROJECT"===C?w.ci.filter(e=>"VALIDATION_PROJECT"===e):"VALIDATION_STEP"===C&&V?w.ci.filter(e=>"VALIDATION_STEP"===e):w.ci.filter(e=>"VALIDATION_PROJECT"!==e&&"VALIDATION_STEP"!==e),[C,V]);(0,A.useEffect)(()=>{localStorage.setItem("newTaskFormRecurrence",et)},[et]),(0,A.useEffect)(()=>{"VALIDATION_PROJECT"===M||"VALIDATION_STEP"===M?"None"!==et&&es("None"):"None"===et&&es("Daily")},[M,et,es]),(0,A.useEffect)(()=>{"MDL"!==M&&"SOP"!==M?(F(void 0),U(void 0),eE([])):"MDL"===M?(J&&w.xJ[J]?eE(w.xJ[J]):eE([]),J&&w.xJ[J]&&!w.xJ[J].includes(q||"")&&U(void 0)):(U(void 0),eE([])),"VALIDATION_PROJECT"===M&&eo&&$?X($):"VALIDATION_PROJECT"===M&&eo&&!$&&X(void 0),"VALIDATION_STEP"===M?(ec(!1),V||eb([])):"VALIDATION_PROJECT"!==M&&(ec(!1),V||eb([]))},[M,J,eo,$,q,V,F,U,eE,ec,X,eb]);let ew=(0,A.useCallback)(async(e,t)=>{if(!e)return void ef(!1);ef(!0),ex(null);try{let s=await (0,E.Oc)(e,{signal:t});em(s)}catch(s){let e=(null==s?void 0:s.isAbort)===!0||"string"==typeof(null==s?void 0:s.message)&&s.message.toLowerCase().includes("autocancelled"),t=(null==s?void 0:s.status)===0&&!e;if(e)console.warn("Fetch employees for task assignment request was ".concat((null==s?void 0:s.isAbort)?"aborted":"autocancelled","."),s);else if(t){let e=D(s);ex(e),b({title:"Error Loading Employees",description:e,variant:"destructive"}),console.warn("Fetch employees for task assignment (network error):",e,s)}else{let e=D(s);ex(e),b({title:"Error Loading Employees",description:e,variant:"destructive"}),console.warn("Error fetching employees for task assignment (after retries):",e,s)}}finally{ef(!1)}},[b]),eD=(0,A.useCallback)(async(e,t)=>{if(!e)return void ej(!1);ej(!0),eA(null);try{let s=await (0,P.x1)(e,{signal:t});eg(s)}catch(s){let e=(null==s?void 0:s.isAbort)===!0||"string"==typeof(null==s?void 0:s.message)&&s.message.toLowerCase().includes("autocancelled"),t=(null==s?void 0:s.status)===0&&!e;if(e)console.warn("Fetch tasks for dependency selection request was ".concat((null==s?void 0:s.isAbort)?"aborted":"autocancelled","."),s);else if(t){let e=L(s);eA(e),b({title:"Error Loading Tasks for Dependencies",description:e,variant:"destructive"}),console.warn("Fetch tasks for dependency selection (network error):",e,s)}else{let e=L(s);eA(e),b({title:"Error Loading Tasks for Dependencies",description:e,variant:"destructive"}),console.warn("Error fetching tasks for dependency selection (after retries):",e,s)}}finally{ej(!1)}},[b]);(0,A.useEffect)(()=>{let t=new AbortController;return e?(ew(e,t.signal),"VALIDATION_STEP"!==M?eD(e,t.signal):(ej(!1),eg([]))):(ef(!0),ej(!0)),()=>{t.abort()}},[e,ew,eD,M]);let eL=e=>{eb(t=>t.includes(e)?t.filter(t=>t!==e):[...t,e])},ek=async a=>{var r;if(a.preventDefault(),!e||!t)return void b({title:"Error",description:"You must be logged in to create a task.",variant:"destructive"});if(!M)return void b({title:"Validation Error",description:"Task Name is required.",variant:"destructive"});if("MDL"===M&&!J)return void b({title:"Validation Error",description:"Instrument Subtype is required for ".concat(M," tasks."),variant:"destructive"});if("MDL"===M&&J&&(null==(r=w.xJ[J])?void 0:r.length)>0&&!q)return void b({title:"Validation Error",description:"Method is required for the selected ".concat(J,"."),variant:"destructive"});if("SOP"===M&&!J)return void b({title:"Validation Error",description:"Subtype is required for ".concat(M," tasks."),variant:"destructive"});if(!z)return void b({title:"Validation Error",description:"Task status is required.",variant:"destructive"});if(!H)return void b({title:"Validation Error",description:"Task priority is required.",variant:"destructive"});let n="VALIDATION_PROJECT"===M||"VALIDATION_STEP"===M?"None":et;if("VALIDATION_PROJECT"!==M&&"VALIDATION_STEP"!==M&&(!n||!w.y4.includes(n)))return void b({title:"Validation Error",description:"Task recurrence is required for this task type.",variant:"destructive"});if("VALIDATION_PROJECT"===M&&eo&&!$)return void b({title:"Validation Error",description:"Milestone date is required for a Validation milestone.",variant:"destructive"});if(!("VALIDATION_PROJECT"===M&&eo)&&$&&K&&$>K)return void b({title:"Validation Error",description:"Start date must be before or same as due date.",variant:"destructive"});ed(!0);let i=new FormData;if(i.append("task_type",M),i.append("title",M),"MDL"===M&&J?(i.append("instrument_subtype",J),q&&i.append("method",q)):"SOP"===M&&J&&i.append("instrument_subtype",J),B.trim()&&i.append("description",B),i.append("status",z),i.append("priority",H),i.append("recurrence",n),"VALIDATION_PROJECT"===M?i.append("isMilestone",eo.toString()):i.append("isMilestone","false"),eT.length>0&&i.append("dependencies",JSON.stringify(eT)),$&&i.append("startDate",$.toISOString()),K&&i.append("dueDate",K.toISOString()),ea&&i.append("assignedTo_text",ea),i.append("userId",t.id),en)for(let e=0;e<en.length;e++)i.append("attachments",en[e]);try{await (0,P.UT)(e,i),b({title:"Success",description:"New ".concat(M.replace(/_/g," ")," task created successfully!")}),"VALIDATION_PROJECT"===M||"VALIDATION_STEP"===M||V?s.push("/validations"):s.push("/tasks")}catch(t){console.error("Failed to create task (full error object):",t);let e="Failed to create task. Please try again. Ensure 'VALIDATION_STEP' is an allowed value for 'task_type' in your PocketBase collection settings if creating a step.";if(t.data&&"object"==typeof t.data){let s="";t.data.message&&"string"==typeof t.data.message&&(s=t.data.message);let a="";if(t.data.data&&"object"==typeof t.data.data&&Object.keys(t.data.data).length>0&&(a=Object.entries(t.data.data).map(e=>{let[t,s]=e,a=s&&s.message?s.message:"Invalid value";return"".concat(t,": ").concat(a)}).join("; ")),s&&a)e="".concat(s,". Details: ").concat(a);else if(s)e=s;else if(a)e="Validation errors: ".concat(a);else if(Object.keys(t.data).length>0&&e.startsWith("Failed to create task."))try{e="PocketBase error: ".concat(JSON.stringify(t.data),". Ensure 'VALIDATION_STEP' is an allowed value for 'task_type' in your PocketBase collection.")}catch(t){e="PocketBase error: Could not stringify error data. Ensure 'VALIDATION_STEP' is an allowed value for 'task_type' in PocketBase."}}else t.message&&"string"==typeof t.message&&(e=t.message);b({title:"Error Creating Task",description:e,variant:"destructive"})}finally{ed(!1)}},e_=ep||ev&&"VALIDATION_STEP"!==M,eC="Pick a date";if(eC="VALIDATION_PROJECT"===M&&eo?$?"Milestone: ".concat((0,y.GP)($,"PPP")):"Pick Milestone Date":$&&K?"".concat((0,y.GP)($,"PPP")," - ").concat((0,y.GP)(K,"PPP")):$?"".concat((0,y.GP)($,"PPP")," - Select End Date"):"Pick Date Range",!e&&!e_)return(0,a.jsx)("div",{className:"space-y-6 max-w-2xl mx-auto",children:(0,a.jsxs)(n.Zp,{className:"shadow-md",children:[(0,a.jsx)(n.aR,{children:(0,a.jsx)(n.ZB,{className:"font-headline",children:"Initializing Task Creation"})}),(0,a.jsx)(n.Wu,{children:(0,a.jsxs)("div",{className:"flex justify-center items-center py-10",children:[(0,a.jsx)(f.A,{className:"h-8 w-8 animate-spin text-primary"}),(0,a.jsx)("p",{className:"ml-2 text-muted-foreground",children:"Initializing task creation form..."})]})})]})});let eV="VALIDATION_STEP"===M&&!!V;return(0,a.jsxs)("div",{className:"space-y-6 max-w-2xl mx-auto",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("h1",{className:"text-2xl md:text-3xl font-headline font-semibold",children:"VALIDATION_PROJECT"===M?"New Validation Project":eV?"New Step for Validation Project":"Add New Task"}),(0,a.jsx)(r.$,{variant:"outline",asChild:!0,children:(0,a.jsx)(O(),{href:"VALIDATION_PROJECT"===M||eV?"/validations":"/tasks",children:"Cancel"})})]}),(0,a.jsxs)(n.Zp,{className:"shadow-md",children:[(0,a.jsxs)(n.aR,{children:[(0,a.jsx)(n.ZB,{className:"font-headline",children:"Task Details"}),(0,a.jsx)(n.BT,{children:"Fill in the information for the new task."})]}),(0,a.jsx)(n.Wu,{children:(0,a.jsxs)("form",{onSubmit:ek,className:"space-y-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(l.J,{htmlFor:"task_name_select",children:"Task Name"}),(0,a.jsxs)(o.l6,{value:M,onValueChange:e=>{R(e)},disabled:"VALIDATION_PROJECT"===C||"VALIDATION_STEP"===C&&!!V,children:[(0,a.jsx)(o.bq,{id:"task_name_select",children:(0,a.jsx)(o.yv,{placeholder:"Select task name"})}),(0,a.jsx)(o.gC,{children:eS.map(e=>(0,a.jsx)(o.eb,{value:e,children:e.replace(/_/g," ")},e))})]})]}),"MDL"===M&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(l.J,{htmlFor:"instrumentSubtypeMDL",children:"Instrument Subtype"}),(0,a.jsxs)(o.l6,{value:J,onValueChange:e=>{F(e),e&&w.xJ[e]&&!w.xJ[e].includes(q||"")?U(void 0):e||U(void 0),eE(e&&w.xJ[e]||[])},children:[(0,a.jsx)(o.bq,{id:"instrumentSubtypeMDL",children:(0,a.jsx)(o.yv,{placeholder:"Select instrument for MDL"})}),(0,a.jsx)(o.gC,{children:w.oe.map(e=>(0,a.jsx)(o.eb,{value:e,children:e},e))})]})]}),J&&eP.length>0&&(0,a.jsxs)("div",{children:[(0,a.jsx)(l.J,{htmlFor:"methodMDL",children:"Method"}),(0,a.jsxs)(o.l6,{value:q,onValueChange:e=>U(e),children:[(0,a.jsx)(o.bq,{id:"methodMDL",children:(0,a.jsx)(o.yv,{placeholder:"Select method"})}),(0,a.jsx)(o.gC,{children:eP.map(e=>(0,a.jsx)(o.eb,{value:e,children:e},e))})]})]})]}),"SOP"===M&&(0,a.jsxs)("div",{children:[(0,a.jsx)(l.J,{htmlFor:"instrumentSubtypeSOP",children:"SOP Subtype"}),(0,a.jsxs)(o.l6,{value:J,onValueChange:e=>F(e),children:[(0,a.jsx)(o.bq,{id:"instrumentSubtypeSOP",children:(0,a.jsx)(o.yv,{placeholder:"Select SOP subtype"})}),(0,a.jsx)(o.gC,{children:w.tk.map(e=>(0,a.jsx)(o.eb,{value:e,children:e},e))})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(l.J,{htmlFor:"description",children:"Description"}),(0,a.jsx)(d.T,{id:"description",placeholder:"Add any relevant details or instructions...",value:B,onChange:e=>W(e.target.value)})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(l.J,{htmlFor:"status",children:"Status"}),(0,a.jsxs)(o.l6,{value:z,onValueChange:e=>G(e),children:[(0,a.jsx)(o.bq,{id:"status",children:(0,a.jsx)(o.yv,{placeholder:"Select status"})}),(0,a.jsx)(o.gC,{children:w.Hi.map(e=>(0,a.jsx)(o.eb,{value:e,children:e},e))})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(l.J,{htmlFor:"priority",children:"Priority"}),(0,a.jsxs)(o.l6,{value:H,onValueChange:e=>Z(e),children:[(0,a.jsx)(o.bq,{id:"priority",children:(0,a.jsx)(o.yv,{placeholder:"Select priority"})}),(0,a.jsx)(o.gC,{children:w.PN.map(e=>(0,a.jsx)(o.eb,{value:e,children:e},e))})]})]})]}),"VALIDATION_PROJECT"===M&&(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(m.S,{id:"isMilestone",checked:eo,onCheckedChange:e=>ec(!!e)}),(0,a.jsxs)(l.J,{htmlFor:"isMilestone",className:"flex items-center cursor-pointer",children:[(0,a.jsx)(h.A,{className:"mr-2 h-4 w-4 text-muted-foreground"})," Mark as Milestone"]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(l.J,{htmlFor:"dateRangePicker",children:"VALIDATION_PROJECT"===M&&eo?"Milestone Date":"Date Range (Start - Due)"}),(0,a.jsxs)(c.AM,{open:Q,onOpenChange:ee,children:[(0,a.jsx)(c.Wv,{asChild:!0,children:(0,a.jsxs)(r.$,{id:"dateRangePicker",variant:"outline",className:"w-full justify-start text-left font-normal",children:[(0,a.jsx)(x.A,{className:"mr-2 h-4 w-4"}),eC]})}),(0,a.jsx)(c.hl,{className:"w-auto p-0",children:(0,a.jsx)(u.V,{mode:"VALIDATION_PROJECT"===M&&eo?"single":"range",selected:"VALIDATION_PROJECT"===M&&eo?$:{from:$,to:K},onSelect:e=>{"VALIDATION_PROJECT"===M&&eo?(Y(e),X(e)):(Y(null==e?void 0:e.from),X(null==e?void 0:e.to)),e&&("VALIDATION_PROJECT"===M&&eo||null==e||!e.from||(null==e?void 0:e.to))&&ee(!1)},numberOfMonths:"VALIDATION_PROJECT"===M&&eo?1:2,initialFocus:!0})})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:["VALIDATION_PROJECT"!==M&&"VALIDATION_STEP"!==M&&(0,a.jsxs)("div",{children:[(0,a.jsx)(l.J,{htmlFor:"recurrence",children:"Recurrence"}),(0,a.jsxs)(o.l6,{value:et,onValueChange:e=>es(e),children:[(0,a.jsx)(o.bq,{id:"recurrence",children:(0,a.jsx)(o.yv,{placeholder:"Select recurrence"})}),(0,a.jsx)(o.gC,{children:w.y4.map(e=>(0,a.jsx)(o.eb,{value:e,children:e},e))})]})]}),(0,a.jsxs)("div",{className:"VALIDATION_PROJECT"===M||"VALIDATION_STEP"===M||"MDL"===M&&eP.length>0?"md:col-span-2":"",children:[(0,a.jsx)(l.J,{htmlFor:"assignedTo",children:"Assigned To"}),(0,a.jsxs)(o.l6,{onValueChange:e=>er("__NONE__"===e?void 0:e),value:ea||"__NONE__",disabled:ep||!!eh,children:[(0,a.jsx)(o.bq,{id:"assignedTo_text",children:(0,a.jsx)(o.yv,{placeholder:ep?"Loading employees...":eh?"Error loading employees":"Select employee (Optional)"})}),(0,a.jsxs)(o.gC,{children:[(0,a.jsx)(o.eb,{value:"__NONE__",children:"None"}),eu.map(e=>(0,a.jsxs)(o.eb,{value:e.name,children:[e.name," (",e.role,")"]},e.id))]})]}),eh&&!ep&&(0,a.jsxs)("p",{className:"text-sm text-destructive mt-1 flex items-center",children:[(0,a.jsx)(N.A,{className:"h-4 w-4 mr-1"})," ",eh]})]})]}),"VALIDATION_STEP"!==M&&(0,a.jsxs)("div",{children:[(0,a.jsx)(l.J,{htmlFor:"dependencies",children:"Dependencies (Optional)"}),(0,a.jsxs)(c.AM,{open:eO,onOpenChange:eI,children:[(0,a.jsx)(c.Wv,{asChild:!0,children:(0,a.jsxs)(r.$,{variant:"outline",className:"w-full justify-start text-left font-normal",disabled:ev||!!ey,children:[(0,a.jsx)(g.A,{className:"mr-2 h-4 w-4"}),ev?"Loading tasks...":ey?"Error loading tasks":eT.length>0?"".concat(eT.length," selected"):"Select tasks"]})}),(0,a.jsxs)(c.hl,{className:"w-[--radix-popover-trigger-width] p-0",children:[ev?(0,a.jsx)("div",{className:"p-4 text-center text-sm",children:"Loading tasks..."}):ey?(0,a.jsx)("div",{className:"p-4 text-center text-sm text-destructive",children:ey}):0===eN.length?(0,a.jsx)("div",{className:"p-4 text-center text-sm",children:"No tasks available to select as dependencies."}):(0,a.jsx)(p.F,{className:"h-48",children:(0,a.jsx)("div",{className:"p-4 space-y-2",children:eN.map(e=>(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(m.S,{id:"dep-".concat(e.id),checked:eT.includes(e.id),onCheckedChange:()=>eL(e.id),disabled:V===e.id}),(0,a.jsxs)("label",{htmlFor:"dep-".concat(e.id),className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70 truncate",title:e.title,children:[e.title," (",e.task_type.replace(/_/g," "),")"]})]},e.id))})}),(0,a.jsx)("div",{className:"p-2 border-t",children:(0,a.jsx)(r.$,{size:"sm",className:"w-full",onClick:()=>eI(!1),children:"Done"})})]})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(l.J,{htmlFor:"attachments",children:"Attachments"}),(0,a.jsx)("div",{className:"mt-1 flex justify-center px-6 pt-5 pb-6 border-2 border-dashed rounded-md",children:(0,a.jsxs)("div",{className:"space-y-1 text-center",children:[(0,a.jsx)(v,{className:"mx-auto h-12 w-12 text-muted-foreground"}),(0,a.jsxs)("div",{className:"flex text-sm text-muted-foreground",children:[(0,a.jsxs)("label",{htmlFor:"file-upload",className:"relative cursor-pointer rounded-md font-medium text-primary hover:text-primary/80 focus-within:outline-none focus-within:ring-2 focus-within:ring-offset-2 focus-within:ring-ring",children:[(0,a.jsx)("span",{children:"Upload files"}),(0,a.jsx)(i.p,{id:"file-upload",name:"file-upload",type:"file",className:"sr-only",multiple:!0,onChange:e=>{e.target.files&&ei(e.target.files)}})]}),(0,a.jsx)("p",{className:"pl-1",children:"or drag and drop"})]}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"PNG, JPG, PDF, etc. up to 10MB each"}),en&&en.length>0&&(0,a.jsxs)("div",{className:"pt-2 text-sm text-muted-foreground",children:["Selected: ",Array.from(en).map(e=>e.name).join(", ")]})]})})]}),(0,a.jsx)("div",{className:"flex justify-end",children:(0,a.jsxs)(r.$,{type:"submit",disabled:el||e_||ey&&"VALIDATION_STEP"!==M||eh,children:[el?(0,a.jsx)(f.A,{className:"mr-2 h-4 w-4 animate-spin"}):(0,a.jsx)(j.A,{className:"mr-2 h-4 w-4"}),"Save Task"]})})]})})]})]})}}},e=>{var t=t=>e(e.s=t);e.O(0,[383,90,386,977,874,859,767,934,69,876,844,441,303,358],()=>t(21326)),_N_E=e.O()}]);