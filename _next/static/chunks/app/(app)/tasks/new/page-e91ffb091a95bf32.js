(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[867],{21326:(e,t,s)=>{Promise.resolve().then(s.bind(s,96679))},28905:(e,t,s)=>{"use strict";s.d(t,{C:()=>i});var a=s(12115),r=s(6101),n=s(52712),i=e=>{let{present:t,children:s}=e,i=function(e){var t,s;let[r,i]=a.useState(),d=a.useRef({}),o=a.useRef(e),c=a.useRef("none"),[u,m]=(t=e?"mounted":"unmounted",s={mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}},a.useReducer((e,t)=>{let a=s[e][t];return null!=a?a:e},t));return a.useEffect(()=>{let e=l(d.current);c.current="mounted"===u?e:"none"},[u]),(0,n.N)(()=>{let t=d.current,s=o.current;if(s!==e){let a=c.current,r=l(t);e?m("MOUNT"):"none"===r||(null==t?void 0:t.display)==="none"?m("UNMOUNT"):s&&a!==r?m("ANIMATION_OUT"):m("UNMOUNT"),o.current=e}},[e,m]),(0,n.N)(()=>{if(r){var e;let t,s=null!=(e=r.ownerDocument.defaultView)?e:window,a=e=>{let a=l(d.current).includes(e.animationName);if(e.target===r&&a&&(m("ANIMATION_END"),!o.current)){let e=r.style.animationFillMode;r.style.animationFillMode="forwards",t=s.setTimeout(()=>{"forwards"===r.style.animationFillMode&&(r.style.animationFillMode=e)})}},n=e=>{e.target===r&&(c.current=l(d.current))};return r.addEventListener("animationstart",n),r.addEventListener("animationcancel",a),r.addEventListener("animationend",a),()=>{s.clearTimeout(t),r.removeEventListener("animationstart",n),r.removeEventListener("animationcancel",a),r.removeEventListener("animationend",a)}}m("ANIMATION_END")},[r,m]),{isPresent:["mounted","unmountSuspended"].includes(u),ref:a.useCallback(e=>{e&&(d.current=getComputedStyle(e)),i(e)},[])}}(t),d="function"==typeof s?s({present:i.isPresent}):a.Children.only(s),o=(0,r.s)(i.ref,function(e){var t,s;let a=null==(t=Object.getOwnPropertyDescriptor(e.props,"ref"))?void 0:t.get,r=a&&"isReactWarning"in a&&a.isReactWarning;return r?e.ref:(r=(a=null==(s=Object.getOwnPropertyDescriptor(e,"ref"))?void 0:s.get)&&"isReactWarning"in a&&a.isReactWarning)?e.props.ref:e.props.ref||e.ref}(d));return"function"==typeof s||i.isPresent?a.cloneElement(d,{ref:o}):null};function l(e){return(null==e?void 0:e.animationName)||"none"}i.displayName="Presence"},47262:(e,t,s)=>{"use strict";s.d(t,{S:()=>d});var a=s(95155),r=s(12115),n=s(76981),i=s(10518),l=s(59434);let d=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(n.bL,{ref:t,className:(0,l.cn)("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",s),...r,children:(0,a.jsx)(n.C1,{className:(0,l.cn)("flex items-center justify-center text-current"),children:(0,a.jsx)(i.A,{className:"h-4 w-4"})})})});d.displayName=n.bL.displayName},62523:(e,t,s)=>{"use strict";s.d(t,{p:()=>i});var a=s(95155),r=s(12115),n=s(59434);let i=r.forwardRef((e,t)=>{let{className:s,type:r,...i}=e;return(0,a.jsx)("input",{type:r,className:(0,n.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",s),ref:t,...i})});i.displayName="Input"},66424:(e,t,s)=>{"use strict";s.d(t,{F:()=>l});var a=s(95155),r=s(12115),n=s(47655),i=s(59434);let l=r.forwardRef((e,t)=>{let{className:s,children:r,...l}=e;return(0,a.jsxs)(n.bL,{ref:t,className:(0,i.cn)("relative overflow-hidden",s),...l,children:[(0,a.jsx)(n.LM,{className:"h-full w-full rounded-[inherit]",children:r}),(0,a.jsx)(d,{}),(0,a.jsx)(n.OK,{})]})});l.displayName=n.bL.displayName;let d=r.forwardRef((e,t)=>{let{className:s,orientation:r="vertical",...l}=e;return(0,a.jsx)(n.VM,{ref:t,orientation:r,className:(0,i.cn)("flex touch-none select-none transition-colors","vertical"===r&&"h-full w-2.5 border-l border-l-transparent p-[1px]","horizontal"===r&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",s),...l,children:(0,a.jsx)(n.lr,{className:"relative flex-1 rounded-full bg-border"})})});d.displayName=n.VM.displayName},85511:(e,t,s)=>{"use strict";s.d(t,{V:()=>o});var a=s(95155);s(12115);var r=s(965),n=s(73158),i=s(86374),l=s(59434),d=s(30285);function o(e){let{className:t,classNames:s,showOutsideDays:o=!0,...c}=e;return(0,a.jsx)(i.hv,{showOutsideDays:o,className:(0,l.cn)("p-3",t),classNames:{months:"flex flex-col sm:flex-row space-y-4 sm:space-x-4 sm:space-y-0",month:"space-y-4",caption:"flex justify-center pt-1 relative items-center",caption_label:"text-sm font-medium",nav:"space-x-1 flex items-center",nav_button:(0,l.cn)((0,d.r)({variant:"outline"}),"h-7 w-7 bg-transparent p-0 opacity-50 hover:opacity-100"),nav_button_previous:"absolute left-1",nav_button_next:"absolute right-1",table:"w-full border-collapse space-y-1",head_row:"flex",head_cell:"text-muted-foreground rounded-md w-9 font-normal text-[0.8rem]",row:"flex w-full mt-2",cell:"h-9 w-9 text-center text-sm p-0 relative [&:has([aria-selected].day-range-end)]:rounded-r-md [&:has([aria-selected].day-outside)]:bg-accent/50 [&:has([aria-selected])]:bg-accent first:[&:has([aria-selected])]:rounded-l-md last:[&:has([aria-selected])]:rounded-r-md focus-within:relative focus-within:z-20",day:(0,l.cn)((0,d.r)({variant:"ghost"}),"h-9 w-9 p-0 font-normal aria-selected:opacity-100"),day_range_end:"day-range-end",day_selected:"bg-primary text-primary-foreground hover:bg-primary hover:text-primary-foreground focus:bg-primary focus:text-primary-foreground",day_today:"bg-accent text-accent-foreground",day_outside:"day-outside text-muted-foreground aria-selected:bg-accent/50 aria-selected:text-muted-foreground",day_disabled:"text-muted-foreground opacity-50",day_range_middle:"aria-selected:bg-accent aria-selected:text-accent-foreground",day_hidden:"invisible",...s},components:{IconLeft:e=>{let{className:t,...s}=e;return(0,a.jsx)(r.A,{className:(0,l.cn)("h-4 w-4",t),...s})},IconRight:e=>{let{className:t,...s}=e;return(0,a.jsx)(n.A,{className:(0,l.cn)("h-4 w-4",t),...s})}},...c})}o.displayName="Calendar"},88539:(e,t,s)=>{"use strict";s.d(t,{T:()=>i});var a=s(95155),r=s(12115),n=s(59434);let i=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("textarea",{className:(0,n.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",s),ref:t,...r})});i.displayName="Textarea"},96679:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>E});var a=s(95155),r=s(30285),n=s(66695),i=s(62523),l=s(85057),d=s(88539),o=s(59409),c=s(14636),u=s(85511),m=s(47262),p=s(66424),h=s(50172),x=s(44972),f=s(51920),g=s(31949),v=s(86318);let y=(0,s(40157).A)("CloudUpload",[["path",{d:"M12 13v8",key:"1l5pq0"}],["path",{d:"M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242",key:"1pljnt"}],["path",{d:"m8 17 4-4 4 4",key:"1quai1"}]]);var j=s(59119),b=s(73168),N=s(12115),w=s(35695),k=s(6874),S=s.n(k),C=s(59576),_=s(77694),O=s(97841),T=s(87481),F=s(91950);let A=e=>{let t="Could not load employees for assignment.";if(e&&"object"==typeof e)if("status"in e&&0===e.status)return"Failed to load employees for assignment: Could not connect to the server. Please check your internet connection and try again.";else e.message&&(t=e.message);return t},D=e=>{let t="Could not load tasks for dependency selection.";if(e&&"object"==typeof e)if("status"in e&&0===e.status)return"Failed to load tasks for dependency selection: Could not connect to the server. Please check your internet connection and try again.";else e.message&&(t=e.message);return t};function E(){let{pbClient:e,user:t}=(0,C.A)(),s=(0,w.useRouter)(),{toast:k}=(0,T.dj)(),[E,M]=(0,N.useState)(F.ho[0]||""),[P,L]=(0,N.useState)(),[I,V]=(0,N.useState)(""),[R,q]=(0,N.useState)(F.Hi[0]||"To Do"),[J,U]=(0,N.useState)(F.PN.find(e=>"medium"===e.toLowerCase())||F.PN[0]||"Medium"),[W,$]=(0,N.useState)(),[B,z]=(0,N.useState)(),[G,Z]=(0,N.useState)(F.y4.find(e=>"none"===e.toLowerCase())||F.y4[0]||"None"),[H,Y]=(0,N.useState)(),[K,Q]=(0,N.useState)(null),[X,ee]=(0,N.useState)(!1),[et,es]=(0,N.useState)(!1),[ea,er]=(0,N.useState)([]),[en,ei]=(0,N.useState)(!0),[el,ed]=(0,N.useState)(null),[eo,ec]=(0,N.useState)([]),[eu,em]=(0,N.useState)(!0),[ep,eh]=(0,N.useState)(null),[ex,ef]=(0,N.useState)([]),[eg,ev]=(0,N.useState)(!1),ey=(0,N.useCallback)(async(e,t)=>{if(!e)return void ei(!1);ei(!0),ed(null);try{let s=await (0,O.Oc)(e,{signal:t});er(s)}catch(s){let e=(null==s?void 0:s.isAbort)===!0||"string"==typeof(null==s?void 0:s.message)&&s.message.toLowerCase().includes("autocancelled"),t=(null==s?void 0:s.status)===0&&!e;if(e)console.warn("Fetch employees for task assignment request was ".concat((null==s?void 0:s.isAbort)?"aborted":"autocancelled","."),s);else if(t){let e=A(s);ed(e),k({title:"Error Loading Employees",description:e,variant:"destructive"}),console.warn("Fetch employees for task assignment (network error):",e,s)}else{let e=A(s);ed(e),k({title:"Error Loading Employees",description:e,variant:"destructive"}),console.warn("Error fetching employees for task assignment (after retries):",e,s)}}finally{ei(!1)}},[k]),ej=(0,N.useCallback)(async(e,t)=>{if(!e)return void em(!1);em(!0),eh(null);try{let s=await (0,_.x1)(e,{signal:t});ec(s)}catch(s){let e=(null==s?void 0:s.isAbort)===!0||"string"==typeof(null==s?void 0:s.message)&&s.message.toLowerCase().includes("autocancelled"),t=(null==s?void 0:s.status)===0&&!e;if(e)console.warn("Fetch tasks for dependency selection request was ".concat((null==s?void 0:s.isAbort)?"aborted":"autocancelled","."),s);else if(t){let e=D(s);eh(e),k({title:"Error Loading Tasks for Dependencies",description:e,variant:"destructive"}),console.warn("Fetch tasks for dependency selection (network error):",e,s)}else{let e=D(s);eh(e),k({title:"Error Loading Tasks for Dependencies",description:e,variant:"destructive"}),console.warn("Error fetching tasks for dependency selection (after retries):",e,s)}}finally{em(!1)}},[k]);(0,N.useEffect)(()=>{let t=new AbortController;return e?(ey(e,t.signal),ej(e,t.signal)):(ei(!0),em(!0)),()=>{t.abort()}},[e,ey,ej]),(0,N.useEffect)(()=>{et&&W&&z(W),"MDL"!==E&&"SOP"!==E&&L(void 0)},[et,W,E]);let eb=e=>{ef(t=>t.includes(e)?t.filter(t=>t!==e):[...t,e])},eN=async a=>{if(a.preventDefault(),!e||!t)return void k({title:"Error",description:"You must be logged in to create a task.",variant:"destructive"});if(!E.trim())return void k({title:"Validation Error",description:"Task title is required.",variant:"destructive"});if(("MDL"===E||"SOP"===E)&&!P)return void k({title:"Validation Error",description:"Subtype is required for ".concat(E," tasks."),variant:"destructive"});if(!R)return void k({title:"Validation Error",description:"Task status is required.",variant:"destructive"});if(!J)return void k({title:"Validation Error",description:"Task priority is required.",variant:"destructive"});if(!G)return void k({title:"Validation Error",description:"Task recurrence is required.",variant:"destructive"});if(et&&!W)return void k({title:"Validation Error",description:"Milestone date (Start Date) is required for a milestone.",variant:"destructive"});ee(!0);let r=new FormData;if(r.append("title",E),("MDL"===E||"SOP"===E)&&P&&r.append("instrument_subtype",P),r.append("description",I),r.append("status",R),r.append("priority",J),r.append("isMilestone",et.toString()),W?(r.append("startDate",W.toISOString()),et?r.append("dueDate",W.toISOString()):B&&r.append("dueDate",B.toISOString())):B&&!et&&r.append("dueDate",B.toISOString()),r.append("recurrence",G),H&&r.append("assignedTo_text",H),r.append("userId",t.id),ex.length>0&&r.append("dependencies",JSON.stringify(ex)),K)for(let e=0;e<K.length;e++)r.append("attachments",K[e]);try{await (0,_.UT)(e,r),k({title:"Success",description:"New task created successfully!"}),s.push("/tasks")}catch(t){console.error("Failed to create task (full error object):",t);let e="Failed to create task. Please try again.";if(t.data&&"object"==typeof t.data){let s="";t.data.message&&"string"==typeof t.data.message&&(s=t.data.message);let a="";if(t.data.data&&"object"==typeof t.data.data&&Object.keys(t.data.data).length>0&&(a=Object.entries(t.data.data).map(e=>{let[t,s]=e,a=s&&s.message?s.message:"Invalid value";return"".concat(t,": ").concat(a)}).join("; ")),s&&a)e="".concat(s,". Details: ").concat(a);else if(s)e=s;else if(a)e="Validation errors: ".concat(a);else if(Object.keys(t.data).length>0&&"Failed to create task. Please try again."===e)try{e="PocketBase error: ".concat(JSON.stringify(t.data))}catch(t){e="PocketBase error: Could not stringify error data."}}else t.message&&"string"==typeof t.message&&(e=t.message);k({title:"Error Creating Task",description:e,variant:"destructive"})}finally{ee(!1)}},ew=en||eu;return e||ew?(0,a.jsxs)("div",{className:"space-y-6 max-w-2xl mx-auto",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("h1",{className:"text-2xl md:text-3xl font-headline font-semibold",children:"Add New Task"}),(0,a.jsx)(r.$,{variant:"outline",asChild:!0,children:(0,a.jsx)(S(),{href:"/tasks",children:"Cancel"})})]}),(0,a.jsxs)(n.Zp,{className:"shadow-md",children:[(0,a.jsxs)(n.aR,{children:[(0,a.jsx)(n.ZB,{className:"font-headline",children:"Task Details"}),(0,a.jsx)(n.BT,{children:"Fill in the information for the new task."})]}),(0,a.jsx)(n.Wu,{children:(0,a.jsxs)("form",{onSubmit:eN,className:"space-y-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(l.J,{htmlFor:"title",children:"Task Type"}),(0,a.jsxs)(o.l6,{value:E,onValueChange:e=>{M(e),L(void 0)},children:[(0,a.jsx)(o.bq,{id:"title",children:(0,a.jsx)(o.yv,{placeholder:"Select task type"})}),(0,a.jsx)(o.gC,{children:F.ho.map(e=>(0,a.jsx)(o.eb,{value:e,children:e},e))})]})]}),"MDL"===E&&(0,a.jsxs)("div",{children:[(0,a.jsx)(l.J,{htmlFor:"instrumentSubtype",children:"Instrument Subtype"}),(0,a.jsxs)(o.l6,{value:P,onValueChange:e=>L(e),children:[(0,a.jsx)(o.bq,{id:"instrumentSubtype",children:(0,a.jsx)(o.yv,{placeholder:"Select instrument for MDL"})}),(0,a.jsx)(o.gC,{children:F.oe.map(e=>(0,a.jsx)(o.eb,{value:e,children:e},e))})]})]}),"SOP"===E&&(0,a.jsxs)("div",{children:[(0,a.jsx)(l.J,{htmlFor:"sopSubtype",children:"SOP Subtype"}),(0,a.jsxs)(o.l6,{value:P,onValueChange:e=>L(e),children:[(0,a.jsx)(o.bq,{id:"sopSubtype",children:(0,a.jsx)(o.yv,{placeholder:"Select SOP subtype"})}),(0,a.jsx)(o.gC,{children:F.tk.map(e=>(0,a.jsx)(o.eb,{value:e,children:e},e))})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(l.J,{htmlFor:"description",children:"Description"}),(0,a.jsx)(d.T,{id:"description",placeholder:"Add any relevant details or instructions...",value:I,onChange:e=>V(e.target.value)})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(l.J,{htmlFor:"status",children:"Status"}),(0,a.jsxs)(o.l6,{value:R,onValueChange:e=>q(e),children:[(0,a.jsx)(o.bq,{id:"status",children:(0,a.jsx)(o.yv,{placeholder:"Select status"})}),(0,a.jsx)(o.gC,{children:F.Hi.map(e=>(0,a.jsx)(o.eb,{value:e,children:e},e))})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(l.J,{htmlFor:"priority",children:"Priority"}),(0,a.jsxs)(o.l6,{value:J,onValueChange:e=>U(e),children:[(0,a.jsx)(o.bq,{id:"priority",children:(0,a.jsx)(o.yv,{placeholder:"Select priority"})}),(0,a.jsx)(o.gC,{children:F.PN.map(e=>(0,a.jsx)(o.eb,{value:e,children:e},e))})]})]})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(m.S,{id:"isMilestone",checked:et,onCheckedChange:e=>es(!!e)}),(0,a.jsxs)(l.J,{htmlFor:"isMilestone",className:"flex items-center cursor-pointer",children:[(0,a.jsx)(x.A,{className:"mr-2 h-4 w-4 text-muted-foreground"})," Mark as Milestone"]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(l.J,{htmlFor:"startDate",children:et?"Milestone Date":"Start Date"}),(0,a.jsxs)(c.AM,{children:[(0,a.jsx)(c.Wv,{asChild:!0,children:(0,a.jsxs)(r.$,{variant:"outline",className:"w-full justify-start text-left font-normal",children:[(0,a.jsx)(f.A,{className:"mr-2 h-4 w-4"}),W?(0,b.GP)(W,"PPP"):(0,a.jsx)("span",{children:"Pick a date"})]})}),(0,a.jsx)(c.hl,{className:"w-auto p-0",children:(0,a.jsx)(u.V,{mode:"single",selected:W,onSelect:$,initialFocus:!0})})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(l.J,{htmlFor:"dueDate",children:"Due Date"}),(0,a.jsxs)(c.AM,{children:[(0,a.jsx)(c.Wv,{asChild:!0,children:(0,a.jsxs)(r.$,{variant:"outline",className:"w-full justify-start text-left font-normal",disabled:et,children:[(0,a.jsx)(f.A,{className:"mr-2 h-4 w-4"}),B?(0,b.GP)(B,"PPP"):(0,a.jsx)("span",{children:"Pick a date"})]})}),(0,a.jsx)(c.hl,{className:"w-auto p-0",children:(0,a.jsx)(u.V,{mode:"single",selected:B,onSelect:z,disabled:et,initialFocus:!0})})]}),et&&(0,a.jsx)("p",{className:"text-xs text-muted-foreground mt-1",children:"Due date matches milestone date."})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(l.J,{htmlFor:"recurrence",children:"Recurrence"}),(0,a.jsxs)(o.l6,{value:G,onValueChange:e=>Z(e),children:[(0,a.jsx)(o.bq,{id:"recurrence",children:(0,a.jsx)(o.yv,{placeholder:"Select recurrence"})}),(0,a.jsx)(o.gC,{children:F.y4.map(e=>(0,a.jsx)(o.eb,{value:e,children:e},e))})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(l.J,{htmlFor:"assignedTo",children:"Assigned To"}),(0,a.jsxs)(o.l6,{onValueChange:e=>Y("__NONE__"===e?void 0:e),value:H||"__NONE__",disabled:en||!!el,children:[(0,a.jsx)(o.bq,{id:"assignedTo_text",children:(0,a.jsx)(o.yv,{placeholder:en?"Loading employees...":el?"Error loading employees":"Select employee (Optional)"})}),(0,a.jsxs)(o.gC,{children:[(0,a.jsx)(o.eb,{value:"__NONE__",children:"None"}),ea.map(e=>(0,a.jsxs)(o.eb,{value:e.name,children:[e.name," (",e.role,")"]},e.id))]})]}),el&&!en&&(0,a.jsxs)("p",{className:"text-sm text-destructive mt-1 flex items-center",children:[(0,a.jsx)(g.A,{className:"h-4 w-4 mr-1"})," ",el]})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(l.J,{htmlFor:"dependencies",children:"Dependencies (Optional)"}),(0,a.jsxs)(c.AM,{open:eg,onOpenChange:ev,children:[(0,a.jsx)(c.Wv,{asChild:!0,children:(0,a.jsxs)(r.$,{variant:"outline",className:"w-full justify-start text-left font-normal",disabled:eu||!!ep,children:[(0,a.jsx)(v.A,{className:"mr-2 h-4 w-4"}),eu?"Loading tasks...":ep?"Error loading tasks":ex.length>0?"".concat(ex.length," selected"):"Select tasks"]})}),(0,a.jsxs)(c.hl,{className:"w-[--radix-popover-trigger-width] p-0",children:[eu?(0,a.jsx)("div",{className:"p-4 text-center text-sm",children:"Loading tasks..."}):ep?(0,a.jsx)("div",{className:"p-4 text-center text-sm text-destructive",children:ep}):0===eo.length?(0,a.jsx)("div",{className:"p-4 text-center text-sm",children:"No other tasks available."}):(0,a.jsx)(p.F,{className:"h-48",children:(0,a.jsx)("div",{className:"p-4 space-y-2",children:eo.map(e=>(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(m.S,{id:"dep-".concat(e.id),checked:ex.includes(e.id),onCheckedChange:()=>eb(e.id)}),(0,a.jsx)("label",{htmlFor:"dep-".concat(e.id),className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70 truncate",title:e.title,children:e.title})]},e.id))})}),(0,a.jsx)("div",{className:"p-2 border-t",children:(0,a.jsx)(r.$,{size:"sm",className:"w-full",onClick:()=>ev(!1),children:"Done"})})]})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(l.J,{htmlFor:"attachments",children:"Attachments"}),(0,a.jsx)("div",{className:"mt-1 flex justify-center px-6 pt-5 pb-6 border-2 border-dashed rounded-md",children:(0,a.jsxs)("div",{className:"space-y-1 text-center",children:[(0,a.jsx)(y,{className:"mx-auto h-12 w-12 text-muted-foreground"}),(0,a.jsxs)("div",{className:"flex text-sm text-muted-foreground",children:[(0,a.jsxs)("label",{htmlFor:"file-upload",className:"relative cursor-pointer rounded-md font-medium text-primary hover:text-primary/80 focus-within:outline-none focus-within:ring-2 focus-within:ring-offset-2 focus-within:ring-ring",children:[(0,a.jsx)("span",{children:"Upload files"}),(0,a.jsx)(i.p,{id:"file-upload",name:"file-upload",type:"file",className:"sr-only",multiple:!0,onChange:e=>{e.target.files&&Q(e.target.files)}})]}),(0,a.jsx)("p",{className:"pl-1",children:"or drag and drop"})]}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"PNG, JPG, PDF, etc. up to 10MB each"}),K&&K.length>0&&(0,a.jsxs)("div",{className:"pt-2 text-sm text-muted-foreground",children:["Selected: ",Array.from(K).map(e=>e.name).join(", ")]})]})})]}),(0,a.jsx)("div",{className:"flex justify-end",children:(0,a.jsxs)(r.$,{type:"submit",disabled:X||ew||!!ep||!!el,children:[X?(0,a.jsx)(h.A,{className:"mr-2 h-4 w-4 animate-spin"}):(0,a.jsx)(j.A,{className:"mr-2 h-4 w-4"}),"Save Task"]})})]})})]})]}):(0,a.jsx)("div",{className:"space-y-6 max-w-2xl mx-auto",children:(0,a.jsxs)(n.Zp,{className:"shadow-md",children:[(0,a.jsx)(n.aR,{children:(0,a.jsx)(n.ZB,{className:"font-headline",children:"Initializing Task Creation"})}),(0,a.jsx)(n.Wu,{children:(0,a.jsxs)("div",{className:"flex justify-center items-center py-10",children:[(0,a.jsx)(h.A,{className:"h-8 w-8 animate-spin text-primary"}),(0,a.jsx)("p",{className:"ml-2 text-muted-foreground",children:"Initializing task creation form..."})]})})]})})}},97841:(e,t,s)=>{"use strict";s.d(t,{Oc:()=>i,Qu:()=>o,Y$:()=>d,bV:()=>l});var a=s(30645);let r="employees",n=e=>({id:e.id,name:e.name,email:e.email,role:e.role,reportsTo_text:e.reportsTo_text,department_text:e.department_text,userId:e.userId,created:e.created?new Date(e.created):void 0,updated:e.updated?new Date(e.updated):void 0,collectionId:e.collectionId,collectionName:e.collectionName,expand:e.expand}),i=async(e,t)=>{try{let{onRetry:s,signal:i,...l}=t||{},d={sort:"name",fields:"id,name,email,role,department_text,reportsTo_text,userId,created,updated",...l};return(await (0,a.b)(()=>e.collection(r).getFullList(d,{signal:i}),{signal:i,context:"fetching employees list",onRetry:s})).map(n)}catch(e){throw e}},l=async(e,t,s)=>{try{let a=await e.collection(r).create(t,{signal:null==s?void 0:s.signal});return n(a)}catch(e){throw console.error("Failed to create employee:",e),e}},d=async(e,t,s,i)=>{try{let{signal:l}=i||{},d=await (0,a.b)(()=>e.collection(r).update(t,s,{signal:l}),{context:"updating employee ".concat(t),signal:l});return n(d)}catch(e){throw console.error("Failed to update employee ".concat(t,":"),e),e}},o=async(e,t,s)=>{try{let{signal:n}=s||{};await (0,a.b)(()=>e.collection(r).delete(t,{signal:n}),{context:"deleting employee ".concat(t),signal:n})}catch(e){throw console.error("Failed to delete employee ".concat(t,":"),e),e}}}},e=>{var t=t=>e(e.s=t);e.O(0,[383,897,125,977,192,874,767,856,666,480,441,303,358],()=>t(21326)),_N_E=e.O()}]);