(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[867],{14636:(e,t,r)=>{"use strict";r.d(t,{AM:()=>l,Wv:()=>d,hl:()=>o});var s=r(95155),a=r(12115),n=r(20547),i=r(59434);let l=n.bL,d=n.l9,o=a.forwardRef((e,t)=>{let{className:r,align:a="center",sideOffset:l=4,...d}=e;return(0,s.jsx)(n.ZL,{children:(0,s.jsx)(n.UC,{ref:t,align:a,sideOffset:l,className:(0,i.cn)("z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",r),...d})})});o.displayName=n.UC.displayName},21326:(e,t,r)=>{Promise.resolve().then(r.bind(r,96679))},28905:(e,t,r)=>{"use strict";r.d(t,{C:()=>i});var s=r(12115),a=r(6101),n=r(52712),i=e=>{let{present:t,children:r}=e,i=function(e){var t,r;let[a,i]=s.useState(),d=s.useRef({}),o=s.useRef(e),c=s.useRef("none"),[u,m]=(t=e?"mounted":"unmounted",r={mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}},s.useReducer((e,t)=>{let s=r[e][t];return null!=s?s:e},t));return s.useEffect(()=>{let e=l(d.current);c.current="mounted"===u?e:"none"},[u]),(0,n.N)(()=>{let t=d.current,r=o.current;if(r!==e){let s=c.current,a=l(t);e?m("MOUNT"):"none"===a||(null==t?void 0:t.display)==="none"?m("UNMOUNT"):r&&s!==a?m("ANIMATION_OUT"):m("UNMOUNT"),o.current=e}},[e,m]),(0,n.N)(()=>{if(a){var e;let t,r=null!=(e=a.ownerDocument.defaultView)?e:window,s=e=>{let s=l(d.current).includes(e.animationName);if(e.target===a&&s&&(m("ANIMATION_END"),!o.current)){let e=a.style.animationFillMode;a.style.animationFillMode="forwards",t=r.setTimeout(()=>{"forwards"===a.style.animationFillMode&&(a.style.animationFillMode=e)})}},n=e=>{e.target===a&&(c.current=l(d.current))};return a.addEventListener("animationstart",n),a.addEventListener("animationcancel",s),a.addEventListener("animationend",s),()=>{r.clearTimeout(t),a.removeEventListener("animationstart",n),a.removeEventListener("animationcancel",s),a.removeEventListener("animationend",s)}}m("ANIMATION_END")},[a,m]),{isPresent:["mounted","unmountSuspended"].includes(u),ref:s.useCallback(e=>{e&&(d.current=getComputedStyle(e)),i(e)},[])}}(t),d="function"==typeof r?r({present:i.isPresent}):s.Children.only(r),o=(0,a.s)(i.ref,function(e){var t,r;let s=null==(t=Object.getOwnPropertyDescriptor(e.props,"ref"))?void 0:t.get,a=s&&"isReactWarning"in s&&s.isReactWarning;return a?e.ref:(a=(s=null==(r=Object.getOwnPropertyDescriptor(e,"ref"))?void 0:r.get)&&"isReactWarning"in s&&s.isReactWarning)?e.props.ref:e.props.ref||e.ref}(d));return"function"==typeof r||i.isPresent?s.cloneElement(d,{ref:o}):null};function l(e){return(null==e?void 0:e.animationName)||"none"}i.displayName="Presence"},40968:(e,t,r)=>{"use strict";r.d(t,{b:()=>l});var s=r(12115),a=r(63655),n=r(95155),i=s.forwardRef((e,t)=>(0,n.jsx)(a.sG.label,{...e,ref:t,onMouseDown:t=>{var r;t.target.closest("button, input, select, textarea")||(null==(r=e.onMouseDown)||r.call(e,t),!t.defaultPrevented&&t.detail>1&&t.preventDefault())}}));i.displayName="Label";var l=i},47262:(e,t,r)=>{"use strict";r.d(t,{S:()=>d});var s=r(95155),a=r(12115),n=r(76981),i=r(10518),l=r(59434);let d=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)(n.bL,{ref:t,className:(0,l.cn)("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",r),...a,children:(0,s.jsx)(n.C1,{className:(0,l.cn)("flex items-center justify-center text-current"),children:(0,s.jsx)(i.A,{className:"h-4 w-4"})})})});d.displayName=n.bL.displayName},50172:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});let s=(0,r(40157).A)("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},59409:(e,t,r)=>{"use strict";r.d(t,{bq:()=>m,eb:()=>x,gC:()=>h,l6:()=>c,yv:()=>u});var s=r(95155),a=r(12115),n=r(31992),i=r(79556),l=r(77381),d=r(10518),o=r(59434);let c=n.bL;n.YJ;let u=n.WT,m=a.forwardRef((e,t)=>{let{className:r,children:a,...l}=e;return(0,s.jsxs)(n.l9,{ref:t,className:(0,o.cn)("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",r),...l,children:[a,(0,s.jsx)(n.In,{asChild:!0,children:(0,s.jsx)(i.A,{className:"h-4 w-4 opacity-50"})})]})});m.displayName=n.l9.displayName;let p=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)(n.PP,{ref:t,className:(0,o.cn)("flex cursor-default items-center justify-center py-1",r),...a,children:(0,s.jsx)(l.A,{className:"h-4 w-4"})})});p.displayName=n.PP.displayName;let f=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)(n.wn,{ref:t,className:(0,o.cn)("flex cursor-default items-center justify-center py-1",r),...a,children:(0,s.jsx)(i.A,{className:"h-4 w-4"})})});f.displayName=n.wn.displayName;let h=a.forwardRef((e,t)=>{let{className:r,children:a,position:i="popper",...l}=e;return(0,s.jsx)(n.ZL,{children:(0,s.jsxs)(n.UC,{ref:t,className:(0,o.cn)("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===i&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",r),position:i,...l,children:[(0,s.jsx)(p,{}),(0,s.jsx)(n.LM,{className:(0,o.cn)("p-1","popper"===i&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:a}),(0,s.jsx)(f,{})]})})});h.displayName=n.UC.displayName,a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)(n.JU,{ref:t,className:(0,o.cn)("py-1.5 pl-8 pr-2 text-sm font-semibold",r),...a})}).displayName=n.JU.displayName;let x=a.forwardRef((e,t)=>{let{className:r,children:a,...i}=e;return(0,s.jsxs)(n.q7,{ref:t,className:(0,o.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",r),...i,children:[(0,s.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,s.jsx)(n.VF,{children:(0,s.jsx)(d.A,{className:"h-4 w-4"})})}),(0,s.jsx)(n.p4,{children:a})]})});x.displayName=n.q7.displayName,a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)(n.wv,{ref:t,className:(0,o.cn)("-mx-1 my-1 h-px bg-muted",r),...a})}).displayName=n.wv.displayName},62523:(e,t,r)=>{"use strict";r.d(t,{p:()=>i});var s=r(95155),a=r(12115),n=r(59434);let i=a.forwardRef((e,t)=>{let{className:r,type:a,...i}=e;return(0,s.jsx)("input",{type:a,className:(0,n.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",r),ref:t,...i})});i.displayName="Input"},66424:(e,t,r)=>{"use strict";r.d(t,{F:()=>l});var s=r(95155),a=r(12115),n=r(47655),i=r(59434);let l=a.forwardRef((e,t)=>{let{className:r,children:a,...l}=e;return(0,s.jsxs)(n.bL,{ref:t,className:(0,i.cn)("relative overflow-hidden",r),...l,children:[(0,s.jsx)(n.LM,{className:"h-full w-full rounded-[inherit]",children:a}),(0,s.jsx)(d,{}),(0,s.jsx)(n.OK,{})]})});l.displayName=n.bL.displayName;let d=a.forwardRef((e,t)=>{let{className:r,orientation:a="vertical",...l}=e;return(0,s.jsx)(n.VM,{ref:t,orientation:a,className:(0,i.cn)("flex touch-none select-none transition-colors","vertical"===a&&"h-full w-2.5 border-l border-l-transparent p-[1px]","horizontal"===a&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",r),...l,children:(0,s.jsx)(n.lr,{className:"relative flex-1 rounded-full bg-border"})})});d.displayName=n.VM.displayName},85057:(e,t,r)=>{"use strict";r.d(t,{J:()=>o});var s=r(95155),a=r(12115),n=r(40968),i=r(74466),l=r(59434);let d=(0,i.F)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),o=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)(n.b,{ref:t,className:(0,l.cn)(d(),r),...a})});o.displayName=n.b.displayName},85511:(e,t,r)=>{"use strict";r.d(t,{V:()=>o});var s=r(95155);r(12115);var a=r(965),n=r(73158),i=r(89058),l=r(59434),d=r(30285);function o(e){let{className:t,classNames:r,showOutsideDays:o=!0,...c}=e;return(0,s.jsx)(i.hv,{showOutsideDays:o,className:(0,l.cn)("p-3",t),classNames:{months:"flex flex-col sm:flex-row space-y-4 sm:space-x-4 sm:space-y-0",month:"space-y-4",caption:"flex justify-center pt-1 relative items-center",caption_label:"text-sm font-medium",nav:"space-x-1 flex items-center",nav_button:(0,l.cn)((0,d.r)({variant:"outline"}),"h-7 w-7 bg-transparent p-0 opacity-50 hover:opacity-100"),nav_button_previous:"absolute left-1",nav_button_next:"absolute right-1",table:"w-full border-collapse space-y-1",head_row:"flex",head_cell:"text-muted-foreground rounded-md w-9 font-normal text-[0.8rem]",row:"flex w-full mt-2",cell:"h-9 w-9 text-center text-sm p-0 relative [&:has([aria-selected].day-range-end)]:rounded-r-md [&:has([aria-selected].day-outside)]:bg-accent/50 [&:has([aria-selected])]:bg-accent first:[&:has([aria-selected])]:rounded-l-md last:[&:has([aria-selected])]:rounded-r-md focus-within:relative focus-within:z-20",day:(0,l.cn)((0,d.r)({variant:"ghost"}),"h-9 w-9 p-0 font-normal aria-selected:opacity-100"),day_range_end:"day-range-end",day_selected:"bg-primary text-primary-foreground hover:bg-primary hover:text-primary-foreground focus:bg-primary focus:text-primary-foreground",day_today:"bg-accent text-accent-foreground",day_outside:"day-outside text-muted-foreground aria-selected:bg-accent/50 aria-selected:text-muted-foreground",day_disabled:"text-muted-foreground opacity-50",day_range_middle:"aria-selected:bg-accent aria-selected:text-accent-foreground",day_hidden:"invisible",...r},components:{IconLeft:e=>{let{className:t,...r}=e;return(0,s.jsx)(a.A,{className:(0,l.cn)("h-4 w-4",t),...r})},IconRight:e=>{let{className:t,...r}=e;return(0,s.jsx)(n.A,{className:(0,l.cn)("h-4 w-4",t),...r})}},...c})}o.displayName="Calendar"},88539:(e,t,r)=>{"use strict";r.d(t,{T:()=>i});var s=r(95155),a=r(12115),n=r(59434);let i=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("textarea",{className:(0,n.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",r),ref:t,...a})});i.displayName="Textarea"},91950:(e,t,r)=>{"use strict";r.d(t,{C3:()=>i,Hi:()=>s,PN:()=>a,ci:()=>l,oe:()=>o,tk:()=>c,xJ:()=>d,y4:()=>n});let s=["To Do","In Progress","Blocked","Done","Overdue"],a=["Low","Medium","High","Urgent"],n=["None","Daily","Weekly","Monthly","Yearly"],i="LabFlow",l=["MDL","SOP","IA","iDOC","oDOC","VALIDATION_PROJECT","VALIDATION_STEP"],d={"Hydra AA":["Mercury by EPA 245.1","Mercury by EPA 7471B & 7470A"],"Hydra II":["Mercury by EPA 245.1","Mercury by EPA 7471B & 7470A"],"PE Optima 5300V":["Metals by EPA 200.7"],"PE Optima 8300":["Metals by EPA 200.7"],"iCAP 7400 DUO":["Metals by EPA 200.7"],"PE Optima 7300V":["Metals by EPA 200.7"],"PE Elan 9000":["Metals by EPA 200.8"],"Agilent 7900":["Metals by EPA 200.8"],"PE NexION 300X":[],"PE NexION 300D":[]},o=Object.keys(d),c=(()=>{let e=[];for(let t=0;t<=16;t++)e.push("BOL50".concat(String(t).padStart(2,"0")));for(let t=18;t<=24;t++)e.push("BOL50".concat(String(t).padStart(2,"0")));for(let t=26;t<=28;t++)e.push("BOL50".concat(String(t).padStart(2,"0")));for(let t=0;t<=2;t++)e.push("BOL55".concat(String(t).padStart(2,"0")));return e})()},96679:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>C});var s=r(95155),a=r(30285),n=r(66695),i=r(62523),l=r(85057),d=r(88539),o=r(59409),c=r(14636),u=r(85511),m=r(47262),p=r(66424),f=r(50172),h=r(44972),x=r(51920),N=r(31949),g=r(86318);let v=(0,r(40157).A)("CloudUpload",[["path",{d:"M12 13v8",key:"1l5pq0"}],["path",{d:"M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242",key:"1pljnt"}],["path",{d:"m8 17 4-4 4 4",key:"1quai1"}]]);var y=r(59119),j=r(73168),A=r(12115),T=r(35695),b=r(6874),I=r.n(b),O=r(59576),P=r(77694),E=r(97841),w=r(87481),S=r(91950);let _=e=>{let t="Could not load employees for assignment.";if(e&&"object"==typeof e)if("status"in e&&0===e.status)return"Failed to load employees for assignment: Could not connect to the server. Please check your internet connection and try again.";else e.message&&(t=e.message);return t},D=e=>{let t="Could not load tasks for dependency selection.";if(e&&"object"==typeof e)if("status"in e&&0===e.status)return"Failed to load tasks for dependency selection: Could not connect to the server. Please check your internet connection and try again.";else e.message&&(t=e.message);return t},L=e=>{let t=e.get("defaultType");return t&&S.ci.includes(t)?t:S.ci.find(e=>"VALIDATION_PROJECT"!==e&&"VALIDATION_STEP"!==e)||S.ci[0]};function C(){let{pbClient:e,user:t}=(0,O.A)(),r=(0,T.useRouter)(),{toast:b}=(0,w.dj)(),C=(0,T.useSearchParams)(),V=(0,A.useMemo)(()=>L(C),[C]),k=C.get("dependsOnValidationProject"),[R,M]=(0,A.useState)(V),[J,F]=(0,A.useState)(""),[q,U]=(0,A.useState)(),[z,B]=(0,A.useState)(),[W,G]=(0,A.useState)(""),[H,Z]=(0,A.useState)(S.Hi[0]||"To Do"),[$,Y]=(0,A.useState)(S.PN.find(e=>"medium"===e.toLowerCase())||S.PN[0]||"Medium"),[K,X]=(0,A.useState)(),[Q,ee]=(0,A.useState)(),[et,er]=(0,A.useState)(!1),[es,ea]=(0,A.useState)(()=>{let e=L(C);if("VALIDATION_PROJECT"===e||"VALIDATION_STEP"===e)return localStorage.setItem("newTaskFormRecurrence","None"),"None";{let e=localStorage.getItem("newTaskFormRecurrence");if(e&&S.y4.includes(e))return e}return"Daily"}),[en,ei]=(0,A.useState)(),[el,ed]=(0,A.useState)(null),[eo,ec]=(0,A.useState)(!1),[eu,em]=(0,A.useState)(!1),[ep,ef]=(0,A.useState)([]),[eh,ex]=(0,A.useState)(!0),[eN,eg]=(0,A.useState)(null),[ev,ey]=(0,A.useState)([]),[ej,eA]=(0,A.useState)(!0),[eT,eb]=(0,A.useState)(null),[eI,eO]=(0,A.useState)(k?[k]:[]),[eP,eE]=(0,A.useState)(!1),[ew,eS]=(0,A.useState)([]),e_=(0,A.useMemo)(()=>"VALIDATION_PROJECT"===V||"VALIDATION_STEP"===V&&!!k,[V,k]),eD=(0,A.useMemo)(()=>"VALIDATION_PROJECT"===V?S.ci.filter(e=>"VALIDATION_PROJECT"===e):"VALIDATION_STEP"===V&&k?S.ci.filter(e=>"VALIDATION_STEP"===e):S.ci.filter(e=>"VALIDATION_PROJECT"!==e),[V,k]);(0,A.useEffect)(()=>{localStorage.setItem("newTaskFormRecurrence",es)},[es]),(0,A.useEffect)(()=>{if("VALIDATION_PROJECT"===R||"VALIDATION_STEP"===R)"None"!==es&&ea("None");else if("None"===es){let e=localStorage.getItem("newTaskFormRecurrence");e&&"None"!==e&&S.y4.includes(e)?ea(e):ea("Daily")}},[R,es,ea]),(0,A.useEffect)(()=>{"MDL"!==R&&"SOP"!==R?(U(void 0),B(void 0),eS([])):"MDL"===R?(q&&S.xJ[q]?eS(S.xJ[q]):eS([]),q&&S.xJ[q]&&!S.xJ[q].includes(z||"")&&B(void 0)):(B(void 0),eS([])),("VALIDATION_PROJECT"===R||"VALIDATION_STEP"===R)&&eu&&K?ee(K):("VALIDATION_PROJECT"===R||"VALIDATION_STEP"===R)&&eu&&!K&&ee(void 0),"VALIDATION_PROJECT"!==R&&"VALIDATION_STEP"!==R&&em(!1),"VALIDATION_STEP"===R?!k&&eI.length>0&&eO([]):"VALIDATION_PROJECT"===R||k||eO([])},[R,q,eu,K,z,k,eI.length]);let eL=(0,A.useCallback)(async(e,t)=>{if(!e)return void ex(!1);ex(!0),eg(null);try{let r=await (0,E.Oc)(e,{signal:t});ef(r)}catch(r){let e=(null==r?void 0:r.isAbort)===!0||"string"==typeof(null==r?void 0:r.message)&&r.message.toLowerCase().includes("autocancelled"),t=(null==r?void 0:r.status)===0&&!e;if(e)console.warn("Fetch employees for task assignment request was ".concat((null==r?void 0:r.isAbort)?"aborted":"autocancelled","."),r);else if(t){let e=_(r);eg(e),b({title:"Error Loading Employees",description:e,variant:"destructive"}),console.warn("Fetch employees for task assignment (network error):",e,r)}else{let e=_(r);eg(e),b({title:"Error Loading Employees",description:e,variant:"destructive"}),console.warn("Error fetching employees for task assignment (after retries):",e,r)}}finally{ex(!1)}},[b]),eC=(0,A.useCallback)(async(e,t)=>{if(!e)return void eA(!1);eA(!0),eb(null);try{let r=await (0,P.x1)(e,{signal:t});ey(r)}catch(r){let e=(null==r?void 0:r.isAbort)===!0||"string"==typeof(null==r?void 0:r.message)&&r.message.toLowerCase().includes("autocancelled"),t=(null==r?void 0:r.status)===0&&!e;if(e)console.warn("Fetch tasks for dependency selection request was ".concat((null==r?void 0:r.isAbort)?"aborted":"autocancelled","."),r);else if(t){let e=D(r);eb(e),b({title:"Error Loading Tasks for Dependencies",description:e,variant:"destructive"}),console.warn("Fetch tasks for dependency selection (network error):",e,r)}else{let e=D(r);eb(e),b({title:"Error Loading Tasks for Dependencies",description:e,variant:"destructive"}),console.warn("Error fetching tasks for dependency selection (after retries):",e,r)}}finally{eA(!1)}},[b]);(0,A.useEffect)(()=>{let t=new AbortController;return e?(eL(e,t.signal),"VALIDATION_STEP"!==R?eC(e,t.signal):(eA(!1),ey([]))):(ex(!0),eA(!0)),()=>{t.abort()}},[e,eL,eC,R]);let eV=e=>{eO(t=>t.includes(e)?t.filter(t=>t!==e):[...t,e])},ek=async s=>{var a;if(s.preventDefault(),!e||!t)return void b({title:"Error",description:"You must be logged in to create a task.",variant:"destructive"});let n="VALIDATION_PROJECT"===R?J.trim():R;if(!n)return void b({title:"Validation Error",description:"VALIDATION_PROJECT"===R?"Project Name is required.":"Task Type (which serves as Name) is required.",variant:"destructive"});if("MDL"===R&&!q)return void b({title:"Validation Error",description:"Instrument Subtype is required for ".concat(R," tasks."),variant:"destructive"});if("MDL"===R&&q&&(null==(a=S.xJ[q])?void 0:a.length)>0&&!z)return void b({title:"Validation Error",description:"Method is required for the selected ".concat(q,"."),variant:"destructive"});if("SOP"===R&&!q)return void b({title:"Validation Error",description:"Subtype is required for ".concat(R," tasks."),variant:"destructive"});if(!H)return void b({title:"Validation Error",description:"Task status is required.",variant:"destructive"});if(!$)return void b({title:"Validation Error",description:"Task priority is required.",variant:"destructive"});let i="VALIDATION_PROJECT"===R||"VALIDATION_STEP"===R?"None":es;if("VALIDATION_PROJECT"!==R&&"VALIDATION_STEP"!==R&&(!i||!S.y4.includes(i)))return void b({title:"Validation Error",description:"Task recurrence is required for this task type.",variant:"destructive"});if(("VALIDATION_PROJECT"===R||"VALIDATION_STEP"===R)&&eu&&!K)return void b({title:"Validation Error",description:"Milestone date is required for a Validation milestone.",variant:"destructive"});if(!(("VALIDATION_PROJECT"===R||"VALIDATION_STEP"===R)&&eu)&&K&&Q&&K>Q)return void b({title:"Validation Error",description:"Start date must be before or same as due date.",variant:"destructive"});ec(!0);let l=new FormData;if(l.append("title",n),l.append("task_type",R),"MDL"===R&&q?(l.append("instrument_subtype",q),z&&l.append("method",z)):"SOP"===R&&q&&l.append("instrument_subtype",q),W.trim()&&l.append("description",W),l.append("status",H),l.append("priority",$),l.append("recurrence",i),l.append("isMilestone","VALIDATION_PROJECT"===R||"VALIDATION_STEP"===R?eu.toString():"false"),eI.length>0&&l.append("dependencies",JSON.stringify(eI)),K&&l.append("startDate",K.toISOString()),Q&&l.append("dueDate",Q.toISOString()),en&&l.append("assignedTo_text",en),l.append("userId",t.id),el)for(let e=0;e<el.length;e++)l.append("attachments",el[e]);try{await (0,P.UT)(e,l),b({title:"Success",description:"New ".concat(n," task created successfully!")}),"VALIDATION_PROJECT"===R||"VALIDATION_STEP"===R||k?r.push("/validations"):r.push("/tasks")}catch(e){b({title:"Error Creating Task",description:e.message||"An unexpected error occurred. Please try again.",variant:"destructive"})}finally{ec(!1)}},eR=eh||ej&&"VALIDATION_STEP"!==R,eM="Pick a date";if(eM=("VALIDATION_PROJECT"===R||"VALIDATION_STEP"===R)&&eu?K?"Milestone: ".concat((0,j.GP)(K,"PPP")):"Pick Milestone Date":K&&Q?"".concat((0,j.GP)(K,"PPP")," - ").concat((0,j.GP)(Q,"PPP")):K?"".concat((0,j.GP)(K,"PPP")," - Select End Date"):"Pick Date Range",!e&&!eR)return(0,s.jsx)("div",{className:"space-y-6 max-w-2xl mx-auto",children:(0,s.jsxs)(n.Zp,{className:"shadow-md",children:[(0,s.jsx)(n.aR,{children:(0,s.jsx)(n.ZB,{className:"font-headline",children:"Initializing Task Creation"})}),(0,s.jsx)(n.Wu,{children:(0,s.jsxs)("div",{className:"flex justify-center items-center py-10",children:[(0,s.jsx)(f.A,{className:"h-8 w-8 animate-spin text-primary"}),(0,s.jsx)("p",{className:"ml-2 text-muted-foreground",children:"Initializing task creation form..."})]})})]})});let eJ="VALIDATION_STEP"===R&&!!k,eF="VALIDATION_PROJECT"===R||"VALIDATION_PROJECT"===V;return(0,s.jsxs)("div",{className:"space-y-6 max-w-2xl mx-auto",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("h1",{className:"text-2xl md:text-3xl font-headline font-semibold",children:eF?"New Validation Project":eJ?"New Step for Validation Project":"Add New Task"}),(0,s.jsx)(a.$,{variant:"outline",asChild:!0,children:(0,s.jsx)(I(),{href:eF||eJ?"/validations":"/tasks",children:"Cancel"})})]}),(0,s.jsxs)(n.Zp,{className:"shadow-md",children:[(0,s.jsxs)(n.aR,{children:[(0,s.jsx)(n.ZB,{className:"font-headline",children:"Task Details"}),(0,s.jsx)(n.BT,{children:"Fill in the information for the new task."})]}),(0,s.jsx)(n.Wu,{children:(0,s.jsxs)("form",{onSubmit:ek,className:"space-y-6",children:[!e_&&(0,s.jsxs)("div",{children:[(0,s.jsx)(l.J,{htmlFor:"task_type_select",children:"Task Type"}),(0,s.jsxs)(o.l6,{value:R,onValueChange:e=>{M(e),"VALIDATION_PROJECT"!==e&&F("")},children:[(0,s.jsx)(o.bq,{id:"task_type_select",children:(0,s.jsx)(o.yv,{placeholder:"Select task type"})}),(0,s.jsx)(o.gC,{children:eD.map(e=>(0,s.jsx)(o.eb,{value:e,children:e.replace(/_/g," ")},e))})]})]}),"VALIDATION_PROJECT"===R&&(0,s.jsxs)("div",{children:[(0,s.jsx)(l.J,{htmlFor:"customProjectName",children:"Project Name"}),(0,s.jsx)(i.p,{id:"customProjectName",placeholder:"Enter the project name",value:J,onChange:e=>F(e.target.value)})]}),"MDL"===R&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(l.J,{htmlFor:"instrumentSubtypeMDL",children:"Instrument Subtype"}),(0,s.jsxs)(o.l6,{value:q,onValueChange:e=>{U(e),e&&S.xJ[e]&&!S.xJ[e].includes(z||"")?B(void 0):e||B(void 0),eS(e&&S.xJ[e]||[])},children:[(0,s.jsx)(o.bq,{id:"instrumentSubtypeMDL",children:(0,s.jsx)(o.yv,{placeholder:"Select instrument for MDL"})}),(0,s.jsx)(o.gC,{children:S.oe.map(e=>(0,s.jsx)(o.eb,{value:e,children:e},e))})]})]}),q&&ew.length>0&&(0,s.jsxs)("div",{children:[(0,s.jsx)(l.J,{htmlFor:"methodMDL",children:"Method"}),(0,s.jsxs)(o.l6,{value:z,onValueChange:e=>B(e),children:[(0,s.jsx)(o.bq,{id:"methodMDL",children:(0,s.jsx)(o.yv,{placeholder:"Select method"})}),(0,s.jsx)(o.gC,{children:ew.map(e=>(0,s.jsx)(o.eb,{value:e,children:e},e))})]})]})]}),"SOP"===R&&(0,s.jsxs)("div",{children:[(0,s.jsx)(l.J,{htmlFor:"instrumentSubtypeSOP",children:"SOP Subtype"}),(0,s.jsxs)(o.l6,{value:q,onValueChange:e=>U(e),children:[(0,s.jsx)(o.bq,{id:"instrumentSubtypeSOP",children:(0,s.jsx)(o.yv,{placeholder:"Select SOP subtype"})}),(0,s.jsx)(o.gC,{children:S.tk.map(e=>(0,s.jsx)(o.eb,{value:e,children:e},e))})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(l.J,{htmlFor:"description",children:"Description"}),(0,s.jsx)(d.T,{id:"description",placeholder:"Add any relevant details or instructions...",value:W,onChange:e=>G(e.target.value)})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(l.J,{htmlFor:"status",children:"Status"}),(0,s.jsxs)(o.l6,{value:H,onValueChange:e=>Z(e),children:[(0,s.jsx)(o.bq,{id:"status",children:(0,s.jsx)(o.yv,{placeholder:"Select status"})}),(0,s.jsx)(o.gC,{children:S.Hi.map(e=>(0,s.jsx)(o.eb,{value:e,children:e},e))})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(l.J,{htmlFor:"priority",children:"Priority"}),(0,s.jsxs)(o.l6,{value:$,onValueChange:e=>Y(e),children:[(0,s.jsx)(o.bq,{id:"priority",children:(0,s.jsx)(o.yv,{placeholder:"Select priority"})}),(0,s.jsx)(o.gC,{children:S.PN.map(e=>(0,s.jsx)(o.eb,{value:e,children:e},e))})]})]})]}),("VALIDATION_PROJECT"===R||"VALIDATION_STEP"===R)&&(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)(m.S,{id:"isMilestone",checked:eu,onCheckedChange:e=>em(!!e)}),(0,s.jsxs)(l.J,{htmlFor:"isMilestone",className:"flex items-center cursor-pointer",children:[(0,s.jsx)(h.A,{className:"mr-2 h-4 w-4 text-muted-foreground"})," Mark as Milestone"]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(l.J,{htmlFor:"dateRangePicker",children:("VALIDATION_PROJECT"===R||"VALIDATION_STEP"===R)&&eu?"Milestone Date":"Date Range (Start - Due)"}),(0,s.jsxs)(c.AM,{open:et,onOpenChange:er,children:[(0,s.jsx)(c.Wv,{asChild:!0,children:(0,s.jsxs)(a.$,{id:"dateRangePicker",variant:"outline",className:"w-full justify-start text-left font-normal",children:[(0,s.jsx)(x.A,{className:"mr-2 h-4 w-4"}),eM]})}),(0,s.jsx)(c.hl,{className:"w-auto p-0",children:(0,s.jsx)(u.V,{mode:("VALIDATION_PROJECT"===R||"VALIDATION_STEP"===R)&&eu?"single":"range",selected:("VALIDATION_PROJECT"===R||"VALIDATION_STEP"===R)&&eu?K:{from:K,to:Q},onSelect:e=>{("VALIDATION_PROJECT"===R||"VALIDATION_STEP"===R)&&eu?(X(e),ee(e)):(X(null==e?void 0:e.from),ee(null==e?void 0:e.to)),e&&(("VALIDATION_PROJECT"===R||"VALIDATION_STEP"===R)&&eu||null==e||!e.from||(null==e?void 0:e.to))&&er(!1)},numberOfMonths:("VALIDATION_PROJECT"===R||"VALIDATION_STEP"===R)&&eu?1:2,initialFocus:!0})})]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:["VALIDATION_PROJECT"!==R&&"VALIDATION_STEP"!==R&&(0,s.jsxs)("div",{children:[(0,s.jsx)(l.J,{htmlFor:"recurrence",children:"Recurrence"}),(0,s.jsxs)(o.l6,{value:es,onValueChange:e=>ea(e),children:[(0,s.jsx)(o.bq,{id:"recurrence",children:(0,s.jsx)(o.yv,{placeholder:"Select recurrence"})}),(0,s.jsx)(o.gC,{children:S.y4.map(e=>(0,s.jsx)(o.eb,{value:e,children:e},e))})]})]}),(0,s.jsxs)("div",{className:"VALIDATION_PROJECT"===R||"VALIDATION_STEP"===R||"MDL"===R&&ew.length>0||"VALIDATION_PROJECT"!==R&&"VALIDATION_STEP"!==R?"md:col-span-2":"",children:[(0,s.jsx)(l.J,{htmlFor:"assignedTo",children:"Assigned To"}),(0,s.jsxs)(o.l6,{onValueChange:e=>ei("__NONE__"===e?void 0:e),value:en||"__NONE__",disabled:eh||!!eN,children:[(0,s.jsx)(o.bq,{id:"assignedTo_text",children:(0,s.jsx)(o.yv,{placeholder:eh?"Loading employees...":eN?"Error loading employees":"Select employee (Optional)"})}),(0,s.jsxs)(o.gC,{children:[(0,s.jsx)(o.eb,{value:"__NONE__",children:"None"}),ep.map(e=>(0,s.jsxs)(o.eb,{value:e.name,children:[e.name," (",e.role,")"]},e.id))]})]}),eN&&!eh&&(0,s.jsxs)("p",{className:"text-sm text-destructive mt-1 flex items-center",children:[(0,s.jsx)(N.A,{className:"h-4 w-4 mr-1"})," ",eN]})]})]}),"VALIDATION_STEP"!==R&&(0,s.jsxs)("div",{children:[(0,s.jsx)(l.J,{htmlFor:"dependencies",children:"Dependencies (Optional)"}),(0,s.jsxs)(c.AM,{open:eP,onOpenChange:eE,children:[(0,s.jsx)(c.Wv,{asChild:!0,children:(0,s.jsxs)(a.$,{variant:"outline",className:"w-full justify-start text-left font-normal",disabled:ej||!!eT,children:[(0,s.jsx)(g.A,{className:"mr-2 h-4 w-4"}),ej?"Loading tasks...":eT?"Error loading tasks":eI.length>0?"".concat(eI.length," selected"):"Select tasks"]})}),(0,s.jsxs)(c.hl,{className:"w-[--radix-popover-trigger-width] p-0",children:[ej?(0,s.jsx)("div",{className:"p-4 text-center text-sm",children:"Loading tasks..."}):eT?(0,s.jsx)("div",{className:"p-4 text-center text-sm text-destructive",children:eT}):0===ev.length?(0,s.jsx)("div",{className:"p-4 text-center text-sm",children:"No tasks available to select as dependencies."}):(0,s.jsx)(p.F,{className:"h-48",children:(0,s.jsx)("div",{className:"p-4 space-y-2",children:ev.map(e=>(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)(m.S,{id:"dep-".concat(e.id),checked:eI.includes(e.id),onCheckedChange:()=>eV(e.id),disabled:k===e.id}),(0,s.jsxs)("label",{htmlFor:"dep-".concat(e.id),className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70 truncate",title:e.title,children:[e.title," (",e.task_type.replace(/_/g," "),")"]})]},e.id))})}),(0,s.jsx)("div",{className:"p-2 border-t",children:(0,s.jsx)(a.$,{size:"sm",className:"w-full",onClick:()=>eE(!1),children:"Done"})})]})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(l.J,{htmlFor:"attachments",children:"Attachments"}),(0,s.jsx)("div",{className:"mt-1 flex justify-center px-6 pt-5 pb-6 border-2 border-dashed rounded-md",children:(0,s.jsxs)("div",{className:"space-y-1 text-center",children:[(0,s.jsx)(v,{className:"mx-auto h-12 w-12 text-muted-foreground"}),(0,s.jsxs)("div",{className:"flex text-sm text-muted-foreground",children:[(0,s.jsxs)("label",{htmlFor:"file-upload",className:"relative cursor-pointer rounded-md font-medium text-primary hover:text-primary/80 focus-within:outline-none focus-within:ring-2 focus-within:ring-offset-2 focus-within:ring-ring",children:[(0,s.jsx)("span",{children:"Upload files"}),(0,s.jsx)(i.p,{id:"file-upload",name:"file-upload",type:"file",className:"sr-only",multiple:!0,onChange:e=>{e.target.files&&ed(e.target.files)}})]}),(0,s.jsx)("p",{className:"pl-1",children:"or drag and drop"})]}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground",children:"PNG, JPG, PDF, etc. up to 10MB each"}),el&&el.length>0&&(0,s.jsxs)("div",{className:"pt-2 text-sm text-muted-foreground",children:["Selected: ",Array.from(el).map(e=>e.name).join(", ")]})]})})]}),(0,s.jsx)("div",{className:"flex justify-end",children:(0,s.jsxs)(a.$,{type:"submit",disabled:eo||eR||eT&&"VALIDATION_STEP"!==R||eN,children:[eo?(0,s.jsx)(f.A,{className:"mr-2 h-4 w-4 animate-spin"}):(0,s.jsx)(y.A,{className:"mr-2 h-4 w-4"}),"Save Task"]})})]})})]})]})}}},e=>{var t=t=>e(e.s=t);e.O(0,[383,897,52,977,859,874,616,473,876,563,441,303,358],()=>t(21326)),_N_E=e.O()}]);