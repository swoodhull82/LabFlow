(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[867],{5349:(e,t,a)=>{"use strict";a.d(t,{S:()=>T});var s=a(95155),r=a(12115),n=a(6101),i=a(46081),l=a(85185),d=a(5845),o=a(45503),c=a(11275),u=a(28905),p=a(63655),h="Checkbox",[m,x]=(0,i.A)(h),[f,y]=m(h),v=r.forwardRef((e,t)=>{let{__scopeCheckbox:a,name:i,checked:o,defaultChecked:c,required:u,disabled:h,value:m="on",onCheckedChange:x,form:y,...v}=e,[g,j]=r.useState(null),A=(0,n.s)(t,e=>j(e)),O=r.useRef(!1),T=!g||y||!!g.closest("form"),[C=!1,w]=(0,d.i)({prop:o,defaultProp:c,onChange:x}),I=r.useRef(C);return r.useEffect(()=>{let e=null==g?void 0:g.form;if(e){let t=()=>w(I.current);return e.addEventListener("reset",t),()=>e.removeEventListener("reset",t)}},[g,w]),(0,s.jsxs)(f,{scope:a,state:C,disabled:h,children:[(0,s.jsx)(p.sG.button,{type:"button",role:"checkbox","aria-checked":b(C)?"mixed":C,"aria-required":u,"data-state":k(C),"data-disabled":h?"":void 0,disabled:h,value:m,...v,ref:A,onKeyDown:(0,l.m)(e.onKeyDown,e=>{"Enter"===e.key&&e.preventDefault()}),onClick:(0,l.m)(e.onClick,e=>{w(e=>!!b(e)||!e),T&&(O.current=e.isPropagationStopped(),O.current||e.stopPropagation())})}),T&&(0,s.jsx)(N,{control:g,bubbles:!O.current,name:i,value:m,checked:C,required:u,disabled:h,form:y,style:{transform:"translateX(-100%)"},defaultChecked:!b(c)&&c})]})});v.displayName=h;var g="CheckboxIndicator",j=r.forwardRef((e,t)=>{let{__scopeCheckbox:a,forceMount:r,...n}=e,i=y(g,a);return(0,s.jsx)(u.C,{present:r||b(i.state)||!0===i.state,children:(0,s.jsx)(p.sG.span,{"data-state":k(i.state),"data-disabled":i.disabled?"":void 0,...n,ref:t,style:{pointerEvents:"none",...e.style}})})});j.displayName=g;var N=e=>{let{control:t,checked:a,bubbles:n=!0,defaultChecked:i,...l}=e,d=r.useRef(null),u=(0,o.Z)(a),p=(0,c.X)(t);r.useEffect(()=>{let e=d.current,t=Object.getOwnPropertyDescriptor(window.HTMLInputElement.prototype,"checked").set;if(u!==a&&t){let s=new Event("click",{bubbles:n});e.indeterminate=b(a),t.call(e,!b(a)&&a),e.dispatchEvent(s)}},[u,a,n]);let h=r.useRef(!b(a)&&a);return(0,s.jsx)("input",{type:"checkbox","aria-hidden":!0,defaultChecked:null!=i?i:h.current,...l,tabIndex:-1,ref:d,style:{...e.style,...p,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})};function b(e){return"indeterminate"===e}function k(e){return b(e)?"indeterminate":e?"checked":"unchecked"}var A=a(10518),O=a(59434);let T=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(v,{ref:t,className:(0,O.cn)("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",a),...r,children:(0,s.jsx)(j,{className:(0,O.cn)("flex items-center justify-center text-current"),children:(0,s.jsx)(A.A,{className:"h-4 w-4"})})})});T.displayName=v.displayName},21326:(e,t,a)=>{Promise.resolve().then(a.bind(a,96679))},44972:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(40157).A)("Milestone",[["path",{d:"M12 13v8",key:"1l5pq0"}],["path",{d:"M12 3v3",key:"1n5kay"}],["path",{d:"M4 6a1 1 0 0 0-1 1v5a1 1 0 0 0 1 1h13a2 2 0 0 0 1.152-.365l3.424-2.317a1 1 0 0 0 0-1.635l-3.424-2.318A2 2 0 0 0 17 6z",key:"1btarq"}]])},51920:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(40157).A)("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]])},85511:(e,t,a)=>{"use strict";a.d(t,{V:()=>o});var s=a(95155);a(12115);var r=a(965),n=a(73158),i=a(86374),l=a(59434),d=a(30285);function o(e){let{className:t,classNames:a,showOutsideDays:o=!0,...c}=e;return(0,s.jsx)(i.hv,{showOutsideDays:o,className:(0,l.cn)("p-3",t),classNames:{months:"flex flex-col sm:flex-row space-y-4 sm:space-x-4 sm:space-y-0",month:"space-y-4",caption:"flex justify-center pt-1 relative items-center",caption_label:"text-sm font-medium",nav:"space-x-1 flex items-center",nav_button:(0,l.cn)((0,d.r)({variant:"outline"}),"h-7 w-7 bg-transparent p-0 opacity-50 hover:opacity-100"),nav_button_previous:"absolute left-1",nav_button_next:"absolute right-1",table:"w-full border-collapse space-y-1",head_row:"flex",head_cell:"text-muted-foreground rounded-md w-9 font-normal text-[0.8rem]",row:"flex w-full mt-2",cell:"h-9 w-9 text-center text-sm p-0 relative [&:has([aria-selected].day-range-end)]:rounded-r-md [&:has([aria-selected].day-outside)]:bg-accent/50 [&:has([aria-selected])]:bg-accent first:[&:has([aria-selected])]:rounded-l-md last:[&:has([aria-selected])]:rounded-r-md focus-within:relative focus-within:z-20",day:(0,l.cn)((0,d.r)({variant:"ghost"}),"h-9 w-9 p-0 font-normal aria-selected:opacity-100"),day_range_end:"day-range-end",day_selected:"bg-primary text-primary-foreground hover:bg-primary hover:text-primary-foreground focus:bg-primary focus:text-primary-foreground",day_today:"bg-accent text-accent-foreground",day_outside:"day-outside text-muted-foreground aria-selected:bg-accent/50 aria-selected:text-muted-foreground",day_disabled:"text-muted-foreground opacity-50",day_range_middle:"aria-selected:bg-accent aria-selected:text-accent-foreground",day_hidden:"invisible",...a},components:{IconLeft:e=>{let{className:t,...a}=e;return(0,s.jsx)(r.A,{className:(0,l.cn)("h-4 w-4",t),...a})},IconRight:e=>{let{className:t,...a}=e;return(0,s.jsx)(n.A,{className:(0,l.cn)("h-4 w-4",t),...a})}},...c})}o.displayName="Calendar"},86318:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(40157).A)("Link",[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]])},88539:(e,t,a)=>{"use strict";a.d(t,{T:()=>i});var s=a(95155),r=a(12115),n=a(59434);let i=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("textarea",{className:(0,n.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",a),ref:t,...r})});i.displayName="Textarea"},96679:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>D});var s=a(95155),r=a(30285),n=a(66695),i=a(62523),l=a(85057),d=a(88539),o=a(59409),c=a(14636),u=a(85511),p=a(5349),h=a(66424),m=a(50172),x=a(44972),f=a(51920),y=a(31949),v=a(86318);let g=(0,a(40157).A)("CloudUpload",[["path",{d:"M12 13v8",key:"1l5pq0"}],["path",{d:"M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242",key:"1pljnt"}],["path",{d:"m8 17 4-4 4 4",key:"1quai1"}]]);var j=a(59119),N=a(73168),b=a(12115),k=a(35695),A=a(6874),O=a.n(A),T=a(59576),C=a(77694),w=a(97841),I=a(87481),P=a(91950);let _=e=>{let t="Could not load employees for assignment.";if(e&&"object"==typeof e)if("status"in e&&0===e.status)return"Failed to load employees for assignment: Could not connect to the server. Please check your internet connection and try again.";else e.message&&(t=e.message);return t},E=e=>{let t="Could not load tasks for dependency selection.";if(e&&"object"==typeof e)if("status"in e&&0===e.status)return"Failed to load tasks for dependency selection: Could not connect to the server. Please check your internet connection and try again.";else e.message&&(t=e.message);return t};function D(){let{pbClient:e,user:t}=(0,T.A)(),a=(0,k.useRouter)(),{toast:A}=(0,I.dj)(),D=(0,k.useSearchParams)().get("defaultType"),[S,L]=(0,b.useState)(D||P.ci.find(e=>"VALIDATION_PROJECT"!==e)||P.ci[0]),[V,J]=(0,b.useState)(""),[R,M]=(0,b.useState)(),[F,q]=(0,b.useState)(""),[G,B]=(0,b.useState)(P.Hi[0]||"To Do"),[$,z]=(0,b.useState)(P.PN.find(e=>"medium"===e.toLowerCase())||P.PN[0]||"Medium"),[Z,H]=(0,b.useState)(),[W,U]=(0,b.useState)(),[K,X]=(0,b.useState)(!1),[Y,Q]=(0,b.useState)(P.y4.find(e=>"none"===e.toLowerCase())||P.y4[0]||"None"),[ee,et]=(0,b.useState)(),[ea,es]=(0,b.useState)(null),[er,en]=(0,b.useState)(!1),[ei,el]=(0,b.useState)(!1),[ed,eo]=(0,b.useState)([]),[ec,eu]=(0,b.useState)(!0),[ep,eh]=(0,b.useState)(null),[em,ex]=(0,b.useState)([]),[ef,ey]=(0,b.useState)(!0),[ev,eg]=(0,b.useState)(null),[ej,eN]=(0,b.useState)([]),[eb,ek]=(0,b.useState)(!1);(0,b.useEffect)(()=>{D&&(L(D),"VALIDATION_PROJECT"===D&&Q("None"))},[D]);let eA=(0,b.useCallback)(async(e,t)=>{if(!e)return void eu(!1);eu(!0),eh(null);try{let a=await (0,w.Oc)(e,{signal:t});eo(a)}catch(a){let e=(null==a?void 0:a.isAbort)===!0||"string"==typeof(null==a?void 0:a.message)&&a.message.toLowerCase().includes("autocancelled"),t=(null==a?void 0:a.status)===0&&!e;if(e)console.warn("Fetch employees for task assignment request was ".concat((null==a?void 0:a.isAbort)?"aborted":"autocancelled","."),a);else if(t){let e=_(a);eh(e),A({title:"Error Loading Employees",description:e,variant:"destructive"}),console.warn("Fetch employees for task assignment (network error):",e,a)}else{let e=_(a);eh(e),A({title:"Error Loading Employees",description:e,variant:"destructive"}),console.warn("Error fetching employees for task assignment (after retries):",e,a)}}finally{eu(!1)}},[A]),eO=(0,b.useCallback)(async(e,t)=>{if(!e)return void ey(!1);ey(!0),eg(null);try{let a=await (0,C.x1)(e,{signal:t,filter:'task_type = "VALIDATION_PROJECT"'});ex(a)}catch(a){let e=(null==a?void 0:a.isAbort)===!0||"string"==typeof(null==a?void 0:a.message)&&a.message.toLowerCase().includes("autocancelled"),t=(null==a?void 0:a.status)===0&&!e;if(e)console.warn("Fetch tasks for dependency selection request was ".concat((null==a?void 0:a.isAbort)?"aborted":"autocancelled","."),a);else if(t){let e=E(a);eg(e),A({title:"Error Loading Tasks for Dependencies",description:e,variant:"destructive"}),console.warn("Fetch tasks for dependency selection (network error):",e,a)}else{let e=E(a);eg(e),A({title:"Error Loading Tasks for Dependencies",description:e,variant:"destructive"}),console.warn("Error fetching tasks for dependency selection (after retries):",e,a)}}finally{ey(!1)}},[A]);(0,b.useEffect)(()=>{let t=new AbortController;return e?(eA(e,t.signal),"VALIDATION_PROJECT"===S?eO(e,t.signal):(ex([]),ey(!1))):(eu(!0),ey(!0)),()=>{t.abort()}},[e,S,eA,eO]),(0,b.useEffect)(()=>{"MDL"!==S&&"SOP"!==S&&M(void 0),"VALIDATION_PROJECT"!==S?(el(!1),eN([])):Q("None"),"VALIDATION_PROJECT"===S&&ei&&Z?U(Z):"VALIDATION_PROJECT"===S&&ei&&!Z&&U(void 0)},[S,ei,Z,Y,D]);let eT=e=>{eN(t=>t.includes(e)?t.filter(t=>t!==e):[...t,e])},eC=async s=>{if(s.preventDefault(),!e||!t)return void A({title:"Error",description:"You must be logged in to create a task.",variant:"destructive"});if(!S)return void A({title:"Validation Error",description:"Task Type is required.",variant:"destructive"});if(!V.trim())return void A({title:"Validation Error",description:"Task Name is required.",variant:"destructive"});if(("MDL"===S||"SOP"===S)&&!R)return void A({title:"Validation Error",description:"Subtype is required for ".concat(S," tasks."),variant:"destructive"});if(!G)return void A({title:"Validation Error",description:"Task status is required.",variant:"destructive"});if(!$)return void A({title:"Validation Error",description:"Task priority is required.",variant:"destructive"});let r="VALIDATION_PROJECT"===S?"None":Y;if("VALIDATION_PROJECT"!==S&&(!r||!P.y4.includes(r)))return void A({title:"Validation Error",description:"Task recurrence is required for non-Validation tasks.",variant:"destructive"});if("VALIDATION_PROJECT"===S&&ei&&!Z)return void A({title:"Validation Error",description:"Milestone date is required for a Validation milestone.",variant:"destructive"});if(!("VALIDATION_PROJECT"===S&&ei)&&Z&&W&&Z>W)return void A({title:"Validation Error",description:"Start date must be before or same as due date.",variant:"destructive"});en(!0);let n=new FormData;if(n.append("task_type",S),n.append("title",V),("MDL"===S||"SOP"===S)&&R&&n.append("instrument_subtype",R),n.append("description",F),n.append("status",G),n.append("priority",$),n.append("recurrence",r),"VALIDATION_PROJECT"===S?(n.append("isMilestone",ei.toString()),ej.length>0&&n.append("dependencies",JSON.stringify(ej)),n.append("steps",JSON.stringify([]))):n.append("isMilestone","false"),Z&&n.append("startDate",Z.toISOString()),W&&n.append("dueDate",W.toISOString()),ee&&n.append("assignedTo_text",ee),n.append("userId",t.id),ea)for(let e=0;e<ea.length;e++)n.append("attachments",ea[e]);try{await (0,C.UT)(e,n),A({title:"Success",description:"New ".concat(S.replace(/_/g," ")," task created successfully!")}),"VALIDATION_PROJECT"===S?a.push("/validations"):a.push("/tasks")}catch(t){console.error("Failed to create task (full error object):",t);let e="Failed to create task. Please try again.";if(t.data&&"object"==typeof t.data){let a="";t.data.message&&"string"==typeof t.data.message&&(a=t.data.message);let s="";if(t.data.data&&"object"==typeof t.data.data&&Object.keys(t.data.data).length>0&&(s=Object.entries(t.data.data).map(e=>{let[t,a]=e,s=a&&a.message?a.message:"Invalid value";return"".concat(t,": ").concat(s)}).join("; ")),a&&s)e="".concat(a,". Details: ").concat(s);else if(a)e=a;else if(s)e="Validation errors: ".concat(s);else if(Object.keys(t.data).length>0&&"Failed to create task. Please try again."===e)try{e="PocketBase error: ".concat(JSON.stringify(t.data))}catch(t){e="PocketBase error: Could not stringify error data."}}else t.message&&"string"==typeof t.message&&(e=t.message);A({title:"Error Creating Task",description:e,variant:"destructive"})}finally{en(!1)}},ew=ec||"VALIDATION_PROJECT"===S&&ef,eI="VALIDATION_PROJECT"===D?P.ci.filter(e=>"VALIDATION_PROJECT"===e):P.ci.filter(e=>"VALIDATION_PROJECT"!==e),eP="Pick a date";return(eP="VALIDATION_PROJECT"===S&&ei?Z?"Milestone: ".concat((0,N.GP)(Z,"PPP")):"Pick Milestone Date":Z&&W?"".concat((0,N.GP)(Z,"PPP")," - ").concat((0,N.GP)(W,"PPP")):Z?"".concat((0,N.GP)(Z,"PPP")," - Select End Date"):"Pick Date Range",e||ew)?(0,s.jsxs)("div",{className:"space-y-6 max-w-2xl mx-auto",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("h1",{className:"text-2xl md:text-3xl font-headline font-semibold",children:"VALIDATION_PROJECT"===S?"New Validation Project":"Add New Task"}),(0,s.jsx)(r.$,{variant:"outline",asChild:!0,children:(0,s.jsx)(O(),{href:"VALIDATION_PROJECT"===S?"/validations":"/tasks",children:"Cancel"})})]}),(0,s.jsxs)(n.Zp,{className:"shadow-md",children:[(0,s.jsxs)(n.aR,{children:[(0,s.jsx)(n.ZB,{className:"font-headline",children:"Task Details"}),(0,s.jsx)(n.BT,{children:"Fill in the information for the new task."})]}),(0,s.jsx)(n.Wu,{children:(0,s.jsxs)("form",{onSubmit:eC,className:"space-y-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(l.J,{htmlFor:"task_type",children:"Task Type"}),(0,s.jsxs)(o.l6,{value:S,onValueChange:e=>{L(e),M(void 0),el(!1),eN([]),"VALIDATION_PROJECT"===e&&Q("None")},disabled:"VALIDATION_PROJECT"===D,children:[(0,s.jsx)(o.bq,{id:"task_type",children:(0,s.jsx)(o.yv,{placeholder:"Select task type"})}),(0,s.jsx)(o.gC,{children:eI.map(e=>(0,s.jsx)(o.eb,{value:e,children:e.replace(/_/g," ")},e))})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(l.J,{htmlFor:"title",children:"VALIDATION_PROJECT"===S?"Validation Project Name":"Task Name"}),(0,s.jsx)(i.p,{id:"title",placeholder:"VALIDATION_PROJECT"===S?"e.g., New HPLC Method Validation":"e.g., Daily Balances Check",value:V,onChange:e=>J(e.target.value)})]}),"MDL"===S&&(0,s.jsxs)("div",{children:[(0,s.jsx)(l.J,{htmlFor:"instrumentSubtypeMDL",children:"Instrument Subtype"}),(0,s.jsxs)(o.l6,{value:R,onValueChange:e=>M(e),children:[(0,s.jsx)(o.bq,{id:"instrumentSubtypeMDL",children:(0,s.jsx)(o.yv,{placeholder:"Select instrument for MDL"})}),(0,s.jsx)(o.gC,{children:P.oe.map(e=>(0,s.jsx)(o.eb,{value:e,children:e},e))})]})]}),"SOP"===S&&(0,s.jsxs)("div",{children:[(0,s.jsx)(l.J,{htmlFor:"instrumentSubtypeSOP",children:"SOP Subtype"}),(0,s.jsxs)(o.l6,{value:R,onValueChange:e=>M(e),children:[(0,s.jsx)(o.bq,{id:"instrumentSubtypeSOP",children:(0,s.jsx)(o.yv,{placeholder:"Select SOP subtype"})}),(0,s.jsx)(o.gC,{children:P.tk.map(e=>(0,s.jsx)(o.eb,{value:e,children:e},e))})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(l.J,{htmlFor:"description",children:"Description"}),(0,s.jsx)(d.T,{id:"description",placeholder:"Add any relevant details or instructions...",value:F,onChange:e=>q(e.target.value)})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(l.J,{htmlFor:"status",children:"Status"}),(0,s.jsxs)(o.l6,{value:G,onValueChange:e=>B(e),children:[(0,s.jsx)(o.bq,{id:"status",children:(0,s.jsx)(o.yv,{placeholder:"Select status"})}),(0,s.jsx)(o.gC,{children:P.Hi.map(e=>(0,s.jsx)(o.eb,{value:e,children:e},e))})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(l.J,{htmlFor:"priority",children:"Priority"}),(0,s.jsxs)(o.l6,{value:$,onValueChange:e=>z(e),children:[(0,s.jsx)(o.bq,{id:"priority",children:(0,s.jsx)(o.yv,{placeholder:"Select priority"})}),(0,s.jsx)(o.gC,{children:P.PN.map(e=>(0,s.jsx)(o.eb,{value:e,children:e},e))})]})]})]}),"VALIDATION_PROJECT"===S&&(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)(p.S,{id:"isMilestone",checked:ei,onCheckedChange:e=>el(!!e)}),(0,s.jsxs)(l.J,{htmlFor:"isMilestone",className:"flex items-center cursor-pointer",children:[(0,s.jsx)(x.A,{className:"mr-2 h-4 w-4 text-muted-foreground"})," Mark as Milestone"]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(l.J,{htmlFor:"dateRangePicker",children:"VALIDATION_PROJECT"===S&&ei?"Milestone Date":"Date Range (Start - Due)"}),(0,s.jsxs)(c.AM,{open:K,onOpenChange:X,children:[(0,s.jsx)(c.Wv,{asChild:!0,children:(0,s.jsxs)(r.$,{id:"dateRangePicker",variant:"outline",className:"w-full justify-start text-left font-normal",children:[(0,s.jsx)(f.A,{className:"mr-2 h-4 w-4"}),eP]})}),(0,s.jsx)(c.hl,{className:"w-auto p-0",children:(0,s.jsx)(u.V,{mode:"VALIDATION_PROJECT"===S&&ei?"single":"range",selected:"VALIDATION_PROJECT"===S&&ei?Z:{from:Z,to:W},onSelect:e=>{"VALIDATION_PROJECT"===S&&ei?(H(e),U(e)):(H(null==e?void 0:e.from),U(null==e?void 0:e.to)),e&&("VALIDATION_PROJECT"===S&&ei||null==e||!e.from||(null==e?void 0:e.to))&&X(!1)},numberOfMonths:"VALIDATION_PROJECT"===S&&ei?1:2,initialFocus:!0})})]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:["VALIDATION_PROJECT"!==S&&(0,s.jsxs)("div",{children:[(0,s.jsx)(l.J,{htmlFor:"recurrence",children:"Recurrence"}),(0,s.jsxs)(o.l6,{value:Y,onValueChange:e=>Q(e),children:[(0,s.jsx)(o.bq,{id:"recurrence",children:(0,s.jsx)(o.yv,{placeholder:"Select recurrence"})}),(0,s.jsx)(o.gC,{children:P.y4.map(e=>(0,s.jsx)(o.eb,{value:e,children:e},e))})]})]}),(0,s.jsxs)("div",{className:"VALIDATION_PROJECT"===S?"md:col-span-2":"",children:[(0,s.jsx)(l.J,{htmlFor:"assignedTo",children:"Assigned To"}),(0,s.jsxs)(o.l6,{onValueChange:e=>et("__NONE__"===e?void 0:e),value:ee||"__NONE__",disabled:ec||!!ep,children:[(0,s.jsx)(o.bq,{id:"assignedTo_text",children:(0,s.jsx)(o.yv,{placeholder:ec?"Loading employees...":ep?"Error loading employees":"Select employee (Optional)"})}),(0,s.jsxs)(o.gC,{children:[(0,s.jsx)(o.eb,{value:"__NONE__",children:"None"}),ed.map(e=>(0,s.jsxs)(o.eb,{value:e.name,children:[e.name," (",e.role,")"]},e.id))]})]}),ep&&!ec&&(0,s.jsxs)("p",{className:"text-sm text-destructive mt-1 flex items-center",children:[(0,s.jsx)(y.A,{className:"h-4 w-4 mr-1"})," ",ep]})]})]}),"VALIDATION_PROJECT"===S&&(0,s.jsxs)("div",{children:[(0,s.jsx)(l.J,{htmlFor:"dependencies",children:"Dependencies (Optional)"}),(0,s.jsxs)(c.AM,{open:eb,onOpenChange:ek,children:[(0,s.jsx)(c.Wv,{asChild:!0,children:(0,s.jsxs)(r.$,{variant:"outline",className:"w-full justify-start text-left font-normal",disabled:ef||!!ev,children:[(0,s.jsx)(v.A,{className:"mr-2 h-4 w-4"}),ef?"Loading tasks...":ev?"Error loading tasks":ej.length>0?"".concat(ej.length," selected"):"Select tasks"]})}),(0,s.jsxs)(c.hl,{className:"w-[--radix-popover-trigger-width] p-0",children:[ef?(0,s.jsx)("div",{className:"p-4 text-center text-sm",children:"Loading tasks..."}):ev?(0,s.jsx)("div",{className:"p-4 text-center text-sm text-destructive",children:ev}):0===em.length?(0,s.jsx)("div",{className:"p-4 text-center text-sm",children:"No other 'VALIDATION_PROJECT' tasks available to select."}):(0,s.jsx)(h.F,{className:"h-48",children:(0,s.jsx)("div",{className:"p-4 space-y-2",children:em.map(e=>(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)(p.S,{id:"dep-".concat(e.id),checked:ej.includes(e.id),onCheckedChange:()=>eT(e.id)}),(0,s.jsx)("label",{htmlFor:"dep-".concat(e.id),className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70 truncate",title:e.title,children:e.title})]},e.id))})}),(0,s.jsx)("div",{className:"p-2 border-t",children:(0,s.jsx)(r.$,{size:"sm",className:"w-full",onClick:()=>ek(!1),children:"Done"})})]})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(l.J,{htmlFor:"attachments",children:"Attachments"}),(0,s.jsx)("div",{className:"mt-1 flex justify-center px-6 pt-5 pb-6 border-2 border-dashed rounded-md",children:(0,s.jsxs)("div",{className:"space-y-1 text-center",children:[(0,s.jsx)(g,{className:"mx-auto h-12 w-12 text-muted-foreground"}),(0,s.jsxs)("div",{className:"flex text-sm text-muted-foreground",children:[(0,s.jsxs)("label",{htmlFor:"file-upload",className:"relative cursor-pointer rounded-md font-medium text-primary hover:text-primary/80 focus-within:outline-none focus-within:ring-2 focus-within:ring-offset-2 focus-within:ring-ring",children:[(0,s.jsx)("span",{children:"Upload files"}),(0,s.jsx)(i.p,{id:"file-upload",name:"file-upload",type:"file",className:"sr-only",multiple:!0,onChange:e=>{e.target.files&&es(e.target.files)}})]}),(0,s.jsx)("p",{className:"pl-1",children:"or drag and drop"})]}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground",children:"PNG, JPG, PDF, etc. up to 10MB each"}),ea&&ea.length>0&&(0,s.jsxs)("div",{className:"pt-2 text-sm text-muted-foreground",children:["Selected: ",Array.from(ea).map(e=>e.name).join(", ")]})]})})]}),(0,s.jsx)("div",{className:"flex justify-end",children:(0,s.jsxs)(r.$,{type:"submit",disabled:er||ew||"VALIDATION_PROJECT"===S&&!!ev||!!ep,children:[er?(0,s.jsx)(m.A,{className:"mr-2 h-4 w-4 animate-spin"}):(0,s.jsx)(j.A,{className:"mr-2 h-4 w-4"}),"Save Task"]})})]})})]})]}):(0,s.jsx)("div",{className:"space-y-6 max-w-2xl mx-auto",children:(0,s.jsxs)(n.Zp,{className:"shadow-md",children:[(0,s.jsx)(n.aR,{children:(0,s.jsx)(n.ZB,{className:"font-headline",children:"Initializing Task Creation"})}),(0,s.jsx)(n.Wu,{children:(0,s.jsxs)("div",{className:"flex justify-center items-center py-10",children:[(0,s.jsx)(m.A,{className:"h-8 w-8 animate-spin text-primary"}),(0,s.jsx)("p",{className:"ml-2 text-muted-foreground",children:"Initializing task creation form..."})]})})]})})}},97841:(e,t,a)=>{"use strict";a.d(t,{Oc:()=>i,Qu:()=>o,Y$:()=>d,bV:()=>l});var s=a(30645);let r="employees",n=e=>({id:e.id,name:e.name,email:e.email,role:e.role,reportsTo_text:e.reportsTo_text,department_text:e.department_text,userId:e.userId,created:e.created?new Date(e.created):void 0,updated:e.updated?new Date(e.updated):void 0,collectionId:e.collectionId,collectionName:e.collectionName,expand:e.expand}),i=async(e,t)=>{try{let{onRetry:a,signal:i,...l}=t||{},d={sort:"name",fields:"id,name,email,role,department_text,reportsTo_text,userId,created,updated",...l};return(await (0,s.b)(()=>e.collection(r).getFullList(d,{signal:i}),{signal:i,context:"fetching employees list",onRetry:a})).map(n)}catch(e){throw e}},l=async(e,t,a)=>{try{let s=await e.collection(r).create(t,{signal:null==a?void 0:a.signal});return n(s)}catch(e){throw console.error("Failed to create employee:",e),e}},d=async(e,t,a,i)=>{try{let{signal:l}=i||{},d=await (0,s.b)(()=>e.collection(r).update(t,a,{signal:l}),{context:"updating employee ".concat(t),signal:l});return n(d)}catch(e){throw console.error("Failed to update employee ".concat(t,":"),e),e}},o=async(e,t,a)=>{try{let{signal:n}=a||{};await (0,s.b)(()=>e.collection(r).delete(t,{signal:n}),{context:"deleting employee ".concat(t),signal:n})}catch(e){throw console.error("Failed to delete employee ".concat(t,":"),e),e}}}},e=>{var t=t=>e(e.s=t);e.O(0,[383,897,125,977,192,874,889,374,666,575,441,303,358],()=>t(21326)),_N_E=e.O()}]);