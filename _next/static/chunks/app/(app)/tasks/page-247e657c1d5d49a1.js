(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[738],{49478:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>U});var a=s(95155),r=s(12115),n=s(30285),l=s(66695),i=s(85127),o=s(74466),c=s(59434);let d=(0,o.F)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function u(e){let{className:t,variant:s,...r}=e;return(0,a.jsx)("div",{className:(0,c.cn)(d({variant:s}),t),...r})}var h=s(44838),m=s(54165),p=s(17759),x=s(88539),y=s(59409),j=s(14636),g=s(85511),f=s(47262),v=s(66424);let b=(0,s(40157).A)("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);var k=s(34301),_=s(50172),A=s(31949),N=s(3561),D=s(70154),T=s(58127),C=s(18763),I=s(77223),O=s(44972),P=s(51920),V=s(86318),E=s(59119),w=s(73168),S=s(6874),M=s.n(S),L=s(59576),R=s(77694),J=s(97841),q=s(87481),B=s(62177),F=s(90221),z=s(55594),H=s(91950);let Y=e=>{if(!e)return"default";switch(e.toLowerCase()){case"urgent":case"high":return"destructive";case"medium":return"secondary";case"low":return"outline";default:return"default"}},$=e=>{if(!e)return"default";switch(e.toLowerCase()){case"done":return"default";case"in progress":return"secondary";case"overdue":case"blocked":return"destructive";default:return"outline"}},W=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"tasks",s="An unexpected error occurred while managing ".concat(t,".");if(e&&"object"==typeof e){let a=e.context||t;if(!0===e.isCircuitOpenError){let t=e.openUntil;if(t&&Date.now()<t){let e=Math.ceil((t-Date.now())/1e3),s=e>60?"".concat(Math.ceil(e/60)," minute(s)"):"".concat(e," second(s)");return"Too many recent connection issues with '".concat(a,"'. Access is temporarily paused. Please try again in about ").concat(s,".")}return"Access to '".concat(a,"' is temporarily paused due to repeated connection issues. Please try again in a few moments.")}if(!0===e.circuitJustOpened)return"Failed to connect to '".concat(a,"' after multiple attempts. To allow the service to recover, further attempts will be paused for a short period. Please try again in a few moments.");if("status"in e&&0===e.status?s="Failed to load ".concat(a,": Could not connect to the server. Please check your internet connection and try again."):e.data&&"object"==typeof e.data&&e.data.message&&"string"==typeof e.data.message?s=e.data.message:e.message&&"string"==typeof e.message&&!e.message.startsWith("PocketBase_ClientResponseError")?s=e.message:e.originalError&&"string"==typeof e.originalError.message?s=e.originalError.message:e.message&&"string"==typeof e.message&&(s=e.message),"status"in e&&0!==e.status){let t=e.status,r="items";a.includes("task")?r="tasks":a.includes("employee")&&(r="employees");let n=s.startsWith("An unexpected error occurred")||s.startsWith("PocketBase_ClientResponseError")||s===e.message;404===t&&n?s="The requested ".concat(r," could not be found (404)."):403===t&&n?s="You do not have permission to access or modify these ".concat(r," (403)."):n&&s.startsWith("PocketBase_ClientResponseError")?s="A server error occurred (".concat(t,") while managing ").concat(r,". If this persists, please contact support."):n&&(s="".concat(s," (Status: ").concat(t,")"))}}else"string"==typeof e&&(s=e);return s},G=z.Ik({task_type:z.k5(H.ci,{errorMap:()=>({message:"Please select a valid task type."})}),instrument_subtype:z.Yj().optional(),method:z.Yj().optional(),description:z.Yj().optional(),status:z.Yj().min(1,"Status is required."),priority:z.Yj().min(1,"Priority is required."),startDate:z.p6().optional(),dueDate:z.p6().optional(),recurrence:z.k5(H.y4),assignedTo_text:z.Yj().optional(),dependencies:z.YO(z.Yj()).optional(),isMilestone:z.zM().optional()}).superRefine((e,t)=>{var s;"MDL"!==e.task_type||e.instrument_subtype||t.addIssue({code:z.eq.custom,message:"Instrument Subtype is required for MDL tasks.",path:["instrument_subtype"]}),"MDL"===e.task_type&&e.instrument_subtype&&(null==(s=H.xJ[e.instrument_subtype])?void 0:s.length)>0&&!e.method&&t.addIssue({code:z.eq.custom,message:"Method is required for the selected instrument subtype: ".concat(e.instrument_subtype,"."),path:["method"]}),"SOP"!==e.task_type||e.instrument_subtype||t.addIssue({code:z.eq.custom,message:"SOP Subtype is required for SOP tasks.",path:["instrument_subtype"]}),"VALIDATION_PROJECT"===e.task_type?(e.isMilestone&&!e.startDate&&t.addIssue({code:z.eq.custom,message:"Milestone date (Start Date) is required for a Validation Project milestone.",path:["startDate"]}),"None"!==e.recurrence&&t.addIssue({code:z.eq.custom,message:"Recurrence must be 'None' for Validation Projects.",path:["recurrence"]})):"VALIDATION_STEP"===e.task_type?(!0===e.isMilestone&&t.addIssue({code:z.eq.custom,message:"Milestones are not applicable to Validation Step tasks.",path:["isMilestone"]}),e.recurrence&&"None"!==e.recurrence&&t.addIssue({code:z.eq.custom,message:"Recurrence must be 'None' for Validation Step tasks.",path:["recurrence"]})):(e.isMilestone&&t.addIssue({code:z.eq.custom,message:"Milestones are only applicable to 'VALIDATION_PROJECT' tasks.",path:["isMilestone"]}),e.recurrence||t.addIssue({code:z.eq.custom,message:"Recurrence is required for this task type.",path:["recurrence"]})),!("VALIDATION_PROJECT"===e.task_type&&e.isMilestone)&&e.startDate&&e.dueDate&&e.startDate>e.dueDate&&t.addIssue({code:z.eq.custom,message:"Start date must be before or same as due date.",path:["startDate"]})});function U(){let{pbClient:e,user:t}=(0,L.A)(),{toast:s}=(0,q.dj)(),[o,c]=(0,r.useState)([]),[d,S]=(0,r.useState)(!0),[z,U]=(0,r.useState)(null),[Q,X]=(0,r.useState)(null),[Z,K]=(0,r.useState)("incomplete"),[ee,et]=(0,r.useState)([]),[es,ea]=(0,r.useState)(!0),[er,en]=(0,r.useState)(null),[el,ei]=(0,r.useState)([]),[eo,ec]=(0,r.useState)(!0),[ed,eu]=(0,r.useState)(null),[eh,em]=(0,r.useState)(null),[ep,ex]=(0,r.useState)(!1),[ey,ej]=(0,r.useState)(!1),[eg,ef]=(0,r.useState)(!1),[ev,eb]=(0,r.useState)(null),[ek,e_]=(0,r.useState)(!1),eA=(0,B.mN)({resolver:(0,F.u)(G),defaultValues:{task_type:H.ci.find(e=>"VALIDATION_PROJECT"!==e&&"VALIDATION_STEP"!==e)||H.ci[0],instrument_subtype:void 0,method:void 0,dependencies:[],isMilestone:!1,recurrence:"None"}}),eN=eA.watch("task_type"),eD=eA.watch("instrument_subtype"),eT=eA.watch("isMilestone"),eC=eA.watch("startDate"),eI=eA.watch("dueDate");(0,r.useEffect)(()=>{let e=eA.watch((e,t)=>{let{name:s}=t;if("task_type"===s){if("MDL"!==e.task_type&&"SOP"!==e.task_type)eA.setValue("instrument_subtype",void 0,{shouldValidate:!0}),eA.setValue("method",void 0,{shouldValidate:!0});else if("MDL"===e.task_type){let e=eA.getValues("instrument_subtype"),t=eA.getValues("method");e&&H.xJ[e]&&!H.xJ[e].includes(t||"")&&eA.setValue("method",void 0,{shouldValidate:!0})}else"SOP"===e.task_type&&eA.setValue("method",void 0,{shouldValidate:!0});"VALIDATION_PROJECT"===e.task_type||"VALIDATION_STEP"===e.task_type?eA.setValue("recurrence","None",{shouldValidate:!0}):"None"===eA.getValues("recurrence")&&ev&&"None"===ev.recurrence&&"VALIDATION_PROJECT"!==ev.task_type&&ev.task_type,"VALIDATION_STEP"===e.task_type?eA.setValue("isMilestone",!1,{shouldValidate:!0}):"VALIDATION_PROJECT"!==e.task_type&&eA.setValue("isMilestone",!1,{shouldValidate:!0})}if("instrument_subtype"===s&&"MDL"===eA.getValues("task_type")){let t=eA.getValues("method"),s=e.instrument_subtype;s&&H.xJ[s]&&!H.xJ[s].includes(t||"")?eA.setValue("method",void 0,{shouldValidate:!0}):s||eA.setValue("method",void 0,{shouldValidate:!0})}if(("isMilestone"===s||"startDate"===s)&&"VALIDATION_PROJECT"===eA.getValues("task_type")&&eA.getValues("isMilestone")&&eA.getValues("startDate")){var a;let e=eA.getValues("startDate");eA.getValues("dueDate")&&(null==(a=eA.getValues("dueDate"))?void 0:a.getTime())===e.getTime()||eA.setValue("dueDate",e,{shouldValidate:!0})}});return()=>e.unsubscribe()},[eA,ev]);let eO=(0,r.useCallback)(async(e,t)=>{if(!e)return void S(!1);S(!0),U(null),X(null);let a='task_type != "VALIDATION_PROJECT" && task_type != "VALIDATION_STEP"';"incomplete"===Z?a+=' && status != "Done"':"complete"===Z&&(a+=' && status = "Done"');try{let s=await (0,R.x1)(e,{signal:t,onRetry:(e,t,s)=>{let a=s&&0===s.status,r=s&&[502,503,504].includes(s.status);a||r?X("Connection issues, retrying... Attempt ".concat(e," of ").concat(t)):X("Attempting to recover... Attempt ".concat(e," of ").concat(t))},filter:a});c(s),X(null)}catch(a){let e=(null==a?void 0:a.isAbort)===!0||"string"==typeof(null==a?void 0:a.message)&&a.message.toLowerCase().includes("autocancelled"),t=(null==a?void 0:a.status)===0&&!e;if(X(null),e)console.warn("Tasks fetch request was ".concat((null==a?void 0:a.isAbort)?"aborted":"autocancelled","."),a);else if(t){let e=W(a,"tasks");U(e),s({title:"Error Loading Tasks",description:e,variant:"destructive"}),console.warn("Tasks fetch (network error):",e,a)}else{let e=W(a,"tasks");U(e),s({title:"Error Loading Tasks",description:e,variant:"destructive"}),console.warn("Error fetching tasks (after retries):",e,a)}}finally{S(!1)}},[s,Z]),eP=(0,r.useCallback)(async(e,t)=>{if(!e)return void ea(!1);ea(!0),en(null);try{let s=await (0,J.Oc)(e,{signal:t,onRetry:(e,t,s)=>{X("Retrying employee data... Attempt ".concat(e," of ").concat(t))}});et(s)}catch(t){let e=(null==t?void 0:t.isAbort)===!0||"string"==typeof(null==t?void 0:t.message)&&t.message.toLowerCase().includes("autocancelled");if(e)console.warn("Fetch employees for task edit request was ".concat((null==t?void 0:t.isAbort)?"aborted":"autocancelled","."),t);else if((null==t?void 0:t.status)!==0||e){let e=W(t,"employees for task assignment");en(e),s({title:"Error Loading Employees",description:e,variant:"destructive"}),console.warn("Error fetching employees for task edit (after retries):",e,t)}else{let e=W(t,"employees for task assignment");en(e),s({title:"Error Loading Employees",description:e,variant:"destructive"}),console.warn("Fetch employees for task edit (network error):",e,t)}}finally{ea(!1)}},[s]),eV=(0,r.useCallback)(async(e,t,a)=>{if(!e)return void ec(!1);ec(!0),eu(null),em(null);try{let s=await (0,R.x1)(e,{signal:a,onRetry:(e,t,s)=>{em("Retrying tasks for selection... Attempt ".concat(e," of ").concat(t))}}),r=t?s.filter(e=>e.id!==t):s;ei(r),em(null)}catch(a){em(null);let e=(null==a?void 0:a.isAbort)===!0||"string"==typeof(null==a?void 0:a.message)&&a.message.toLowerCase().includes("autocancelled"),t=(null==a?void 0:a.status)===0&&!e;if(e)console.warn("Fetch tasks for edit dependency selection request was ".concat((null==a?void 0:a.isAbort)?"aborted":"autocancelled","."),a);else if(t){let e=W(a,"tasks for dependency selection (edit)");eu(e),s({title:"Error Loading Tasks for Dependencies",description:e,variant:"destructive"}),console.warn("Fetch tasks for edit dependency selection (network error):",e,a)}else{let e=W(a,"tasks for dependency selection (edit)");eu(e),s({title:"Error Loading Tasks for Dependencies",description:e,variant:"destructive"}),console.warn("Error fetching tasks for edit dependency selection (after retries):",e,a)}}finally{ec(!1)}},[s]);(0,r.useEffect)(()=>{let t=new AbortController;return e?(eO(e,t.signal),eP(e,t.signal)):(S(!0),ea(!0)),()=>{t.abort()}},[e,eO,eP,Z]),(0,r.useEffect)(()=>{if(eg&&ev&&e&&"VALIDATION_STEP"!==ev.task_type){let t=new AbortController;return eV(e,ev.id,t.signal),()=>t.abort()}(!eg||ev&&"VALIDATION_STEP"===ev.task_type)&&(ei([]),ec(!1))},[eg,ev,e,eV]),(0,r.useEffect)(()=>{ev&&eA.reset({task_type:ev.task_type,instrument_subtype:ev.instrument_subtype||void 0,method:ev.method||void 0,description:ev.description||"",status:ev.status,priority:ev.priority,startDate:ev.startDate?new Date(ev.startDate):void 0,dueDate:ev.dueDate?new Date(ev.dueDate):void 0,recurrence:"VALIDATION_PROJECT"===ev.task_type||"VALIDATION_STEP"===ev.task_type?"None":ev.recurrence||"None",assignedTo_text:ev.assignedTo_text||"",dependencies:Array.isArray(ev.dependencies)?ev.dependencies:[],isMilestone:"VALIDATION_STEP"!==ev.task_type&&(ev.isMilestone||!1)})},[ev,eA]);let eE=(0,r.useCallback)(async(t,a)=>{if(!e)return void s({title:"Error",description:"Client not available.",variant:"destructive"});let r="Done"===a?"To Do":"Done";c(o.map(e=>e.id===t?{...e,status:r}:e));try{let a=await (0,R.lC)(e,t,{status:r});c(e=>e.map(e=>e.id===a.id?a:e)),s({title:"Success",description:"Task marked as ".concat(r,".")})}catch(e){console.warn("Error updating task status:",e),c(o),s({title:"Error",description:"Failed to update task status: ".concat(W(e)),variant:"destructive"})}},[e,s,o]),ew=(0,r.useCallback)(async t=>{if(!e)return void s({title:"Error",description:"Client not available.",variant:"destructive"});let a=[...o];c(e=>e.filter(e=>e.id!==t));try{await (0,R.vq)(e,t),s({title:"Success",description:"Task deleted successfully."})}catch(e){console.warn("Error deleting task:",e),c(a),s({title:"Error",description:W(e),variant:"destructive"})}},[e,s,o]),eS=(0,r.useCallback)(e=>{eb(e),ef(!0)},[]),eM=()=>{ef(!1),eb(null),eA.reset(),ei([]),ex(!1),ej(!1)},eL=async a=>{var r,n,l,i,o,d,u;if(!ev||!e||!t)return void s({title:"Error",description:"Editing context, client or user not available.",variant:"destructive"});e_(!0);let h={title:a.task_type,task_type:a.task_type,instrument_subtype:"MDL"===a.task_type||"SOP"===a.task_type?a.instrument_subtype:void 0,method:"MDL"===a.task_type&&a.instrument_subtype&&(null==(r=H.xJ[a.instrument_subtype])?void 0:r.length)>0?a.method:void 0,description:a.description,status:a.status,priority:a.priority,startDate:a.startDate,dueDate:"VALIDATION_PROJECT"===a.task_type&&a.isMilestone&&a.startDate?a.startDate:a.dueDate,recurrence:a.recurrence,assignedTo_text:"__NONE__"!==a.assignedTo_text&&a.assignedTo_text?a.assignedTo_text:void 0,isMilestone:"VALIDATION_PROJECT"===a.task_type&&a.isMilestone,dependencies:"VALIDATION_STEP"===a.task_type?ev.dependencies:a.dependencies||[],userId:t.id};try{let t=await (0,R.lC)(e,ev.id,h);c(e=>e.map(e=>e.id===t.id?t:e)),s({title:"Success",description:"Task updated successfully."}),eM()}catch(t){console.warn("Failed to update task:",t);let e=W(t);(null==(i=t.data)||null==(l=i.data)||null==(n=l.instrument_subtype)?void 0:n.message)?e="Instrument Subtype: ".concat(t.data.data.instrument_subtype.message):(null==(u=t.data)||null==(d=u.data)||null==(o=d.method)?void 0:o.message)&&(e="Method: ".concat(t.data.data.method.message)),s({title:"Error Updating Task",description:e,variant:"destructive"})}finally{e_(!1)}},eR="Pick a date";eR="VALIDATION_PROJECT"===eN&&eT?eC?"Milestone: ".concat((0,w.GP)(eC,"PPP")):"Pick Milestone Date":eC&&eI?"".concat((0,w.GP)(eC,"PPP")," - ").concat((0,w.GP)(eI,"PPP")):eC?"".concat((0,w.GP)(eC,"PPP")," - Select End Date"):"Pick Date Range";let eJ=d||es,eq=Z.charAt(0).toUpperCase()+Z.slice(1),eB=(0,r.useMemo)(()=>"MDL"===eN&&eD&&H.xJ[eD]?H.xJ[eD]:[],[eN,eD]);return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("h1",{className:"text-2xl md:text-3xl font-headline font-semibold",children:"Task Management"}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsxs)(h.rI,{children:[(0,a.jsx)(h.ty,{asChild:!0,children:(0,a.jsxs)(n.$,{variant:"outline",children:[(0,a.jsx)(b,{className:"mr-2 h-4 w-4"})," Filter: ",eq]})}),(0,a.jsxs)(h.SQ,{align:"end",className:"w-48",children:[(0,a.jsx)(h.lp,{children:"Filter by Status"}),(0,a.jsx)(h.mB,{}),(0,a.jsxs)(h.Hr,{value:Z,onValueChange:e=>K(e),children:[(0,a.jsx)(h.Ht,{value:"incomplete",children:"Incomplete"}),(0,a.jsx)(h.Ht,{value:"complete",children:"Complete"}),(0,a.jsx)(h.Ht,{value:"all",children:"All"})]})]})]}),(0,a.jsx)(M(),{href:"/tasks/new",passHref:!0,children:(0,a.jsxs)(n.$,{children:[(0,a.jsx)(k.A,{className:"mr-2 h-4 w-4"})," Add Task"]})})]})]}),(0,a.jsxs)(l.Zp,{className:"shadow-md",children:[(0,a.jsxs)(l.aR,{children:[(0,a.jsxs)(l.ZB,{className:"font-headline",children:["Task List (",eq,")"]}),(0,a.jsx)(l.BT,{children:"View, manage, and track laboratory tasks based on the selected filter. (Excludes Validation Projects & Steps)."})]}),(0,a.jsxs)(l.Wu,{children:[eJ&&(0,a.jsxs)("div",{className:"flex justify-center items-center py-10",children:[(0,a.jsx)(_.A,{className:"h-8 w-8 animate-spin text-primary"}),(0,a.jsx)("p",{className:"ml-2",children:Q||"Loading tasks and employee data..."})]}),z&&!eJ&&!Q&&(0,a.jsxs)("div",{className:"text-center py-10 text-destructive",children:[(0,a.jsx)(A.A,{className:"mx-auto h-12 w-12 text-destructive"}),(0,a.jsx)("p",{className:"mt-4 text-lg font-semibold",children:"Failed to Load Tasks"}),(0,a.jsx)("p",{className:"text-sm",children:z}),(0,a.jsx)(n.$,{onClick:()=>{e&&eO(e,new AbortController().signal)},className:"mt-6",children:"Try Again"})]}),!eJ&&!z&&0===o.length&&(0,a.jsxs)("div",{className:"text-center py-10 text-muted-foreground",children:[(0,a.jsxs)("p",{children:['No tasks found matching the current filter: "',eq,'".']}),"all"!==Z&&(0,a.jsx)("p",{className:"text-sm",children:"Try selecting a different filter or adding new tasks."})]}),!eJ&&!z&&o.length>0&&(0,a.jsxs)(i.XI,{children:[(0,a.jsx)(i.A0,{children:(0,a.jsxs)(i.Hj,{children:[(0,a.jsx)(i.nd,{children:"Name / Details"}),(0,a.jsx)(i.nd,{children:"Status"}),(0,a.jsx)(i.nd,{children:"Priority"}),(0,a.jsx)(i.nd,{children:"Due Date"}),(0,a.jsx)(i.nd,{children:"Assigned To"}),(0,a.jsx)(i.nd,{className:"text-right",children:"Actions"})]})}),(0,a.jsx)(i.BF,{children:o.map(e=>(0,a.jsxs)(i.Hj,{className:"hover:bg-muted/50 transition-colors",children:[(0,a.jsxs)(i.nA,{children:[(0,a.jsx)("div",{className:"font-medium",children:e.title.replace(/_/g," ")}),("MDL"===e.task_type||"SOP"===e.task_type)&&e.instrument_subtype&&(0,a.jsx)("div",{className:"text-xs text-muted-foreground",children:e.instrument_subtype}),"MDL"===e.task_type&&e.method&&(0,a.jsx)("div",{className:"text-xs text-muted-foreground",children:e.method}),e.description&&"MDL"!==e.task_type&&"SOP"!==e.task_type&&(0,a.jsx)("div",{className:"text-xs text-muted-foreground truncate max-w-xs",title:e.description,children:e.description}),("MDL"!==e.task_type&&"SOP"!==e.task_type||!e.instrument_subtype)&&!e.description&&!e.method&&(0,a.jsx)("div",{className:"text-xs text-muted-foreground",children:"-"})]}),(0,a.jsx)(i.nA,{children:(0,a.jsx)(u,{variant:$(e.status),children:e.status})}),(0,a.jsx)(i.nA,{children:(0,a.jsx)(u,{variant:Y(e.priority),children:e.priority})}),(0,a.jsxs)(i.nA,{children:[e.dueDate?(0,w.GP)(new Date(e.dueDate),"MMM dd, yyyy"):"-",e.recurrence&&"None"!==e.recurrence&&(0,a.jsxs)("span",{className:"block text-xs text-muted-foreground",children:["Repeats: ",e.recurrence]})]}),(0,a.jsx)(i.nA,{children:e.assignedTo_text||"-"}),(0,a.jsx)(i.nA,{className:"text-right",children:(0,a.jsxs)(h.rI,{children:[(0,a.jsx)(h.ty,{asChild:!0,children:(0,a.jsx)(n.$,{variant:"ghost",size:"icon",children:(0,a.jsx)(N.A,{className:"h-4 w-4"})})}),(0,a.jsxs)(h.SQ,{align:"end",children:[(0,a.jsxs)(h._2,{onClick:()=>eE(e.id,e.status),className:"flex items-center w-full",children:["Done"===e.status?(0,a.jsx)(D.A,{className:"mr-2 h-4 w-4"}):(0,a.jsx)(T.A,{className:"mr-2 h-4 w-4"}),"Done"===e.status?"Mark as To Do":"Mark as Done"]}),(0,a.jsxs)(h._2,{onClick:()=>eS(e),className:"flex items-center w-full",children:[(0,a.jsx)(C.A,{className:"mr-2 h-4 w-4"})," Edit"]}),(0,a.jsxs)(h._2,{className:"text-destructive focus:text-destructive focus:bg-destructive/10",onClick:()=>ew(e.id),children:[(0,a.jsx)(I.A,{className:"mr-2 h-4 w-4"})," Delete"]})]})]})})]},e.id))})]})]})]}),ev&&(0,a.jsx)(m.lG,{open:eg,onOpenChange:e=>{e?ef(!0):eM()},children:(0,a.jsxs)(m.Cf,{className:"sm:max-w-lg",children:[(0,a.jsxs)(m.c7,{children:[(0,a.jsxs)(m.L3,{className:"font-headline",children:["Edit Task: ",ev.title.replace(/_/g," ")]}),(0,a.jsx)(m.rr,{children:"Make changes to the task details below."})]}),(0,a.jsx)(p.lV,{...eA,children:(0,a.jsxs)("form",{onSubmit:eA.handleSubmit(eL),className:"space-y-4 py-4 max-h-[70vh] overflow-y-auto pr-2",children:[(0,a.jsx)(p.zB,{control:eA.control,name:"task_type",render:e=>{let{field:t}=e;return(0,a.jsxs)(p.eI,{children:[(0,a.jsx)(p.lR,{children:"Task Name"}),(0,a.jsxs)(y.l6,{onValueChange:t.onChange,value:t.value,disabled:!0,children:[(0,a.jsx)(p.MJ,{children:(0,a.jsx)(y.bq,{children:(0,a.jsx)(y.yv,{placeholder:"Select task name"})})}),(0,a.jsx)(y.gC,{children:H.ci.filter(e=>"VALIDATION_PROJECT"!==e&&"VALIDATION_STEP"!==e).map(e=>(0,a.jsx)(y.eb,{value:e,children:e.replace(/_/g," ")},e))})]}),(0,a.jsx)(p.C5,{})]})}}),"MDL"===eN&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(p.zB,{control:eA.control,name:"instrument_subtype",render:e=>{let{field:t}=e;return(0,a.jsxs)(p.eI,{children:[(0,a.jsx)(p.lR,{children:"Instrument Subtype"}),(0,a.jsxs)(y.l6,{onValueChange:t.onChange,value:t.value||"",children:[(0,a.jsx)(p.MJ,{children:(0,a.jsx)(y.bq,{children:(0,a.jsx)(y.yv,{placeholder:"Select instrument for MDL"})})}),(0,a.jsx)(y.gC,{children:H.oe.map(e=>(0,a.jsx)(y.eb,{value:e,children:e},e))})]}),(0,a.jsx)(p.C5,{})]})}}),eD&&eB.length>0&&(0,a.jsx)(p.zB,{control:eA.control,name:"method",render:e=>{let{field:t}=e;return(0,a.jsxs)(p.eI,{children:[(0,a.jsx)(p.lR,{children:"Method"}),(0,a.jsxs)(y.l6,{onValueChange:t.onChange,value:t.value||"",children:[(0,a.jsx)(p.MJ,{children:(0,a.jsx)(y.bq,{children:(0,a.jsx)(y.yv,{placeholder:"Select method"})})}),(0,a.jsx)(y.gC,{children:eB.map(e=>(0,a.jsx)(y.eb,{value:e,children:e},e))})]}),(0,a.jsx)(p.C5,{})]})}})]}),"SOP"===eN&&(0,a.jsx)(p.zB,{control:eA.control,name:"instrument_subtype",render:e=>{let{field:t}=e;return(0,a.jsxs)(p.eI,{children:[(0,a.jsx)(p.lR,{children:"SOP Subtype"}),(0,a.jsxs)(y.l6,{onValueChange:t.onChange,value:t.value||"",children:[(0,a.jsx)(p.MJ,{children:(0,a.jsx)(y.bq,{children:(0,a.jsx)(y.yv,{placeholder:"Select SOP subtype"})})}),(0,a.jsx)(y.gC,{children:H.tk.map(e=>(0,a.jsx)(y.eb,{value:e,children:e},e))})]}),(0,a.jsx)(p.C5,{})]})}}),(0,a.jsx)(p.zB,{control:eA.control,name:"description",render:e=>{let{field:t}=e;return(0,a.jsxs)(p.eI,{children:[(0,a.jsx)(p.lR,{children:"Description (Optional)"}),(0,a.jsx)(p.MJ,{children:(0,a.jsx)(x.T,{...t,placeholder:"Add any relevant details..."})}),(0,a.jsx)(p.C5,{})]})}}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsx)(p.zB,{control:eA.control,name:"status",render:e=>{let{field:t}=e;return(0,a.jsxs)(p.eI,{children:[(0,a.jsx)(p.lR,{children:"Status"}),(0,a.jsxs)(y.l6,{onValueChange:t.onChange,value:t.value,children:[(0,a.jsx)(p.MJ,{children:(0,a.jsx)(y.bq,{children:(0,a.jsx)(y.yv,{placeholder:"Select status"})})}),(0,a.jsx)(y.gC,{children:H.Hi.map(e=>(0,a.jsx)(y.eb,{value:e,children:e},e))})]}),(0,a.jsx)(p.C5,{})]})}}),(0,a.jsx)(p.zB,{control:eA.control,name:"priority",render:e=>{let{field:t}=e;return(0,a.jsxs)(p.eI,{children:[(0,a.jsx)(p.lR,{children:"Priority"}),(0,a.jsxs)(y.l6,{onValueChange:t.onChange,value:t.value,children:[(0,a.jsx)(p.MJ,{children:(0,a.jsx)(y.bq,{children:(0,a.jsx)(y.yv,{placeholder:"Select priority"})})}),(0,a.jsx)(y.gC,{children:H.PN.map(e=>(0,a.jsx)(y.eb,{value:e,children:e},e))})]}),(0,a.jsx)(p.C5,{})]})}})]}),"VALIDATION_PROJECT"===eN&&(0,a.jsx)(p.zB,{control:eA.control,name:"isMilestone",render:e=>{let{field:t}=e;return(0,a.jsxs)(p.eI,{className:"flex flex-row items-center space-x-2 space-y-0 py-2",children:[(0,a.jsx)(p.MJ,{children:(0,a.jsx)(f.S,{checked:t.value,onCheckedChange:t.onChange})}),(0,a.jsxs)(p.lR,{className:"font-normal flex items-center cursor-pointer mb-0!",children:[(0,a.jsx)(O.A,{className:"mr-2 h-4 w-4 text-muted-foreground"})," Mark as Milestone"]}),(0,a.jsx)(p.C5,{})]})}}),(0,a.jsxs)("div",{children:[(0,a.jsx)(p.lR,{children:"VALIDATION_PROJECT"===eN&&eT?"Milestone Date":"Date Range (Start - Due)"}),(0,a.jsxs)(j.AM,{open:ey,onOpenChange:ej,children:[(0,a.jsx)(j.Wv,{asChild:!0,children:(0,a.jsxs)(n.$,{variant:"outline",className:"w-full justify-start text-left font-normal mt-2",children:[(0,a.jsx)(P.A,{className:"mr-2 h-4 w-4"}),eR]})}),(0,a.jsx)(j.hl,{className:"w-auto p-0",children:(0,a.jsx)(g.V,{mode:"VALIDATION_PROJECT"===eN&&eT?"single":"range",selected:"VALIDATION_PROJECT"===eN&&eT?eC:{from:eC,to:eI},onSelect:e=>{let t=eA.getValues("task_type"),s=eA.getValues("isMilestone");"VALIDATION_PROJECT"===t&&s?(eA.setValue("startDate",e,{shouldValidate:!0}),eA.setValue("dueDate",e,{shouldValidate:!0})):(eA.setValue("startDate",null==e?void 0:e.from,{shouldValidate:!0}),eA.setValue("dueDate",null==e?void 0:e.to,{shouldValidate:!0})),e&&("VALIDATION_PROJECT"===t&&s||null==e||!e.from||(null==e?void 0:e.to))&&ej(!1)},numberOfMonths:"VALIDATION_PROJECT"===eN&&eT?1:2,initialFocus:!0})})]}),(0,a.jsx)(p.zB,{control:eA.control,name:"startDate",render:()=>(0,a.jsx)(p.C5,{})}),(0,a.jsx)(p.zB,{control:eA.control,name:"dueDate",render:()=>(0,a.jsx)(p.C5,{})})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:["VALIDATION_PROJECT"!==eN&&"VALIDATION_STEP"!==eN&&(0,a.jsx)(p.zB,{control:eA.control,name:"recurrence",render:e=>{let{field:t}=e;return(0,a.jsxs)(p.eI,{children:[(0,a.jsx)(p.lR,{children:"Recurrence"}),(0,a.jsxs)(y.l6,{onValueChange:t.onChange,value:t.value,children:[(0,a.jsx)(p.MJ,{children:(0,a.jsx)(y.bq,{children:(0,a.jsx)(y.yv,{placeholder:"Select recurrence"})})}),(0,a.jsx)(y.gC,{children:H.y4.map(e=>(0,a.jsx)(y.eb,{value:e,children:e},e))})]}),(0,a.jsx)(p.C5,{})]})}}),(0,a.jsx)(p.zB,{control:eA.control,name:"assignedTo_text",render:e=>{let{field:t}=e;return(0,a.jsxs)(p.eI,{className:"VALIDATION_PROJECT"===eN||"VALIDATION_STEP"===eN||"MDL"===eN&&eB.length>0?"md:col-span-2":"",children:[(0,a.jsx)(p.lR,{children:"Assigned To (Optional)"}),(0,a.jsxs)(y.l6,{onValueChange:t.onChange,value:t.value||"__NONE__",disabled:es||!!er,children:[(0,a.jsx)(p.MJ,{children:(0,a.jsx)(y.bq,{children:(0,a.jsx)(y.yv,{placeholder:es?"Loading...":er?"Error":"Select employee"})})}),(0,a.jsxs)(y.gC,{children:[(0,a.jsx)(y.eb,{value:"__NONE__",children:"None"}),ee.map(e=>(0,a.jsxs)(y.eb,{value:e.name,children:[e.name," (",e.role,")"]},e.id))]})]}),er&&!es&&(0,a.jsxs)("p",{className:"text-sm text-destructive mt-1 flex items-center",children:[(0,a.jsx)(A.A,{className:"h-4 w-4 mr-1"})," ",er]}),(0,a.jsx)(p.C5,{})]})}})]}),"VALIDATION_STEP"!==eN&&(0,a.jsx)(p.zB,{control:eA.control,name:"dependencies",render:e=>{let{field:t}=e;return(0,a.jsxs)(p.eI,{children:[(0,a.jsx)(p.lR,{children:"Dependencies (Optional)"}),(0,a.jsxs)(j.AM,{open:ep,onOpenChange:ex,children:[(0,a.jsx)(j.Wv,{asChild:!0,children:(0,a.jsxs)(n.$,{variant:"outline",className:"w-full justify-start text-left font-normal",disabled:eo||!!ed,children:[(0,a.jsx)(V.A,{className:"mr-2 h-4 w-4"}),eo?"Loading tasks...":ed?"Error loading tasks":t.value&&t.value.length>0?"".concat(t.value.length," selected"):"Select dependent tasks"]})}),(0,a.jsxs)(j.hl,{className:"w-[--radix-popover-trigger-width] p-0",children:[eh&&(0,a.jsx)("div",{className:"p-4 text-center text-sm text-orange-600",children:eh}),eo&&!eh?(0,a.jsx)("div",{className:"p-4 text-center text-sm",children:"Loading tasks..."}):ed&&!eh?(0,a.jsx)("div",{className:"p-4 text-center text-sm text-destructive",children:ed}):eo||ed||0!==el.length||eh?!eh&&!ed&&(0,a.jsx)(v.F,{className:"h-48",children:(0,a.jsx)("div",{className:"p-4 space-y-2",children:el.map(e=>{var s;return(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(f.S,{id:"edit-dep-".concat(e.id),checked:null==(s=t.value)?void 0:s.includes(e.id),onCheckedChange:s=>{let a=t.value||[];return s?t.onChange([...a,e.id]):t.onChange(a.filter(t=>t!==e.id))}}),(0,a.jsxs)("label",{htmlFor:"edit-dep-".concat(e.id),className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70 truncate",title:e.title,children:[e.title," (",e.task_type.replace(/_/g," "),")"]})]},e.id)})})}):(0,a.jsx)("div",{className:"p-4 text-center text-sm",children:"No other tasks available to select."}),!eh&&!eo&&(0,a.jsx)("div",{className:"p-2 border-t",children:(0,a.jsx)(n.$,{type:"button",size:"sm",className:"w-full",onClick:()=>ex(!1),children:"Done"})})]})]}),(0,a.jsx)(p.C5,{})]})}}),(0,a.jsxs)(m.Es,{children:[(0,a.jsx)(m.HM,{asChild:!0,children:(0,a.jsx)(n.$,{type:"button",variant:"outline",onClick:eM,disabled:ek,children:"Cancel"})}),(0,a.jsxs)(n.$,{type:"submit",disabled:ek||es||eo&&"VALIDATION_STEP"!==eN,children:[ek?(0,a.jsx)(_.A,{className:"mr-2 h-4 w-4 animate-spin"}):(0,a.jsx)(E.A,{className:"mr-2 h-4 w-4"}),"Save Changes"]})]})]})})]})})]})}},58127:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(40157).A)("CircleCheck",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]])},66424:(e,t,s)=>{"use strict";s.d(t,{F:()=>i});var a=s(95155),r=s(12115),n=s(47655),l=s(59434);let i=r.forwardRef((e,t)=>{let{className:s,children:r,...i}=e;return(0,a.jsxs)(n.bL,{ref:t,className:(0,l.cn)("relative overflow-hidden",s),...i,children:[(0,a.jsx)(n.LM,{className:"h-full w-full rounded-[inherit]",children:r}),(0,a.jsx)(o,{}),(0,a.jsx)(n.OK,{})]})});i.displayName=n.bL.displayName;let o=r.forwardRef((e,t)=>{let{className:s,orientation:r="vertical",...i}=e;return(0,a.jsx)(n.VM,{ref:t,orientation:r,className:(0,l.cn)("flex touch-none select-none transition-colors","vertical"===r&&"h-full w-2.5 border-l border-l-transparent p-[1px]","horizontal"===r&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",s),...i,children:(0,a.jsx)(n.lr,{className:"relative flex-1 rounded-full bg-border"})})});o.displayName=n.VM.displayName},82159:(e,t,s)=>{Promise.resolve().then(s.bind(s,49478))},88539:(e,t,s)=>{"use strict";s.d(t,{T:()=>l});var a=s(95155),r=s(12115),n=s(59434);let l=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("textarea",{className:(0,n.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",s),ref:t,...r})});l.displayName="Textarea"},91950:(e,t,s)=>{"use strict";s.d(t,{C3:()=>l,Hi:()=>a,PN:()=>r,ci:()=>i,oe:()=>c,tk:()=>d,xJ:()=>o,y4:()=>n});let a=["To Do","In Progress","Blocked","Done","Overdue"],r=["Low","Medium","High","Urgent"],n=["None","Daily","Weekly","Monthly","Yearly"],l="LabFlow",i=["MDL","SOP","IA","iDOC","oDOC","VALIDATION_PROJECT","VALIDATION_STEP"],o={"Hydra AA":["Mercury by EPA 245.1","Mercury by EPA 7471B & 7470A"],"Hydra II":["Mercury by EPA 245.1","Mercury by EPA 7471B & 7470A"],"PE Optima 5300V":["Metals by EPA 200.7"],"PE Optima 8300":["Metals by EPA 200.7"],"iCAP 7400 DUO":["Metals by EPA 200.7"],"PE Optima 7300V":["Metals by EPA 200.7"],"PE Elan 9000":["Metals by EPA 200.8"],"Agilent 7900":["Metals by EPA 200.8"],"PE NexION 300X":[],"PE NexION 300D":[]},c=Object.keys(o),d=(()=>{let e=[];for(let t=0;t<=16;t++)e.push("BOL50".concat(String(t).padStart(2,"0")));for(let t=18;t<=24;t++)e.push("BOL50".concat(String(t).padStart(2,"0")));for(let t=26;t<=28;t++)e.push("BOL50".concat(String(t).padStart(2,"0")));for(let t=0;t<=2;t++)e.push("BOL55".concat(String(t).padStart(2,"0")));return e})()}},e=>{var t=t=>e(e.s=t);e.O(0,[383,90,386,198,977,874,859,452,767,934,945,69,876,844,411,441,303,358],()=>t(82159)),_N_E=e.O()}]);