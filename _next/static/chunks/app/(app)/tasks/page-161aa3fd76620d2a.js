(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2738],{3561:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(40157).A)("Ellipsis",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]])},9572:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(40157).A)("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]])},17759:(e,t,s)=>{"use strict";s.d(t,{C5:()=>y,MJ:()=>f,eI:()=>h,lR:()=>x,lV:()=>o,zB:()=>u});var a=s(95155),r=s(12115),n=s(99708),l=s(62177),i=s(59434),d=s(85057);let o=l.Op,c=r.createContext({}),u=e=>{let{...t}=e;return(0,a.jsx)(c.Provider,{value:{name:t.name},children:(0,a.jsx)(l.xI,{...t})})},m=()=>{let e=r.useContext(c),t=r.useContext(p),{getFieldState:s,formState:a}=(0,l.xW)(),n=s(e.name,a);if(!e)throw Error("useFormField should be used within <FormField>");let{id:i}=t;return{id:i,name:e.name,formItemId:"".concat(i,"-form-item"),formDescriptionId:"".concat(i,"-form-item-description"),formMessageId:"".concat(i,"-form-item-message"),...n}},p=r.createContext({}),h=r.forwardRef((e,t)=>{let{className:s,...n}=e,l=r.useId();return(0,a.jsx)(p.Provider,{value:{id:l},children:(0,a.jsx)("div",{ref:t,className:(0,i.cn)("space-y-2",s),...n})})});h.displayName="FormItem";let x=r.forwardRef((e,t)=>{let{className:s,...r}=e,{error:n,formItemId:l}=m();return(0,a.jsx)(d.J,{ref:t,className:(0,i.cn)(n&&"text-destructive",s),htmlFor:l,...r})});x.displayName="FormLabel";let f=r.forwardRef((e,t)=>{let{...s}=e,{error:r,formItemId:l,formDescriptionId:i,formMessageId:d}=m();return(0,a.jsx)(n.DX,{ref:t,id:l,"aria-describedby":r?"".concat(i," ").concat(d):"".concat(i),"aria-invalid":!!r,...s})});f.displayName="FormControl",r.forwardRef((e,t)=>{let{className:s,...r}=e,{formDescriptionId:n}=m();return(0,a.jsx)("p",{ref:t,id:n,className:(0,i.cn)("text-sm text-muted-foreground",s),...r})}).displayName="FormDescription";let y=r.forwardRef((e,t)=>{var s;let{className:r,children:n,...l}=e,{error:d,formMessageId:o}=m(),c=d?String(null!=(s=null==d?void 0:d.message)?s:""):n;return c?(0,a.jsx)("p",{ref:t,id:o,className:(0,i.cn)("text-sm font-medium text-destructive",r),...l,children:c}):null});y.displayName="FormMessage"},18763:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(40157).A)("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]])},25318:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(40157).A)("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]])},26126:(e,t,s)=>{"use strict";s.d(t,{E:()=>i});var a=s(95155);s(12115);var r=s(74466),n=s(59434);let l=(0,r.F)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function i(e){let{className:t,variant:s,...r}=e;return(0,a.jsx)("div",{className:(0,n.cn)(l({variant:s}),t),...r})}},34301:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(40157).A)("CirclePlus",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]])},44838:(e,t,s)=>{"use strict";s.d(t,{Hr:()=>m,Ht:()=>x,SQ:()=>p,_2:()=>h,lp:()=>f,mB:()=>y,rI:()=>c,ty:()=>u});var a=s(95155),r=s(12115),n=s(48698),l=s(73158),i=s(10518),d=s(70154),o=s(59434);let c=n.bL,u=n.l9;n.YJ,n.ZL,n.Pb;let m=n.z6;r.forwardRef((e,t)=>{let{className:s,inset:r,children:i,...d}=e;return(0,a.jsxs)(n.ZP,{ref:t,className:(0,o.cn)("flex cursor-default gap-2 select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",r&&"pl-8",s),...d,children:[i,(0,a.jsx)(l.A,{className:"ml-auto"})]})}).displayName=n.ZP.displayName,r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(n.G5,{ref:t,className:(0,o.cn)("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",s),...r})}).displayName=n.G5.displayName;let p=r.forwardRef((e,t)=>{let{className:s,sideOffset:r=4,...l}=e;return(0,a.jsx)(n.ZL,{children:(0,a.jsx)(n.UC,{ref:t,sideOffset:r,className:(0,o.cn)("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",s),...l})})});p.displayName=n.UC.displayName;let h=r.forwardRef((e,t)=>{let{className:s,inset:r,...l}=e;return(0,a.jsx)(n.q7,{ref:t,className:(0,o.cn)("relative flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",r&&"pl-8",s),...l})});h.displayName=n.q7.displayName,r.forwardRef((e,t)=>{let{className:s,children:r,checked:l,...d}=e;return(0,a.jsxs)(n.H_,{ref:t,className:(0,o.cn)("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",s),checked:l,...d,children:[(0,a.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,a.jsx)(n.VF,{children:(0,a.jsx)(i.A,{className:"h-4 w-4"})})}),r]})}).displayName=n.H_.displayName;let x=r.forwardRef((e,t)=>{let{className:s,children:r,...l}=e;return(0,a.jsxs)(n.hN,{ref:t,className:(0,o.cn)("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",s),...l,children:[(0,a.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,a.jsx)(n.VF,{children:(0,a.jsx)(d.A,{className:"h-2 w-2 fill-current"})})}),r]})});x.displayName=n.hN.displayName;let f=r.forwardRef((e,t)=>{let{className:s,inset:r,...l}=e;return(0,a.jsx)(n.JU,{ref:t,className:(0,o.cn)("px-2 py-1.5 text-sm font-semibold",r&&"pl-8",s),...l})});f.displayName=n.JU.displayName;let y=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(n.wv,{ref:t,className:(0,o.cn)("-mx-1 my-1 h-px bg-muted",s),...r})});y.displayName=n.wv.displayName},46102:(e,t,s)=>{"use strict";s.d(t,{Bc:()=>i,ZI:()=>c,k$:()=>o,m_:()=>d});var a=s(95155),r=s(12115),n=s(89613),l=s(59434);let i=n.Kq,d=n.bL,o=n.l9,c=r.forwardRef((e,t)=>{let{className:s,sideOffset:r=4,...i}=e;return(0,a.jsx)(n.UC,{ref:t,sideOffset:r,className:(0,l.cn)("z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",s),...i})});c.displayName=n.UC.displayName},58127:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(40157).A)("CircleCheck",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]])},75916:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>K});var a=s(95155),r=s(12115),n=s(35695),l=s(30285),i=s(66695),d=s(85127),o=s(26126),c=s(44838),u=s(54165),m=s(17759),p=s(62523),h=s(88539),x=s(59409),f=s(14636),y=s(85511),j=s(47262),g=s(66424),v=s(91394),N=s(46102),b=s(9572),A=s(34301),k=s(50172),_=s(31949),T=s(3561),w=s(70154),I=s(58127),D=s(18763),C=s(77223),V=s(44972),P=s(51920),O=s(13896),S=s(86318),E=s(59119),L=s(44861),R=s(73168),M=s(6874),J=s.n(M),q=s(59576),F=s(77694),z=s(97841),B=s(87481),H=s(62177),$=s(90221),Y=s(55594),G=s(91950);let U=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return e.split(" ").map(e=>e[0]).filter((e,t,s)=>0===t||t===s.length-1).join("").toUpperCase()},W=e=>{if(!e)return"default";switch(e.toLowerCase()){case"urgent":case"high":return"destructive";case"medium":return"secondary";case"low":return"outline";default:return"default"}},Z=e=>{if(!e)return"default";switch(e.toLowerCase()){case"done":return"default";case"in progress":return"secondary";case"overdue":case"blocked":return"destructive";default:return"outline"}},X=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"tasks",s="An unexpected error occurred while managing ".concat(t,".");if(e&&"object"==typeof e){let a=e.context||t;if(!0===e.isCircuitOpenError){let t=e.openUntil;if(t&&Date.now()<t){let e=Math.ceil((t-Date.now())/1e3),s=e>60?"".concat(Math.ceil(e/60)," minute(s)"):"".concat(e," second(s)");return"Too many recent connection issues with '".concat(a,"'. Access is temporarily paused. Please try again in about ").concat(s,".")}return"Access to '".concat(a,"' is temporarily paused due to repeated connection issues. Please try again in a few moments.")}if(!0===e.circuitJustOpened)return"Failed to connect to '".concat(a,"' after multiple attempts. To allow the service to recover, further attempts will be paused for a short period. Please try again in a few moments.");if("status"in e&&0===e.status?s="Failed to load ".concat(a,": Could not connect to the server. Please check your internet connection and try again."):e.data&&"object"==typeof e.data&&e.data.message&&"string"==typeof e.data.message?s=e.data.message:e.message&&"string"==typeof e.message&&!e.message.startsWith("PocketBase_ClientResponseError")?s=e.message:e.originalError&&"string"==typeof e.originalError.message?s=e.originalError.message:e.message&&"string"==typeof e.message&&(s=e.message),"status"in e&&0!==e.status){let t=e.status,r="items";a.includes("task")?r="tasks":a.includes("employee")&&(r="employees");let n=s.startsWith("An unexpected error occurred")||s.startsWith("PocketBase_ClientResponseError")||s===e.message;404===t&&n?s="The requested ".concat(r," could not be found (404)."):403===t&&n?s="You do not have permission to access or modify these ".concat(r," (403)."):n&&s.startsWith("PocketBase_ClientResponseError")?s="A server error occurred (".concat(t,") while managing ").concat(r,". If this persists, please contact support."):n&&(s="".concat(s," (Status: ").concat(t,")"))}}else"string"==typeof e&&(s=e);return s},Q=Y.Ik({title:Y.Yj().optional(),task_type:Y.k5(G.ci,{errorMap:()=>({message:"Please select a valid task type."})}),instrument_subtype:Y.Yj().optional(),method:Y.Yj().optional(),description:Y.Yj().optional(),status:Y.Yj().min(1,"Status is required."),priority:Y.Yj().min(1,"Priority is required."),startDate:Y.p6().optional(),dueDate:Y.p6().optional(),recurrence:Y.k5(G.y4),assignedTo:Y.YO(Y.Yj()).optional(),dependencies:Y.YO(Y.Yj()).optional(),isMilestone:Y.zM().optional()}).superRefine((e,t)=>{var s;"VALIDATION_PROJECT"!==e.task_type||e.title&&""!==e.title.trim()||t.addIssue({code:Y.eq.custom,message:"Project Name is required for Validation Projects.",path:["title"]}),"MDL"!==e.task_type||e.instrument_subtype||t.addIssue({code:Y.eq.custom,message:"Instrument Subtype is required for MDL tasks.",path:["instrument_subtype"]}),"MDL"===e.task_type&&e.instrument_subtype&&(null==(s=G.xJ[e.instrument_subtype])?void 0:s.length)>0&&!e.method&&t.addIssue({code:Y.eq.custom,message:"Method is required for the selected instrument subtype: ".concat(e.instrument_subtype,"."),path:["method"]}),"SOP"!==e.task_type||e.instrument_subtype||t.addIssue({code:Y.eq.custom,message:"SOP Subtype is required for SOP tasks.",path:["instrument_subtype"]}),"VALIDATION_PROJECT"===e.task_type||"VALIDATION_STEP"===e.task_type?(e.isMilestone&&!e.startDate&&t.addIssue({code:Y.eq.custom,message:"Milestone date (Start Date) is required for a Validation milestone.",path:["startDate"]}),e.isMilestone&&e.startDate&&e.dueDate&&e.startDate.getTime()!==e.dueDate.getTime()&&t.addIssue({code:Y.eq.custom,message:"For milestones, Start Date and Due Date must be the same.",path:["dueDate"]}),"None"!==e.recurrence&&t.addIssue({code:Y.eq.custom,message:"Recurrence must be 'None' for Validation Projects/Steps.",path:["recurrence"]})):(!0===e.isMilestone&&t.addIssue({code:Y.eq.custom,message:"Milestones are only applicable to 'VALIDATION_PROJECT' or 'VALIDATION_STEP' tasks.",path:["isMilestone"]}),e.recurrence&&G.y4.includes(e.recurrence)||t.addIssue({code:Y.eq.custom,message:"Recurrence is required and must be a valid option for this task type.",path:["recurrence"]})),!(("VALIDATION_PROJECT"===e.task_type||"VALIDATION_STEP"===e.task_type)&&e.isMilestone)&&e.startDate&&e.dueDate&&e.startDate>e.dueDate&&t.addIssue({code:Y.eq.custom,message:"Start date must be before or same as due date.",path:["startDate"]})});function K(){var e;let{pbClient:t,user:s}=(0,q.A)(),{toast:M}=(0,B.dj)(),Y=(0,n.useSearchParams)(),[K,ee]=(0,r.useState)([]),[et,es]=(0,r.useState)(!0),[ea,er]=(0,r.useState)(null),[en,el]=(0,r.useState)(null),[ei,ed]=(0,r.useState)("all"),[eo,ec]=(0,r.useState)([]),[eu,em]=(0,r.useState)(!0),[ep,eh]=(0,r.useState)(null),[ex,ef]=(0,r.useState)([]),[ey,ej]=(0,r.useState)(!0),[eg,ev]=(0,r.useState)(null),[eN,eb]=(0,r.useState)(null),[eA,ek]=(0,r.useState)(!1),[e_,eT]=(0,r.useState)(!1),[ew,eI]=(0,r.useState)(!1),[eD,eC]=(0,r.useState)(!1),[eV,eP]=(0,r.useState)(null),[eO,eS]=(0,r.useState)(!1),eE=(0,H.mN)({resolver:(0,$.u)(Q),defaultValues:{title:"",task_type:G.ci.find(e=>"VALIDATION_PROJECT"!==e&&"VALIDATION_STEP"!==e)||G.ci[0],instrument_subtype:void 0,method:void 0,assignedTo:[],dependencies:[],isMilestone:!1,recurrence:"Daily"}}),eL=eE.watch("task_type"),eR=eE.watch("instrument_subtype"),eM=eE.watch("isMilestone"),eJ=eE.watch("startDate"),eq=eE.watch("dueDate"),eF=eE.watch("assignedTo");(0,r.useEffect)(()=>{let e=eE.watch((e,t)=>{let{name:s}=t;if("task_type"===s){if("MDL"!==e.task_type&&"SOP"!==e.task_type)eE.setValue("instrument_subtype",void 0,{shouldValidate:!0}),eE.setValue("method",void 0,{shouldValidate:!0});else if("MDL"===e.task_type){let e=eE.getValues("instrument_subtype"),t=eE.getValues("method");e&&G.xJ[e]&&!G.xJ[e].includes(t||"")&&eE.setValue("method",void 0,{shouldValidate:!0})}else"SOP"===e.task_type&&eE.setValue("method",void 0,{shouldValidate:!0});if("VALIDATION_PROJECT"===e.task_type||"VALIDATION_STEP"===e.task_type)eE.setValue("recurrence","None",{shouldValidate:!0});else{let e=eE.getValues("recurrence");"None"!==e||eV&&"None"===eV.recurrence&&"VALIDATION_PROJECT"!==eV.task_type&&"VALIDATION_STEP"!==eV.task_type?"None"===e&&eV&&"None"===eV.recurrence&&"VALIDATION_PROJECT"!==eV.task_type&&"VALIDATION_STEP"!==eV.task_type&&eE.setValue("recurrence","None",{shouldValidate:!0}):eE.setValue("recurrence","Daily",{shouldValidate:!0})}"VALIDATION_PROJECT"!==e.task_type&&"VALIDATION_STEP"!==e.task_type&&eE.setValue("isMilestone",!1,{shouldValidate:!0})}if("instrument_subtype"===s&&"MDL"===eE.getValues("task_type")){let t=eE.getValues("method"),s=e.instrument_subtype;s&&G.xJ[s]&&!G.xJ[s].includes(t||"")?eE.setValue("method",void 0,{shouldValidate:!0}):s||eE.setValue("method",void 0,{shouldValidate:!0})}if(("isMilestone"===s||"startDate"===s)&&("VALIDATION_PROJECT"===eE.getValues("task_type")||"VALIDATION_STEP"===eE.getValues("task_type"))&&eE.getValues("isMilestone")&&eE.getValues("startDate")){var a;let e=eE.getValues("startDate");eE.getValues("dueDate")&&(null==(a=eE.getValues("dueDate"))?void 0:a.getTime())===e.getTime()||eE.setValue("dueDate",e,{shouldValidate:!0})}});return()=>e.unsubscribe()},[eE,eV]);let ez=(0,r.useCallback)(async(e,t)=>{if(!e)return void es(!1);es(!0),er(null),el(null);let s='task_type != "VALIDATION_PROJECT" && task_type != "VALIDATION_STEP"';"incomplete"===ei?s+=' && status != "Done"':"complete"===ei?s+=' && status = "Done"':"all"!==ei&&(s+=' && status = "'.concat(ei,'"'));try{let a=await (0,F.x1)(e,{signal:t,onRetry:(e,t,s)=>{let a=s&&0===s.status,r=s&&[502,503,504].includes(s.status);a||r?el("Connection issues, retrying... Attempt ".concat(e," of ").concat(t)):el("Attempting to recover... Attempt ".concat(e," of ").concat(t))},filter:s});ee(a),el(null)}catch(s){let e=(null==s?void 0:s.isAbort)===!0||"string"==typeof(null==s?void 0:s.message)&&s.message.toLowerCase().includes("autocancelled"),t=(null==s?void 0:s.status)===0&&!e;if(el(null),e)console.warn("Tasks fetch request was ".concat((null==s?void 0:s.isAbort)?"aborted":"autocancelled","."),s);else if(t){let e=X(s,"tasks");er(e),M({title:"Error Loading Tasks",description:e,variant:"destructive"}),console.warn("Tasks fetch (network error):",e,s)}else{let e=X(s,"tasks");er(e),M({title:"Error Loading Tasks",description:e,variant:"destructive"}),console.warn("Error fetching tasks (after retries):",e,s)}}finally{es(!1)}},[M,ei]),eB=(0,r.useCallback)(async(e,t)=>{if(!e)return void em(!1);em(!0),eh(null);try{let s=await (0,z.Oc)(e,{signal:t,onRetry:(e,t,s)=>{el("Retrying employee data... Attempt ".concat(e," of ").concat(t))}});ec(s)}catch(t){let e=(null==t?void 0:t.isAbort)===!0||"string"==typeof(null==t?void 0:t.message)&&t.message.toLowerCase().includes("autocancelled");if(e)console.warn("Fetch employees for task edit request was ".concat((null==t?void 0:t.isAbort)?"aborted":"autocancelled","."),t);else if((null==t?void 0:t.status)!==0||e){let e=X(t,"employees for task assignment");eh(e),M({title:"Error Loading Employees",description:e,variant:"destructive"}),console.warn("Error fetching employees for task edit (after retries):",e,t)}else{let e=X(t,"employees for task assignment");eh(e),M({title:"Error Loading Employees",description:e,variant:"destructive"}),console.warn("Fetch employees for task edit (network error):",e,t)}}finally{em(!1)}},[M]),eH=(0,r.useCallback)(async(e,t,s)=>{if(!e)return void ej(!1);ej(!0),ev(null),eb(null);try{let a=await (0,F.x1)(e,{signal:s,onRetry:(e,t,s)=>{eb("Retrying tasks for selection... Attempt ".concat(e," of ").concat(t))}}),r=t?a.filter(e=>e.id!==t):a;ef(r),eb(null)}catch(s){eb(null);let e=(null==s?void 0:s.isAbort)===!0||"string"==typeof(null==s?void 0:s.message)&&s.message.toLowerCase().includes("autocancelled"),t=(null==s?void 0:s.status)===0&&!e;if(e)console.warn("Fetch tasks for edit dependency selection request was ".concat((null==s?void 0:s.isAbort)?"aborted":"autocancelled","."),s);else if(t){let e=X(s,"tasks for dependency selection (edit)");ev(e),M({title:"Error Loading Tasks for Dependencies",description:e,variant:"destructive"}),console.warn("Fetch tasks for edit dependency selection (network error):",e,s)}else{let e=X(s,"tasks for dependency selection (edit)");ev(e),M({title:"Error Loading Tasks for Dependencies",description:e,variant:"destructive"}),console.warn("Error fetching tasks for edit dependency selection (after retries):",e,s)}}finally{ej(!1)}},[M]);(0,r.useEffect)(()=>{let e=new AbortController;if(t){let s=Y.get("status");s&&G.Hi.includes(s)&&ed(s),ez(t,e.signal),eB(t,e.signal)}else es(!0),em(!0);return()=>{e.abort()}},[t,ez,eB,Y]),(0,r.useEffect)(()=>{if(eD&&eV&&t&&"VALIDATION_STEP"!==eV.task_type){let e=new AbortController;return eH(t,eV.id,e.signal),()=>e.abort()}(!eD||eV&&"VALIDATION_STEP"===eV.task_type)&&(ef([]),ej(!1))},[eD,eV,t,eH]),(0,r.useEffect)(()=>{eV&&eE.reset({title:eV.title||"",task_type:eV.task_type,instrument_subtype:eV.instrument_subtype||void 0,method:eV.method||void 0,description:eV.description||"",status:eV.status,priority:eV.priority,startDate:eV.startDate&&(0,L.f)(new Date(eV.startDate))?new Date(eV.startDate):void 0,dueDate:eV.dueDate&&(0,L.f)(new Date(eV.dueDate))?new Date(eV.dueDate):void 0,recurrence:eV.recurrence,assignedTo:eV.assignedTo||[],dependencies:Array.isArray(eV.dependencies)?eV.dependencies:[],isMilestone:("VALIDATION_PROJECT"===eV.task_type||"VALIDATION_STEP"===eV.task_type)&&(eV.isMilestone||!1)})},[eV,eE]);let e$=(0,r.useCallback)(async(e,s)=>{if(!t)return void M({title:"Error",description:"Client not available.",variant:"destructive"});let a="Done"===s?"To Do":"Done";try{let s=await (0,F.lC)(t,e,{status:a});ee(e=>{let t=e.map(e=>e.id===s.id?s:e);return"all"===ei?t:"complete"===ei?t.filter(e=>"Done"===e.status):"incomplete"===ei?t.filter(e=>"Done"!==e.status):t}),M({title:"Success",description:"Task marked as ".concat(a,".")})}catch(e){console.warn("Error updating task status:",e),t&&ez(t),M({title:"Error",description:"Failed to update task status: ".concat(X(e)),variant:"destructive"})}},[t,M,ei,ez]),eY=(0,r.useCallback)(async e=>{if(!t)return void M({title:"Error",description:"Client not available.",variant:"destructive"});let s=[...K];ee(t=>t.filter(t=>t.id!==e));try{await (0,F.vq)(t,e),M({title:"Success",description:"Task deleted successfully."})}catch(e){console.warn("Error deleting task:",e),ee(s),M({title:"Error",description:X(e),variant:"destructive"})}},[t,M,K]),eG=(0,r.useCallback)(e=>{eP(e),eC(!0)},[]),eU=()=>{eC(!1),eP(null),eE.reset(),ef([]),ek(!1),eT(!1)},eW=async e=>{var a,r,n,l,i,d,o,c,u,m;if(!eV||!t||!s)return void M({title:"Error",description:"Editing context, client or user not available.",variant:"destructive"});eS(!0);let p={title:"VALIDATION_PROJECT"===e.task_type?e.title:e.task_type,task_type:e.task_type,instrument_subtype:"MDL"===e.task_type||"SOP"===e.task_type?e.instrument_subtype:void 0,method:"MDL"===e.task_type&&e.instrument_subtype&&(null==(a=G.xJ[e.instrument_subtype])?void 0:a.length)>0?e.method:void 0,description:e.description,status:e.status,priority:e.priority,startDate:e.startDate,dueDate:("VALIDATION_PROJECT"===e.task_type||"VALIDATION_STEP"===e.task_type)&&e.isMilestone&&e.startDate?e.startDate:e.dueDate,recurrence:e.recurrence,assignedTo:e.assignedTo,isMilestone:("VALIDATION_PROJECT"===e.task_type||"VALIDATION_STEP"===e.task_type)&&e.isMilestone,dependencies:"VALIDATION_STEP"===e.task_type?eV.dependencies:e.dependencies||[],userId:s.id};try{let e=await (0,F.lC)(t,eV.id,p);ee(t=>t.map(t=>t.id===e.id?e:t)),M({title:"Success",description:"Task updated successfully."}),eU()}catch(t){console.warn("Failed to update task:",t);let e=X(t);(null==(l=t.data)||null==(n=l.data)||null==(r=n.title)?void 0:r.message)?e="Title: ".concat(t.data.data.title.message):(null==(o=t.data)||null==(d=o.data)||null==(i=d.instrument_subtype)?void 0:i.message)?e="Instrument Subtype: ".concat(t.data.data.instrument_subtype.message):(null==(m=t.data)||null==(u=m.data)||null==(c=u.method)?void 0:c.message)&&(e="Method: ".concat(t.data.data.method.message)),M({title:"Error Updating Task",description:e,variant:"destructive"})}finally{eS(!1)}},eZ="Pick a date";eZ=("VALIDATION_PROJECT"===eL||"VALIDATION_STEP"===eL)&&eM?eJ?"Milestone: ".concat((0,R.GP)(eJ,"PPP")):"Pick Milestone Date":eJ&&eq?"".concat((0,R.GP)(eJ,"PPP")," - ").concat((0,R.GP)(eq,"PPP")):eJ?"".concat((0,R.GP)(eJ,"PPP")," - Select End Date"):"Pick Date Range";let eX=et||eu,eQ=ei.charAt(0).toUpperCase()+ei.slice(1),eK=(0,r.useMemo)(()=>"MDL"===eL&&eR&&G.xJ[eR]?G.xJ[eR]:[],[eL,eR]),e0=eF&&0!==eF.length?1===eF.length?(null==(e=eo.find(e=>e.id===eF[0]))?void 0:e.name)||"1 employee selected":"".concat(eF.length," employees selected"):"Select employees (Optional)";return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("h1",{className:"text-2xl md:text-3xl font-headline font-semibold",children:"Task Management"}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsxs)(c.rI,{children:[(0,a.jsx)(c.ty,{asChild:!0,children:(0,a.jsxs)(l.$,{variant:"outline",children:[(0,a.jsx)(b.A,{className:"mr-2 h-4 w-4"})," Filter: ",eQ]})}),(0,a.jsxs)(c.SQ,{align:"end",className:"w-48",children:[(0,a.jsx)(c.lp,{children:"Filter by Status"}),(0,a.jsx)(c.mB,{}),(0,a.jsxs)(c.Hr,{value:ei,onValueChange:e=>ed(e),children:[(0,a.jsx)(c.Ht,{value:"incomplete",children:"Incomplete"}),(0,a.jsx)(c.Ht,{value:"complete",children:"Complete"}),(0,a.jsx)(c.Ht,{value:"all",children:"All"})]})]})]}),(0,a.jsx)(J(),{href:"/tasks/new",passHref:!0,children:(0,a.jsxs)(l.$,{children:[(0,a.jsx)(A.A,{className:"mr-2 h-4 w-4"})," Add Task"]})})]})]}),(0,a.jsxs)(i.Zp,{className:"shadow-md",children:[(0,a.jsxs)(i.aR,{children:[(0,a.jsxs)(i.ZB,{className:"font-headline",children:["Task List (",eQ,")"]}),(0,a.jsx)(i.BT,{children:"View, manage, and track laboratory tasks based on the selected filter. (Excludes Validation Projects & Steps)."})]}),(0,a.jsxs)(i.Wu,{children:[eX&&(0,a.jsxs)("div",{className:"flex justify-center items-center py-10",children:[(0,a.jsx)(k.A,{className:"h-8 w-8 animate-spin text-primary"}),(0,a.jsx)("p",{className:"ml-2",children:en||"Loading tasks and employee data..."})]}),ea&&!eX&&!en&&(0,a.jsxs)("div",{className:"text-center py-10 text-destructive",children:[(0,a.jsx)(_.A,{className:"mx-auto h-12 w-12 text-destructive"}),(0,a.jsx)("p",{className:"mt-4 text-lg font-semibold",children:"Failed to Load Tasks"}),(0,a.jsx)("p",{className:"text-sm",children:ea}),(0,a.jsx)(l.$,{onClick:()=>{t&&ez(t,new AbortController().signal)},className:"mt-6",children:"Try Again"})]}),!eX&&!ea&&0===K.length&&(0,a.jsxs)("div",{className:"text-center py-10 text-muted-foreground",children:[(0,a.jsxs)("p",{children:['No tasks found matching the current filter: "',eQ,'".']}),"all"!==ei&&(0,a.jsx)("p",{className:"text-sm",children:"Try selecting a different filter or adding new tasks."})]}),!eX&&!ea&&K.length>0&&(0,a.jsxs)(d.XI,{children:[(0,a.jsx)(d.A0,{children:(0,a.jsxs)(d.Hj,{children:[(0,a.jsx)(d.nd,{children:"Name / Details"}),(0,a.jsx)(d.nd,{children:"Status"}),(0,a.jsx)(d.nd,{children:"Priority"}),(0,a.jsx)(d.nd,{children:"Due Date"}),(0,a.jsx)(d.nd,{children:"Assigned To"}),(0,a.jsx)(d.nd,{className:"text-right",children:"Actions"})]})}),(0,a.jsx)(d.BF,{children:K.map(e=>{var t;return(0,a.jsxs)(d.Hj,{className:"hover:bg-muted/50 transition-colors",children:[(0,a.jsxs)(d.nA,{children:[(0,a.jsx)("div",{className:"font-medium",children:e.title.replace(/_/g," ")}),("MDL"===e.task_type||"SOP"===e.task_type)&&e.instrument_subtype&&(0,a.jsx)("div",{className:"text-xs text-muted-foreground",children:e.instrument_subtype}),"MDL"===e.task_type&&e.method&&(0,a.jsx)("div",{className:"text-xs text-muted-foreground",children:e.method}),e.description&&"MDL"!==e.task_type&&"SOP"!==e.task_type&&(0,a.jsx)("div",{className:"text-xs text-muted-foreground truncate max-w-xs",title:e.description,children:e.description}),("MDL"!==e.task_type&&"SOP"!==e.task_type||!e.instrument_subtype)&&!e.description&&!e.method&&(0,a.jsx)("div",{className:"text-xs text-muted-foreground",children:"-"})]}),(0,a.jsx)(d.nA,{children:(0,a.jsx)(o.E,{variant:Z(e.status),children:e.status})}),(0,a.jsx)(d.nA,{children:(0,a.jsx)(o.E,{variant:W(e.priority),children:e.priority})}),(0,a.jsxs)(d.nA,{children:[e.dueDate?(0,R.GP)(new Date(e.dueDate),"MMM dd, yyyy"):"-",e.recurrence&&"None"!==e.recurrence&&(0,a.jsxs)("span",{className:"block text-xs text-muted-foreground",children:["Repeats: ",e.recurrence]})]}),(0,a.jsx)(d.nA,{children:(null==(t=e.expand)?void 0:t.assignedTo)&&e.expand.assignedTo.length>0?(0,a.jsx)(N.Bc,{children:(0,a.jsxs)("div",{className:"flex -space-x-2",children:[e.expand.assignedTo.slice(0,3).map(e=>(0,a.jsxs)(N.m_,{children:[(0,a.jsx)(N.k$,{asChild:!0,children:(0,a.jsx)(v.eu,{className:"h-7 w-7 border-2 border-background",children:(0,a.jsx)(v.q5,{children:U(e.name)})})}),(0,a.jsx)(N.ZI,{children:e.name})]},e.id)),e.expand.assignedTo.length>3&&(0,a.jsxs)(N.m_,{children:[(0,a.jsx)(N.k$,{asChild:!0,children:(0,a.jsx)(v.eu,{className:"h-7 w-7 border-2 border-background",children:(0,a.jsxs)(v.q5,{children:["+",e.expand.assignedTo.length-3]})})}),(0,a.jsxs)(N.ZI,{children:["And ",e.expand.assignedTo.length-3," more"]})]})]})}):"-"}),(0,a.jsx)(d.nA,{className:"text-right",children:(0,a.jsxs)(c.rI,{children:[(0,a.jsx)(c.ty,{asChild:!0,children:(0,a.jsx)(l.$,{variant:"ghost",size:"icon",children:(0,a.jsx)(T.A,{className:"h-4 w-4"})})}),(0,a.jsxs)(c.SQ,{align:"end",children:[(0,a.jsxs)(c._2,{onClick:()=>e$(e.id,e.status),className:"flex items-center w-full",children:["Done"===e.status?(0,a.jsx)(w.A,{className:"mr-2 h-4 w-4"}):(0,a.jsx)(I.A,{className:"mr-2 h-4 w-4"}),"Done"===e.status?"Mark as To Do":"Mark as Done"]}),(0,a.jsxs)(c._2,{onClick:()=>eG(e),className:"flex items-center w-full",children:[(0,a.jsx)(D.A,{className:"mr-2 h-4 w-4"})," Edit"]}),(0,a.jsxs)(c._2,{className:"text-destructive focus:text-destructive focus:bg-destructive/10",onClick:()=>eY(e.id),children:[(0,a.jsx)(C.A,{className:"mr-2 h-4 w-4"})," Delete"]})]})]})})]},e.id)})})]})]})]}),eV&&(0,a.jsx)(u.lG,{open:eD,onOpenChange:e=>{e?eC(!0):eU()},children:(0,a.jsxs)(u.Cf,{className:"sm:max-w-lg",children:[(0,a.jsxs)(u.c7,{children:[(0,a.jsxs)(u.L3,{className:"font-headline",children:["Edit: ",eV.title.replace(/_/g," ")]}),(0,a.jsx)(u.rr,{children:"Make changes to the task details below."})]}),(0,a.jsx)(m.lV,{...eE,children:(0,a.jsxs)("form",{onSubmit:eE.handleSubmit(eW),className:"space-y-4 py-4 max-h-[70vh] overflow-y-auto pr-2",children:[(0,a.jsx)(m.zB,{control:eE.control,name:"task_type",render:e=>{let{field:t}=e;return(0,a.jsxs)(m.eI,{children:[(0,a.jsx)(m.lR,{children:"Task Type"}),(0,a.jsxs)(x.l6,{onValueChange:t.onChange,value:t.value,disabled:!0,children:[(0,a.jsx)(m.MJ,{children:(0,a.jsx)(x.bq,{children:(0,a.jsx)(x.yv,{placeholder:"Select task type"})})}),(0,a.jsx)(x.gC,{children:G.ci.map(e=>(0,a.jsx)(x.eb,{value:e,children:e.replace(/_/g," ")},e))})]}),(0,a.jsx)(m.C5,{})]})}}),"VALIDATION_PROJECT"===eL&&(0,a.jsx)(m.zB,{control:eE.control,name:"title",render:e=>{let{field:t}=e;return(0,a.jsxs)(m.eI,{children:[(0,a.jsx)(m.lR,{children:"Project Name"}),(0,a.jsx)(m.MJ,{children:(0,a.jsx)(p.p,{...t,placeholder:"Enter the project name"})}),(0,a.jsx)(m.C5,{})]})}}),"MDL"===eL&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(m.zB,{control:eE.control,name:"instrument_subtype",render:e=>{let{field:t}=e;return(0,a.jsxs)(m.eI,{children:[(0,a.jsx)(m.lR,{children:"Instrument Subtype"}),(0,a.jsxs)(x.l6,{onValueChange:t.onChange,value:t.value||"",children:[(0,a.jsx)(m.MJ,{children:(0,a.jsx)(x.bq,{children:(0,a.jsx)(x.yv,{placeholder:"Select instrument for MDL"})})}),(0,a.jsx)(x.gC,{children:G.oe.map(e=>(0,a.jsx)(x.eb,{value:e,children:e},e))})]}),(0,a.jsx)(m.C5,{})]})}}),eR&&eK.length>0&&(0,a.jsx)(m.zB,{control:eE.control,name:"method",render:e=>{let{field:t}=e;return(0,a.jsxs)(m.eI,{children:[(0,a.jsx)(m.lR,{children:"Method"}),(0,a.jsxs)(x.l6,{onValueChange:t.onChange,value:t.value||"",children:[(0,a.jsx)(m.MJ,{children:(0,a.jsx)(x.bq,{children:(0,a.jsx)(x.yv,{placeholder:"Select method"})})}),(0,a.jsx)(x.gC,{children:eK.map(e=>(0,a.jsx)(x.eb,{value:e,children:e},e))})]}),(0,a.jsx)(m.C5,{})]})}})]}),"SOP"===eL&&(0,a.jsx)(m.zB,{control:eE.control,name:"instrument_subtype",render:e=>{let{field:t}=e;return(0,a.jsxs)(m.eI,{children:[(0,a.jsx)(m.lR,{children:"SOP Subtype"}),(0,a.jsxs)(x.l6,{onValueChange:t.onChange,value:t.value||"",children:[(0,a.jsx)(m.MJ,{children:(0,a.jsx)(x.bq,{children:(0,a.jsx)(x.yv,{placeholder:"Select SOP subtype"})})}),(0,a.jsx)(x.gC,{children:G.tk.map(e=>(0,a.jsx)(x.eb,{value:e,children:e},e))})]}),(0,a.jsx)(m.C5,{})]})}}),(0,a.jsx)(m.zB,{control:eE.control,name:"description",render:e=>{let{field:t}=e;return(0,a.jsxs)(m.eI,{children:[(0,a.jsx)(m.lR,{children:"Description (Optional)"}),(0,a.jsx)(m.MJ,{children:(0,a.jsx)(h.T,{...t,placeholder:"Add any relevant details..."})}),(0,a.jsx)(m.C5,{})]})}}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsx)(m.zB,{control:eE.control,name:"status",render:e=>{let{field:t}=e;return(0,a.jsxs)(m.eI,{children:[(0,a.jsx)(m.lR,{children:"Status"}),(0,a.jsxs)(x.l6,{onValueChange:t.onChange,value:t.value,children:[(0,a.jsx)(m.MJ,{children:(0,a.jsx)(x.bq,{children:(0,a.jsx)(x.yv,{placeholder:"Select status"})})}),(0,a.jsx)(x.gC,{children:G.Hi.map(e=>(0,a.jsx)(x.eb,{value:e,children:e},e))})]}),(0,a.jsx)(m.C5,{})]})}}),(0,a.jsx)(m.zB,{control:eE.control,name:"priority",render:e=>{let{field:t}=e;return(0,a.jsxs)(m.eI,{children:[(0,a.jsx)(m.lR,{children:"Priority"}),(0,a.jsxs)(x.l6,{onValueChange:t.onChange,value:t.value,children:[(0,a.jsx)(m.MJ,{children:(0,a.jsx)(x.bq,{children:(0,a.jsx)(x.yv,{placeholder:"Select priority"})})}),(0,a.jsx)(x.gC,{children:G.PN.map(e=>(0,a.jsx)(x.eb,{value:e,children:e},e))})]}),(0,a.jsx)(m.C5,{})]})}})]}),("VALIDATION_PROJECT"===eL||"VALIDATION_STEP"===eL)&&(0,a.jsx)(m.zB,{control:eE.control,name:"isMilestone",render:e=>{let{field:t}=e;return(0,a.jsxs)(m.eI,{className:"flex flex-row items-center space-x-2 space-y-0 py-2",children:[(0,a.jsx)(m.MJ,{children:(0,a.jsx)(j.S,{checked:t.value,onCheckedChange:t.onChange})}),(0,a.jsxs)(m.lR,{className:"font-normal flex items-center cursor-pointer mb-0!",children:[(0,a.jsx)(V.A,{className:"mr-2 h-4 w-4 text-muted-foreground"})," Mark as Milestone"]}),(0,a.jsx)(m.C5,{})]})}}),(0,a.jsxs)("div",{children:[(0,a.jsx)(m.lR,{children:("VALIDATION_PROJECT"===eL||"VALIDATION_STEP"===eL)&&eM?"Milestone Date":"Date Range (Start - Due)"}),(0,a.jsxs)(f.AM,{open:e_,onOpenChange:eT,children:[(0,a.jsx)(f.Wv,{asChild:!0,children:(0,a.jsxs)(l.$,{variant:"outline",className:"w-full justify-start text-left font-normal mt-2",children:[(0,a.jsx)(P.A,{className:"mr-2 h-4 w-4"}),eZ]})}),(0,a.jsx)(f.hl,{className:"w-auto p-0",children:(0,a.jsx)(y.V,{mode:("VALIDATION_PROJECT"===eL||"VALIDATION_STEP"===eL)&&eM?"single":"range",selected:("VALIDATION_PROJECT"===eL||"VALIDATION_STEP"===eL)&&eM?eJ:{from:eJ,to:eq},onSelect:e=>{let t=eE.getValues("task_type"),s=eE.getValues("isMilestone");("VALIDATION_PROJECT"===t||"VALIDATION_STEP"===t)&&s?(eE.setValue("startDate",e,{shouldValidate:!0}),eE.setValue("dueDate",e,{shouldValidate:!0})):(eE.setValue("startDate",null==e?void 0:e.from,{shouldValidate:!0}),eE.setValue("dueDate",null==e?void 0:e.to,{shouldValidate:!0})),e&&(("VALIDATION_PROJECT"===t||"VALIDATION_STEP"===t)&&s||null==e||!e.from||(null==e?void 0:e.to))&&eT(!1)},numberOfMonths:("VALIDATION_PROJECT"===eL||"VALIDATION_STEP"===eL)&&eM?1:2,initialFocus:!0})})]}),(0,a.jsx)(m.zB,{control:eE.control,name:"startDate",render:()=>(0,a.jsx)(m.C5,{})}),(0,a.jsx)(m.zB,{control:eE.control,name:"dueDate",render:()=>(0,a.jsx)(m.C5,{})})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:["VALIDATION_PROJECT"!==eL&&"VALIDATION_STEP"!==eL&&(0,a.jsx)(m.zB,{control:eE.control,name:"recurrence",render:e=>{let{field:t}=e;return(0,a.jsxs)(m.eI,{children:[(0,a.jsx)(m.lR,{children:"Recurrence"}),(0,a.jsxs)(x.l6,{onValueChange:t.onChange,value:t.value,children:[(0,a.jsx)(m.MJ,{children:(0,a.jsx)(x.bq,{children:(0,a.jsx)(x.yv,{placeholder:"Select recurrence"})})}),(0,a.jsx)(x.gC,{children:G.y4.map(e=>(0,a.jsx)(x.eb,{value:e,children:e},e))})]}),(0,a.jsx)(m.C5,{})]})}}),(0,a.jsx)(m.zB,{control:eE.control,name:"assignedTo",render:e=>{let{field:t}=e;return(0,a.jsxs)(m.eI,{className:"VALIDATION_PROJECT"===eL||"VALIDATION_STEP"===eL||"MDL"===eL&&eK.length>0||"VALIDATION_PROJECT"!==eL&&"VALIDATION_STEP"!==eL?"md:col-span-2":"",children:[(0,a.jsx)(m.lR,{children:"Assigned To"}),(0,a.jsxs)(f.AM,{open:ew,onOpenChange:eI,children:[(0,a.jsx)(f.Wv,{asChild:!0,children:(0,a.jsxs)(l.$,{variant:"outline",className:"w-full justify-start text-left font-normal",disabled:eu||!!ep,children:[(0,a.jsx)(O.A,{className:"mr-2 h-4 w-4"}),eu?"Loading...":ep?"Error":e0]})}),(0,a.jsx)(f.hl,{className:"w-[--radix-popover-trigger-width] p-0",children:(0,a.jsx)(g.F,{className:"h-48",children:(0,a.jsx)("div",{className:"p-4 space-y-2",children:eo.map(e=>{var s;return(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(j.S,{id:"edit-assignee-".concat(e.id),checked:null==(s=t.value)?void 0:s.includes(e.id),onCheckedChange:s=>{let a=t.value||[];return s?t.onChange([...a,e.id]):t.onChange(a.filter(t=>t!==e.id))}}),(0,a.jsxs)(Label,{htmlFor:"edit-assignee-".concat(e.id),className:"font-normal cursor-pointer",children:[e.name," (",e.role,")"]})]},e.id)})})})})]}),ep&&!eu&&(0,a.jsxs)("p",{className:"text-sm text-destructive mt-1 flex items-center",children:[(0,a.jsx)(_.A,{className:"h-4 w-4 mr-1"})," ",ep]}),(0,a.jsx)(m.C5,{})]})}})]}),"VALIDATION_STEP"!==eL&&(0,a.jsx)(m.zB,{control:eE.control,name:"dependencies",render:e=>{let{field:t}=e;return(0,a.jsxs)(m.eI,{children:[(0,a.jsx)(m.lR,{children:"Dependencies (Optional)"}),(0,a.jsxs)(f.AM,{open:eA,onOpenChange:ek,children:[(0,a.jsx)(f.Wv,{asChild:!0,children:(0,a.jsxs)(l.$,{variant:"outline",className:"w-full justify-start text-left font-normal",disabled:ey||!!eg,children:[(0,a.jsx)(S.A,{className:"mr-2 h-4 w-4"}),ey?"Loading tasks...":eg?"Error loading tasks":t.value&&t.value.length>0?"".concat(t.value.length," selected"):"Select dependent tasks"]})}),(0,a.jsxs)(f.hl,{className:"w-[--radix-popover-trigger-width] p-0",children:[eN&&(0,a.jsx)("div",{className:"p-4 text-center text-sm text-orange-600",children:eN}),ey&&!eN?(0,a.jsx)("div",{className:"p-4 text-center text-sm",children:"Loading tasks..."}):eg&&!eN?(0,a.jsx)("div",{className:"p-4 text-center text-sm text-destructive",children:eg}):ey||eg||0!==ex.length||eN?!eN&&!eg&&(0,a.jsx)(g.F,{className:"h-48",children:(0,a.jsx)("div",{className:"p-4 space-y-2",children:ex.map(e=>{var s;return(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(j.S,{id:"edit-dep-".concat(e.id),checked:null==(s=t.value)?void 0:s.includes(e.id),onCheckedChange:s=>{let a=t.value||[];return s?t.onChange([...a,e.id]):t.onChange(a.filter(t=>t!==e.id))}}),(0,a.jsxs)("label",{htmlFor:"edit-dep-".concat(e.id),className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70 truncate",title:e.title,children:[e.title," (",e.task_type.replace(/_/g," "),")"]})]},e.id)})})}):(0,a.jsx)("div",{className:"p-4 text-center text-sm",children:"No other tasks available to select."}),!eN&&!ey&&(0,a.jsx)("div",{className:"p-2 border-t",children:(0,a.jsx)(l.$,{type:"button",size:"sm",className:"w-full",onClick:()=>ek(!1),children:"Done"})})]})]}),(0,a.jsx)(m.C5,{})]})}}),(0,a.jsxs)(u.Es,{children:[(0,a.jsx)(u.HM,{asChild:!0,children:(0,a.jsx)(l.$,{type:"button",variant:"outline",onClick:eU,disabled:eO,children:"Cancel"})}),(0,a.jsxs)(l.$,{type:"submit",disabled:eO||eu||ey&&"VALIDATION_STEP"!==eL,children:[eO?(0,a.jsx)(k.A,{className:"mr-2 h-4 w-4 animate-spin"}):(0,a.jsx)(E.A,{className:"mr-2 h-4 w-4"}),"Save Changes"]})]})]})})]})})]})}},77223:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(40157).A)("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]])},82159:(e,t,s)=>{Promise.resolve().then(s.bind(s,75916))},85127:(e,t,s)=>{"use strict";s.d(t,{A0:()=>i,BF:()=>d,Hj:()=>o,XI:()=>l,nA:()=>u,nd:()=>c});var a=s(95155),r=s(12115),n=s(59434);let l=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("div",{className:"relative w-full overflow-auto",children:(0,a.jsx)("table",{ref:t,className:(0,n.cn)("w-full caption-bottom text-sm",s),...r})})});l.displayName="Table";let i=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("thead",{ref:t,className:(0,n.cn)("[&_tr]:border-b",s),...r})});i.displayName="TableHeader";let d=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("tbody",{ref:t,className:(0,n.cn)("[&_tr:last-child]:border-0",s),...r})});d.displayName="TableBody",r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("tfoot",{ref:t,className:(0,n.cn)("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",s),...r})}).displayName="TableFooter";let o=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("tr",{ref:t,className:(0,n.cn)("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",s),...r})});o.displayName="TableRow";let c=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("th",{ref:t,className:(0,n.cn)("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",s),...r})});c.displayName="TableHead";let u=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("td",{ref:t,className:(0,n.cn)("p-4 align-middle [&:has([role=checkbox])]:pr-0",s),...r})});u.displayName="TableCell",r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("caption",{ref:t,className:(0,n.cn)("mt-4 text-sm text-muted-foreground",s),...r})}).displayName="TableCaption"},85977:(e,t,s)=>{"use strict";s.d(t,{H4:()=>N,_V:()=>v,bL:()=>g});var a=s(12115),r=s(46081),n=s(39033),l=s(52712),i=s(63655),d=s(95155),o="Avatar",[c,u]=(0,r.A)(o),[m,p]=c(o),h=a.forwardRef((e,t)=>{let{__scopeAvatar:s,...r}=e,[n,l]=a.useState("idle");return(0,d.jsx)(m,{scope:s,imageLoadingStatus:n,onImageLoadingStatusChange:l,children:(0,d.jsx)(i.sG.span,{...r,ref:t})})});h.displayName=o;var x="AvatarImage",f=a.forwardRef((e,t)=>{let{__scopeAvatar:s,src:r,onLoadingStatusChange:o=()=>{},...c}=e,u=p(x,s),m=function(e,t){let[s,r]=a.useState("idle");return(0,l.N)(()=>{if(!e)return void r("error");let s=!0,a=new window.Image,n=e=>()=>{s&&r(e)};return r("loading"),a.onload=n("loaded"),a.onerror=n("error"),a.src=e,t&&(a.referrerPolicy=t),()=>{s=!1}},[e,t]),s}(r,c.referrerPolicy),h=(0,n.c)(e=>{o(e),u.onImageLoadingStatusChange(e)});return(0,l.N)(()=>{"idle"!==m&&h(m)},[m,h]),"loaded"===m?(0,d.jsx)(i.sG.img,{...c,ref:t,src:r}):null});f.displayName=x;var y="AvatarFallback",j=a.forwardRef((e,t)=>{let{__scopeAvatar:s,delayMs:r,...n}=e,l=p(y,s),[o,c]=a.useState(void 0===r);return a.useEffect(()=>{if(void 0!==r){let e=window.setTimeout(()=>c(!0),r);return()=>window.clearTimeout(e)}},[r]),o&&"loaded"!==l.imageLoadingStatus?(0,d.jsx)(i.sG.span,{...n,ref:t}):null});j.displayName=y;var g=h,v=f,N=j},91394:(e,t,s)=>{"use strict";s.d(t,{BK:()=>d,eu:()=>i,q5:()=>o});var a=s(95155),r=s(12115),n=s(85977),l=s(59434);let i=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(n.bL,{ref:t,className:(0,l.cn)("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",s),...r})});i.displayName=n.bL.displayName;let d=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(n._V,{ref:t,className:(0,l.cn)("aspect-square h-full w-full",s),...r})});d.displayName=n._V.displayName;let o=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(n.H4,{ref:t,className:(0,l.cn)("flex h-full w-full items-center justify-center rounded-full bg-muted",s),...r})});o.displayName=n.H4.displayName}},e=>{var t=t=>e(e.s=t);e.O(0,[2383,4897,9052,3198,6874,1859,7164,5452,3168,5280,9819,36,9613,7655,9467,5229,5061,8441,1684,7358],()=>t(82159)),_N_E=e.O()}]);